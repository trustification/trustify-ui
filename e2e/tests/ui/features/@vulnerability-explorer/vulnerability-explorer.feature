Feature: Vulnerability Explorer - View Vulnerability details
    Background: Authentication
        Given User is authenticated

    # Search for vulnerability
    Scenario: Search for a vulnerability using the general search bar
        When User searches for "<vulnerabilityID>" in the general search bar
        Then The vulnerability "<vulnerabilityID>" shows in the results

        Examples:
            | vulnerabilityID |
            | CVE-2023-1664   |

    Scenario: Search for a vulnerability using the dedicated search bar
        When User searches for "<vulnerabilityID>" in the dedicated search bar
        Then The vulnerability "<vulnerabilityID>" shows in the results

        Examples:
            | vulnerabilityID |
            | CVE-2023-1664   |

    # Vulnerability Explorer
    Scenario: Display an overview of a vulnerability
        Given User visits Vulnerability details Page of "<vulnerabilityID>"
        Then The page title is "<vulnerabilityID>"
        Then The severity is "<severityDescription>" and the CVSS score is "<severityScore>"
        Then The description begins with "<descriptionBeginsWith>"
        Then The Reserved date is "<dateReserved>", the Published date is "<datePublished>" and Last modified date is "<dateLastModified>"

        Examples:
            | vulnerabilityID | severityDescription | severityScore | descriptionBeginsWith         | dateReserved | datePublished | dateLastModified |
            | CVE-2023-1664   | Medium              | 6.5           | A flaw was found in Keycloak. | Mar 27, 2023 | May 26, 2023  | Jan 15, 2025     |


    # Related products / SBOMs
    Scenario Outline: View related SBOMs
        Given User visits Vulnerability details Page of "<vulnerabilityID>"
        When Tab "Related SBOMs" is visible
        Then The page title is "<vulnerabilityID>"

        Then The SBOMs table is sorted by "Name"
        Then The SBOMs table total results is 1
        Then The "Name" column of the SBOM table contains "<sbomName>"

        Examples:
            | vulnerabilityID | sbomName    |
            | CVE-2023-1664   | quarkus-bom |

    # Related advisories
    Scenario Outline: View related Advisories
        Given User visits Vulnerability details Page of "<vulnerabilityID>"
        Then Tab "Advisories" is visible
        Then The page title is "<vulnerabilityID>"

        Then User navigates to the Related Advisories tab on the Vulnerability Overview page
        Then Pagination of Advisories list works
        Then A list of all active Advisories tied to the Vulnerability should display
        And The "ID, Title, Type, Revision, Vulnerabilities" information should be visible for each advisory
        And The advisories should be sorted by "<columnName>"
        Then User searches for "<advisoryID>"
        Then User visits Advisory details Page of "<advisoryID>" with type "<advisoryType>"
        Then The page title is "<advisoryID>"

        Examples:
            | vulnerabilityID | columnName |  advisoryID   | advisoryType |
            | CVE-2023-1664   |    ID      | CVE-2023-1664 |     csaf     |