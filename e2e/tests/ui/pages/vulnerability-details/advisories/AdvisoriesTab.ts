import type { Page } from "@playwright/test";
import { VulnerabilityDetailsPage } from "../VulnerabilityDetailsPage";
import { Toolbar } from "../../Toolbar";
import { Table } from "../../Table";
import { Pagination } from "../../Pagination";

export class AdvisoriesTab {
  private readonly _page: Page;
  _detailsPage: VulnerabilityDetailsPage;

  private constructor(page: Page, layout: VulnerabilityDetailsPage) {
    this._page = page;
    this._detailsPage = layout;
  }

  static async build(page: Page, vulnerabilityID: string) {
    const detailsPage = await VulnerabilityDetailsPage.build(
      page,
      vulnerabilityID,
    );
    await detailsPage._layout.selectTab("Related Advisories");

    return new AdvisoriesTab(page, detailsPage);
  }

  async getToolbar() {
    return await Toolbar.build(this._page, "Advisory toolbar");
  }

  async getTable() {
    return await Table.build(this._page, "Advisory table");
  }

  async getPagination(top: boolean = true) {
    return await Pagination.build(
      this._page,
      `advisory-table-pagination-${top ? "top" : "bottom"}`,
    );
  }
}
