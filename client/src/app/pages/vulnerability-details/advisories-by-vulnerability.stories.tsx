import type { Meta, StoryObj } from "@storybook/react";
import { AdvisoriesByVulnerability } from "./advisories-by-vulnerability";

const meta = {
  title: "Components/VulnerabilityDetails/AdvisoriesByVulnerability",
  component: AdvisoriesByVulnerability,
  parameters: {
    layout: "fullscreen",
  },
  tags: ["autodocs"],
} satisfies Meta<typeof AdvisoriesByVulnerability>;

export default meta;
type Story = StoryObj<typeof meta>;

export const EmptyState: Story = {
  args: {
    isFetching: false,
    advisories: [],
  },
};

export const PrimaryState: Story = {
  args: {
    isFetching: false,
    advisories: [
      {
        uuid: "urn:uuid:753e8448-2086-4908-a027-1f1a7b95fa6a",
        identifier: "CVE-2024-8391",
        document_id: "CVE-2024-8391",
        issuer: {
          id: "9cf89bf3-ef8d-44ba-87a8-66a324795996",
          name: "eclipse",
          cpe_key: null,
          website: null,
        },
        published: "2024-09-04T15:27:58.478Z",
        modified: "2024-09-04T17:40:20.318Z",
        withdrawn: null,
        title:
          "Eclipse Vert.x gRPC server does not limit the maximum message size",
        labels: {
          type: "cve",
          file: "2024/8xxx/CVE-2024-8391.json",
          importer: "cve",
          source: "https://github.com/CVEProject/cvelistV5",
        },
        severity: null,
        score: null,
        cvss3_scores: [],
        purls: {
          affected: [
            {
              base_purl: {
                uuid: "af66fc9c-65d5-5b36-a169-7a417641fb69",
                purl: "pkg://maven/io.vertx/vertx-grpc-server",
              },
              version: "[4.3.0,4.5.10)",
              context: null,
            },
          ],
        },
        number_of_vulnerabilities: 1,
        sboms: [
          {
            id: "urn:uuid:0193013f-1b8a-7152-8857-8b8f4238b8ba",
            document_id:
              "https://access.redhat.com/security/data/sbom/spdx/quarkus-bom-3.2.12.Final-redhat-00002",
            labels: {
              type: "spdx",
            },
            data_licenses: ["CC0-1.0"],
            published: "2024-07-05T09:40:48Z",
            authors: [
              "Organization: Red Hat Product Security (secalert@redhat.com)",
            ],
            name: "quarkus-bom",
            version: "3.2.12.Final-redhat-00002",
            purl_statuses: {
              affected: [],
            },
            number_of_packages: 1,
          },
          {
            id: "urn:uuid:0193013f-0f00-77e1-afe4-b7d7f8585b7a",
            document_id:
              "https://access.redhat.com/security/data/sbom/spdx/quarkus-bom-3.2.11.Final-redhat-00001",
            labels: {
              type: "spdx",
            },
            data_licenses: ["CC0-1.0"],
            published: "2024-05-28T09:26:01Z",
            authors: [
              "Organization: Red Hat Product Security (secalert@redhat.com)",
            ],
            name: "quarkus-bom",
            version: "3.2.11.Final-redhat-00001",
            purl_statuses: {
              affected: [],
            },
            number_of_packages: 1,
          },
        ],
      },
    ],
  },
};
