import type React from "react";

import {
  DescriptionList,
  DescriptionListDescription,
  DescriptionListGroup,
  DescriptionListTermHelpText,
  DescriptionListTermHelpTextButton,
  Grid,
  GridItem,
  Popover,
  Stack,
  StackItem,
} from "@patternfly/react-core";

import type { VulnerabilityDetails } from "@app/client";
import { VulnerabilityDescription } from "@app/components/VulnerabilityDescription";
import { formatDate } from "@app/utils/utils";

interface OverviewProps {
  vulnerability: VulnerabilityDetails;
}

export const Overview: React.FC<OverviewProps> = ({ vulnerability }) => {
  return (
    <Stack hasGutter>
      <StackItem>
        <Grid hasGutter>
          <GridItem md={10}>
            <Grid>
              <GridItem md={8}>
                <DescriptionListGroup>
                  <DescriptionListDescription>
                    <VulnerabilityDescription vulnerability={vulnerability} />
                  </DescriptionListDescription>
                </DescriptionListGroup>
              </GridItem>
            </Grid>
          </GridItem>
          <GridItem md={10}>
            <DescriptionList
              columnModifier={{
                default: "3Col",
              }}
            >
              <DescriptionListGroup>
                <DescriptionListTermHelpText>
                  <Popover
                    bodyContent={
                      <div>
                        The date the Vulnerability identifier was assigned by
                        CVE Numbering Authority (CNA).
                      </div>
                    }
                  >
                    <DescriptionListTermHelpTextButton>
                      Reserved
                    </DescriptionListTermHelpTextButton>
                  </Popover>
                </DescriptionListTermHelpText>
                <DescriptionListDescription>
                  {formatDate(vulnerability.reserved)}
                </DescriptionListDescription>
              </DescriptionListGroup>
              <DescriptionListGroup>
                <DescriptionListTermHelpText>
                  <Popover
                    bodyContent={
                      <div>The date the Vulnerability went public.</div>
                    }
                  >
                    <DescriptionListTermHelpTextButton>
                      Published
                    </DescriptionListTermHelpTextButton>
                  </Popover>
                </DescriptionListTermHelpText>
                <DescriptionListDescription>
                  {formatDate(vulnerability.published)}
                </DescriptionListDescription>
              </DescriptionListGroup>
              <DescriptionListGroup>
                <DescriptionListTermHelpText>
                  <Popover
                    bodyContent={
                      <div>
                        The last date when information for this Vulnerability
                        was updated in the National Vulnerability Database
                        (NVD).
                      </div>
                    }
                  >
                    <DescriptionListTermHelpTextButton>
                      Modified
                    </DescriptionListTermHelpTextButton>
                  </Popover>
                </DescriptionListTermHelpText>
                <DescriptionListDescription>
                  {formatDate(vulnerability.modified)}
                </DescriptionListDescription>
              </DescriptionListGroup>
            </DescriptionList>
          </GridItem>
        </Grid>
      </StackItem>
    </Stack>
  );
};
