(self.webpackChunk_trustify_ui_client=self.webpackChunk_trustify_ui_client||[]).push([[794],{94279:(e,t,a)=>{"use strict";a.d(t,{B8:()=>u});var n,l,r,i=a(34629),s=a(63696),o=a(38740),c=a(62634);!function(e){e.number="1",e.lowercaseLetter="a",e.uppercaseLetter="A",e.lowercaseRomanNumber="i",e.uppercaseRomanNumber="I"}(n||(n={})),function(e){e.inline="inline"}(l||(l={})),function(e){e.ol="ol",e.ul="ul"}(r||(r={}));const u=e=>{var{className:t="",children:a=null,variant:l=null,isBordered:u=!1,isPlain:m=!1,iconSize:d="default",type:p=n.number,ref:E=null,component:f=r.ul}=e,b=(0,i.__rest)(e,["className","children","variant","isBordered","isPlain","iconSize","type","ref","component"]);return f===r.ol?s.createElement("ol",Object.assign({ref:E,type:p},m&&{role:"list"},b,{className:(0,c.A)(o.A.list,l&&o.A.modifiers[l],u&&o.A.modifiers.bordered,m&&o.A.modifiers.plain,d&&"large"===d&&o.A.modifiers.iconLg,t)}),a):s.createElement("ul",Object.assign({ref:E},m&&{role:"list"},b,{className:(0,c.A)(o.A.list,l&&o.A.modifiers[l],u&&o.A.modifiers.bordered,m&&o.A.modifiers.plain,d&&"large"===d&&o.A.modifiers.iconLg,t)}),a)};u.displayName="List"},16172:(e,t,a)=>{"use strict";a.d(t,{c:()=>s});var n=a(34629),l=a(63696),r=a(38740),i=a(62634);const s=e=>{var{icon:t=null,children:a=null}=e,s=(0,n.__rest)(e,["icon","children"]);return l.createElement("li",Object.assign({className:(0,i.A)(t&&r.A.listItem)},s),t&&l.createElement("span",{className:(0,i.A)(r.A.listItemIcon)},t),a)};s.displayName="ListItem"},54518:(e,t,a)=>{"use strict";a.d(t,{B:()=>s});var n=a(34629),l=a(63696),r=a(90829),i=a(62634);const s=e=>{var{hasGutter:t=!1,isWrappable:a=!1,className:s="",children:o=null,component:c="div"}=e,u=(0,n.__rest)(e,["hasGutter","isWrappable","className","children","component"]);const m=c;return l.createElement(m,Object.assign({},u,{className:(0,i.A)(r.A.split,t&&r.A.modifiers.gutter,a&&r.A.modifiers.wrap,s)}),o)};s.displayName="Split"},48281:(e,t,a)=>{"use strict";a.d(t,{o:()=>s});var n=a(34629),l=a(63696),r=a(90829),i=a(62634);const s=e=>{var{isFilled:t=!1,className:a="",children:s=null}=e,o=(0,n.__rest)(e,["isFilled","className","children"]);return l.createElement("div",Object.assign({},o,{className:(0,i.A)(r.A.splitItem,t&&r.A.modifiers.fill,a)}),s)};s.displayName="SplitItem"},48783:(e,t,a)=>{"use strict";a.d(t,{Ay:()=>n});const n=(0,a(32791).w)({name:"DownloadIcon",height:512,width:512,svgPath:"M216 0h80c13.3 0 24 10.7 24 24v168h87.7c17.8 0 26.7 21.5 14.1 34.1L269.7 378.3c-7.5 7.5-19.8 7.5-27.3 0L90.1 226.1c-12.6-12.6-3.7-34.1 14.1-34.1H192V24c0-13.3 10.7-24 24-24zm296 376v112c0 13.3-10.7 24-24 24H24c-13.3 0-24-10.7-24-24V376c0-13.3 10.7-24 24-24h146.7l49 49c20.1 20.1 52.5 20.1 72.6 0l49-49H488c13.3 0 24 10.7 24 24zm-124 88c0-11-9-20-20-20s-20 9-20 20 9 20 20 20 20-9 20-20zm64 0c0-11-9-20-20-20s-20 9-20 20 9 20 20 20 20-9 20-20z",yOffset:0,xOffset:0})},38139:(e,t,a)=>{"use strict";a.d(t,{g:()=>s});var n=a(34629),l=a(63696),r=a(62634),i=a(89863);const s=e=>{var{children:t=null}=e,a=(0,n.__rest)(e,["children"]);return l.createElement("div",Object.assign({},a,{className:(0,r.A)(i.A.tableExpandableRowContent)}),t)};s.displayName="ExpandableRowContent"},22249:function(e,t,a){var n,l;void 0===(l="function"==typeof(n=function(){"use strict";function t(e,t,a){var n=new XMLHttpRequest;n.open("GET",e),n.responseType="blob",n.onload=function(){s(n.response,t,a)},n.onerror=function(){console.error("could not download file")},n.send()}function n(e){var t=new XMLHttpRequest;t.open("HEAD",e,!1);try{t.send()}catch(e){}return 200<=t.status&&299>=t.status}function l(e){try{e.dispatchEvent(new MouseEvent("click"))}catch(a){var t=document.createEvent("MouseEvents");t.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),e.dispatchEvent(t)}}var r="object"==typeof window&&window.window===window?window:"object"==typeof self&&self.self===self?self:"object"==typeof a.g&&a.g.global===a.g?a.g:void 0,i=r.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),s=r.saveAs||("object"!=typeof window||window!==r?function(){}:"download"in HTMLAnchorElement.prototype&&!i?function(e,a,i){var s=r.URL||r.webkitURL,o=document.createElement("a");a=a||e.name||"download",o.download=a,o.rel="noopener","string"==typeof e?(o.href=e,o.origin===location.origin?l(o):n(o.href)?t(e,a,i):l(o,o.target="_blank")):(o.href=s.createObjectURL(e),setTimeout((function(){s.revokeObjectURL(o.href)}),4e4),setTimeout((function(){l(o)}),0))}:"msSaveOrOpenBlob"in navigator?function(e,a,r){if(a=a||e.name||"download","string"!=typeof e)navigator.msSaveOrOpenBlob(function(e,t){return void 0===t?t={autoBom:!1}:"object"!=typeof t&&(console.warn("Deprecated: Expected third argument to be a object"),t={autoBom:!t}),t.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(e.type)?new Blob(["\ufeff",e],{type:e.type}):e}(e,r),a);else if(n(e))t(e,a,r);else{var i=document.createElement("a");i.href=e,i.target="_blank",setTimeout((function(){l(i)}))}}:function(e,a,n,l){if((l=l||open("","_blank"))&&(l.document.title=l.document.body.innerText="downloading..."),"string"==typeof e)return t(e,a,n);var s="application/octet-stream"===e.type,o=/constructor/i.test(r.HTMLElement)||r.safari,c=/CriOS\/[\d]+/.test(navigator.userAgent);if((c||s&&o||i)&&"undefined"!=typeof FileReader){var u=new FileReader;u.onloadend=function(){var e=u.result;e=c?e:e.replace(/^data:[^;]*;/,"data:attachment/file;"),l?l.location.href=e:location=e,l=null},u.readAsDataURL(e)}else{var m=r.URL||r.webkitURL,d=m.createObjectURL(e);l?l.location=d:location.href=d,l=null,setTimeout((function(){m.revokeObjectURL(d)}),4e4)}});r.saveAs=s.saveAs=s,e.exports=s})?n.apply(t,[]):n)||(e.exports=l)},81230:(e,t,a)=>{"use strict";a.d(t,{J4:()=>u,hP:()=>c});var n=a(64917),l=a(86820);a(63260);const r="/api",i=r+"/v2/advisory",s=r+"/v2/sbom",o=e=>{let t="application/json";return(e.name.endsWith(".bz2")||e.name.endsWith(".gz"))&&(t="application/json+bzip2"),t},c=(e,t)=>{const a=e.get(l.fs);return n.A.post(`${i}`,a,{...t,headers:{"Content-Type":o(a)}})},u=(e,t)=>{const a=e.get(l.fs);return n.A.post(`${s}`,a,{...t,headers:{"Content-Type":o(a)}})}},27473:(e,t,a)=>{"use strict";a.d(t,{Y:()=>i});var n=a(63696),l=a(18045),r=a(55399);const i=({vulnerabilitiesSummary:e})=>{const t=n.useMemo((()=>Object.keys(e.severities).map((t=>{const a=t,n=e.severities[a],l=r.Kb[a];return{severity:a,count:n,label:l.name,color:l.color.value}})).sort((0,r.Sx)((e=>e.severity)))),[e]);return n.createElement("div",{style:{height:"230px",maxWidth:"350px"}},n.createElement(l.H,{constrainToVisibleArea:!0,legendOrientation:"vertical",legendPosition:"right",padding:{bottom:20,left:20,right:140,top:20},title:`${e.total}`,subTitle:"Total vulnerabilities",width:350,legendData:t.map((({label:e,count:t})=>({name:`${e}: ${t}`}))),data:t.map((({label:e,count:t})=>({x:e,y:t}))),labels:({datum:e})=>`${e.x}: ${e.y}`,colorScale:t.map((({color:e})=>e))}))}},91271:(e,t,a)=>{"use strict";a.d(t,{m:()=>i});var n=a(22249),l=a(77347),r=a(40752);const i=()=>({downloadAdvisory:(e,t)=>{(0,r.Mu)({client:l.S,path:{key:e},responseType:"arraybuffer",headers:{Accept:"text/plain",responseType:"blob"}}).then((a=>{(0,n.saveAs)(new Blob([a.data]),t||`${e}.json`)}))},downloadSBOM:(e,t)=>{(0,r.K0)({client:l.S,path:{key:e},responseType:"arraybuffer",headers:{Accept:"text/plain",responseType:"blob"}}).then((a=>{(0,n.saveAs)(new Blob([a.data]),t||`${e}.json`)}))}})},89101:(e,t,a)=>{"use strict";a.d(t,{U:()=>c,n:()=>u});var n=a(63696),l=a(91728);const r=(e,t)=>e.vulnerability.identifier===t.vulnerability.identifier&&e.vulnerabilityStatus===t.vulnerabilityStatus,i={total:0,severities:{none:0,low:0,medium:0,high:0,critical:0}},s={vulnerabilityStatus:{affected:{...i},fixed:{...i},not_affected:{...i},known_not_affected:{...i}}},o=e=>{const t=e.flatMap((e=>(e.status??[]).map((t=>({vulnerability:t,vulnerabilityStatus:t.status,advisory:e,packages:t.packages}))).reduce(((e,t)=>{const a=e.find((e=>r(e,t)));if(a)return[...e.filter((e=>!r(e,a))),{...a,relatedPackages:[...a.relatedPackages,{advisory:t.advisory,packages:t.packages}]}];{const a={vulnerability:t.vulnerability,vulnerabilityStatus:t.vulnerabilityStatus,relatedPackages:[{advisory:t.advisory,packages:t.packages}]};return[...e,a]}}),[]))),a=t.reduce(((e,t)=>{const a=t.vulnerabilityStatus,n=t.vulnerability.average_severity,l=e.vulnerabilityStatus[a];return{...e,vulnerabilityStatus:{...e.vulnerabilityStatus,[a]:{total:l.total+1,severities:{...l.severities,[n]:l.severities[n]+1}}}}}),s);return{vulnerabilities:t,summary:a}},c=e=>{const{advisories:t,isFetching:a,fetchError:r}=(0,l.DH)(e);return{data:n.useMemo((()=>o(t||[])),[t]),isFetching:a,fetchError:r}},u=e=>{const{advisories:t,isFetching:a,fetchError:r}=(0,l.zY)(e);return{data:n.useMemo((()=>(t??[]).map((e=>o(e||[])))),[t]),isFetching:a,fetchError:r}}},24808:(e,t,a)=>{"use strict";a.d(t,{v:()=>o});var n=a(63696),l=a(64917),r=a(86820);const i="cancelled",s=(e,t)=>{switch(t.type){case"queueUpload":return{...e,uploads:new Map(e.uploads).set(t.payload.file,{...e.uploads.get(t.payload.file)||{progress:0,status:"queued",error:void 0,response:void 0,wasCancelled:!1,cancelFn:void 0},status:"queued",cancelFn:t.payload.cancelFn})};case"updateUploadProgress":return{...e,uploads:new Map(e.uploads).set(t.payload.file,{...e.uploads.get(t.payload.file)||{progress:0,status:"queued",error:void 0,response:void 0,wasCancelled:!1,cancelFn:void 0},progress:t.payload.progress||0,status:"inProgress"})};case"finishUploadSuccessfully":return{...e,uploads:new Map(e.uploads).set(t.payload.file,{...e.uploads.get(t.payload.file),status:"complete",response:t.payload.response})};case"finishUploadWithError":return{...e,uploads:new Map(e.uploads).set(t.payload.file,{...e.uploads.get(t.payload.file),status:"complete",error:t.payload.error,wasCancelled:t.payload.error?.message===i})};case"removeUpload":{const a=new Map(e.uploads);return a.delete(t.payload.file),{...e,uploads:a}}default:throw new Error}},o=({parallel:e,uploadFn:t,onSuccess:a,onError:o})=>{const[c,u]=n.useReducer(s,{uploads:new Map});return{uploads:c.uploads,handleUpload:n=>{const s=[];for(let e=0;e<n.length;e++){const t=n[e],c=new FormData;c.set(r.fs,t);const m=l.A.CancelToken.source(),d={headers:{"X-Requested-With":"XMLHttpRequest"},onUploadProgress:e=>{const a=e.total??1,n=e.loaded/a*100;u({type:"updateUploadProgress",payload:{file:t,progress:Math.round(n)}})},cancelToken:m.token};u({type:"queueUpload",payload:{file:t,cancelFn:m}});const p={formData:c,config:d,thenFn:e=>{u({type:"finishUploadSuccessfully",payload:{file:t,response:e}}),a&&a(e,t)},catchFn:e=>{u({type:"finishUploadWithError",payload:{file:t,error:e}}),e.message!==i&&o&&o(e,t)}};s.push(p)}e?s.forEach((e=>{t(e.formData,e.config).then(e.thenFn).catch(e.catchFn)})):s.reduce((async(e,a)=>(await e,t(a.formData,a.config).then(a.thenFn).catch(a.catchFn))),Promise.resolve())},handleCancelUpload:e=>{c.uploads.get(e)?.cancelFn?.cancel(i)},handleRemoveUpload:e=>{u({type:"removeUpload",payload:{file:e}})}}}},14671:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>fe});var n=a(63696),l=a(68430),r=a(54518),i=a(48281),s=a(28338),o=a(70045),c=a(1180),u=a(72785),m=a(93962),d=a(77635),p=a(16459),E=a(71592),f=a(40111),b=a(70414),y=a(69673),v=a(10015),h=a(48783),g=a(8210),T=a(80876),S=a(24417),w=a(91271),P=a(91728),k=a(70028),F=a(76072),A=a(97299),B=a(17327),M=a(64361),x=a(71603),_=a(65753),N=a(24974),q=a(21639),C=a(3939),I=a(94279),L=a(16172),K=a(34066);const O=({sbom:e})=>n.createElement(F.x,{hasGutter:!0},n.createElement(A.E,{md:4},n.createElement(B.Z,{isFullHeight:!0},n.createElement(M.Z,null,"Metadata"),n.createElement(x.b,null,n.createElement(_.B,null,n.createElement(N.W,null,n.createElement(q.X,null,"Name"),n.createElement(C.d,{"aria-label":"SBOM's name"},e.name)),n.createElement(N.W,null,n.createElement(q.X,null,"Namespace"),n.createElement(C.d,{"aria-label":"SBOM's namespace"},e.document_id)),n.createElement(N.W,null,n.createElement(q.X,null,"Data License"),n.createElement(C.d,{"aria-label":"SBOM's license"},e.data_licenses.join(", "))))))),n.createElement(A.E,{md:4},n.createElement(B.Z,{isFullHeight:!0},n.createElement(M.Z,null,"Creation"),n.createElement(x.b,null,n.createElement(_.B,null,n.createElement(N.W,null,n.createElement(q.X,null,"Created"),n.createElement(C.d,{"aria-label":"SBOM's creation date"},(0,K.Yq)(e.published))),n.createElement(N.W,null,n.createElement(q.X,null,"Creator"),n.createElement(C.d,{"aria-label":"SBOM's creator"},e.authors)))))),n.createElement(A.E,{md:4},n.createElement(B.Z,{isFullHeight:!0},n.createElement(M.Z,null,"Statistics"),n.createElement(x.b,null,n.createElement(_.B,null,n.createElement(N.W,null,n.createElement(q.X,null,"Size"),n.createElement(C.d,null,(0,k.A)(e.size))),n.createElement(N.W,null,n.createElement(q.X,null,"Packages"),n.createElement(C.d,null,e.number_of_packages)))))),n.createElement(A.E,{md:12},n.createElement(B.Z,{isFullHeight:!0},n.createElement(M.Z,null,"Package"),n.createElement(x.b,null,n.createElement(_.B,null,n.createElement(N.W,null,n.createElement(q.X,null,"Name"),n.createElement(C.d,null,e.name)),n.createElement(N.W,null,n.createElement(q.X,null,"Version"),n.createElement(C.d,null,e.described_by.map((e=>e.version)).join(", "))),n.createElement(N.W,null,n.createElement(q.X,null,"External References"),n.createElement(C.d,null,n.createElement(I.B8,null,e.described_by.flatMap((e=>e.cpe)).map(((e,t)=>n.createElement(L.c,{key:t},e))),n.createElement(L.c,null,e.described_by.flatMap((e=>e.purl)).map((e=>e.purl)))))))))));var R=a(49348),j=a(20653),D=a(35048),$=a(4433),U=a(341),W=a(40319),X=a(16646),V=a(9425),Z=a(77819),H=a(28516),Y=a(3629),z=a(38139),G=a(87043),J=a(16177),Q=a(1349),ee=a(62520),te=a(70611),ae=a(17993);const ne=({sbomId:e})=>{const{result:{data:t},isFetching:a,fetchError:l}=(0,ae.sl)(e,{page:{pageNumber:1,itemsPerPage:0}}),r=(0,n.useMemo)((()=>t.flatMap((e=>e.purl)).map((e=>({...e,decomposedPurl:(0,K.fe)(e.purl)})))),[t]),i=(0,te.vY)({tableName:"package-table",idProperty:"uuid",items:r,isLoading:a,columnNames:{name:"Name",version:"Version",qualifiers:"Qualifiers"},hasActionsColumn:!1,isSortEnabled:!0,sortableColumns:["name","version"],getSortValues:e=>({name:`${e.decomposedPurl?.name}/${e.decomposedPurl?.namespace}`,version:e.version.version}),isPaginationEnabled:!0,isFilterEnabled:!0,filterCategories:[{categoryKey:"filterText",title:"Filter tex",type:G.RJ.search,placeholderText:"Filter",getItemValue:e=>`${e.decomposedPurl?.name}/${e.decomposedPurl?.namespace}`||""}],isExpansionEnabled:!0,expandableVariant:"single"}),{currentPageItems:c,numRenderedColumns:u,propHelpers:{toolbarProps:d,filterToolbarProps:p,paginationToolbarItemProps:E,paginationProps:f,tableProps:b,getThProps:y,getTrProps:v,getTdProps:h,getExpandedContentTdProps:g},expansionDerivedState:{isCellExpanded:T}}=i;return n.createElement(n.Fragment,null,n.createElement(j.M,{...d},n.createElement(D.P,null,n.createElement(G.Us,{showFiltersSideBySide:!0,...p}),n.createElement($.T,{...E},n.createElement(Q.n,{idPrefix:"package-table",isTop:!0,paginationProps:f})))),n.createElement(W.X,{...b,"aria-label":"Package table"},n.createElement(X.d,null,n.createElement(V.Tr,null,n.createElement(ee.Ze,{...i},n.createElement(Z.Th,{...y({columnKey:"name"})}),n.createElement(Z.Th,{...y({columnKey:"version"})}),n.createElement(Z.Th,{...y({columnKey:"qualifiers"})})))),n.createElement(ee.nJ,{isLoading:a,isError:!!l,isNoData:0===r?.length,numRenderedColumns:u},c?.map(((e,t)=>n.createElement(H.N,{key:e.uuid},n.createElement(V.Tr,{...v({item:e})},n.createElement(ee.Oi,{...i,item:e,rowIndex:t},n.createElement(Y.Td,{width:30,...h({columnKey:"name"})},n.createElement(s.s,null,n.createElement(o.Z,{spacer:{default:"spacerSm"}},`${e.decomposedPurl?.name}/${e.decomposedPurl?.namespace}`),n.createElement(o.Z,null,n.createElement(m.J,{isCompact:!0,color:"blue"},e.decomposedPurl?.type)))),n.createElement(Y.Td,{width:20,...h({columnKey:"version"})},e.decomposedPurl?.version),n.createElement(Y.Td,{width:50,...h({columnKey:"qualifiers"})},e.decomposedPurl?.qualifiers&&n.createElement(J.a,{value:e.decomposedPurl?.qualifiers})))),T(e)?n.createElement(V.Tr,{isExpanded:!0},n.createElement(Y.Td,null),n.createElement(Y.Td,{...g({item:e}),className:U.A.pyLg},n.createElement(z.g,null,n.createElement(_.B,{columnModifier:{default:"3Col"}},n.createElement(N.W,null,n.createElement(q.X,null,"Packages"),n.createElement(C.d,null,n.createElement(I.B8,null,n.createElement(L.c,null,n.createElement(R.N_,{to:`/packages/${e.uuid}`},e.purl))))),n.createElement(N.W,null,n.createElement(q.X,null,"Base package"),n.createElement(C.d,null,e.base.purl)),n.createElement(N.W,null,n.createElement(q.X,null,"Versions"),n.createElement(C.d,null,n.createElement(I.B8,null,n.createElement(L.c,null,e.version.version)))))))):null))))),n.createElement(Q.n,{idPrefix:"package-table",isTop:!1,isCompact:!0,paginationProps:f}))};var le=a(95285),re=a.n(le),ie=a(38914),se=a(57901),oe=a(55399),ce=a(27473),ue=a(11848),me=a(23560),de=a(89101),pe=a(15311);const Ee=({sbomId:e})=>{const{sbom:t,isFetching:a,fetchError:l}=(0,P.rj)(e),{data:{vulnerabilities:r,summary:i},isFetching:s,fetchError:o}=(0,de.U)(e),c=n.useMemo((()=>r.filter((e=>"affected"===e.vulnerabilityStatus))),[r]),u=n.useMemo((()=>c.map((e=>{const t=e.relatedPackages.flatMap((e=>e.packages));return{...e,summary:{totalPackages:t.length,allPackages:t}}}))),[c]),m=(0,pe.f)(u,(e=>`${e.vulnerability.identifier}-${e.vulnerabilityStatus}`)),d=(0,te.vY)({tableName:"vulnerability-table",idProperty:"_ui_unique_id",items:m,isLoading:s,columnNames:{id:"Id",description:"Description",cvss:"CVSS",affectedDependencies:"Affected dependencies",published:"Published",updated:"Updated"},hasActionsColumn:!1,isSortEnabled:!0,sortableColumns:["id","cvss","affectedDependencies","published","updated"],getSortValues:e=>({id:e.vulnerability.identifier,cvss:(0,oe.YT)(e.vulnerability.average_severity),affectedDependencies:e.summary.totalPackages,published:e.vulnerability?.published?re()(e.vulnerability.published).valueOf():0,updated:e.vulnerability?.modified?re()(e.vulnerability.modified).valueOf():0}),isPaginationEnabled:!0,isFilterEnabled:!1,isExpansionEnabled:!0,expandableVariant:"compound"}),{currentPageItems:p,numRenderedColumns:E,propHelpers:{toolbarProps:f,filterToolbarProps:b,paginationToolbarItemProps:y,paginationProps:v,tableProps:h,getThProps:g,getTrProps:T,getTdProps:w,getExpandedContentTdProps:k},expansionDerivedState:{isCellExpanded:M}}=d;return n.createElement(n.Fragment,null,n.createElement(ie.B,{hasGutter:!0},n.createElement(se.a,null,n.createElement(B.Z,null,n.createElement(x.b,null,n.createElement(S.a,{isFetching:a||s,fetchError:l},n.createElement(F.x,{hasGutter:!0},n.createElement(A.E,{md:6},n.createElement(ce.Y,{vulnerabilitiesSummary:i.vulnerabilityStatus.affected})),n.createElement(A.E,{md:6},n.createElement(_.B,null,n.createElement(N.W,null,n.createElement(q.X,null,"Name"),n.createElement(C.d,null,t?.name)),n.createElement(N.W,null,n.createElement(q.X,null,"Version"),n.createElement(C.d,null,t?.described_by.map((e=>e.version)).join(", "))),n.createElement(N.W,null,n.createElement(q.X,null,"Creation date"),n.createElement(C.d,null,(0,K.Yq)(t?.published)))))))))),n.createElement(se.a,null,n.createElement(j.M,{...f},n.createElement(D.P,null,n.createElement($.T,{...y},n.createElement(Q.n,{idPrefix:"vulnerability-table",isTop:!0,paginationProps:v})))),n.createElement(W.X,{...h,"aria-label":"Vulnerability table"},n.createElement(X.d,null,n.createElement(V.Tr,null,n.createElement(ee.Ze,{...d},n.createElement(Z.Th,{...g({columnKey:"id"})}),n.createElement(Z.Th,{...g({columnKey:"description"})}),n.createElement(Z.Th,{...g({columnKey:"cvss"})}),n.createElement(Z.Th,{...g({columnKey:"affectedDependencies"})}),n.createElement(Z.Th,{...g({columnKey:"published"})}),n.createElement(Z.Th,{...g({columnKey:"updated"})})))),n.createElement(ee.nJ,{isLoading:s,isError:!!o,isNoData:0===m.length,numRenderedColumns:E},p?.map(((e,t)=>n.createElement(H.N,{key:e._ui_unique_id,isExpanded:M(e)},n.createElement(V.Tr,{...T({item:e})},n.createElement(ee.Oi,{...d,item:e,rowIndex:t},n.createElement(Y.Td,{width:15,...w({columnKey:"id"})},n.createElement(R.N_,{to:`/vulnerabilities/${e.vulnerability.identifier}`},e.vulnerability.identifier)),n.createElement(Y.Td,{width:35,modifier:"truncate",...w({columnKey:"description"})},e.vulnerability&&n.createElement(me.j,{vulnerability:e.vulnerability})),n.createElement(Y.Td,{width:10,...w({columnKey:"cvss"})},e.vulnerability.average_severity&&n.createElement(ue.h,{value:e.vulnerability.average_severity})),n.createElement(Y.Td,{width:15,modifier:"truncate",...w({columnKey:"affectedDependencies",isCompoundExpandToggle:!0,item:e,rowIndex:t})},e.summary.totalPackages),n.createElement(Y.Td,{width:10,modifier:"truncate",...w({columnKey:"published"})},(0,K.Yq)(e.vulnerability?.published)),n.createElement(Y.Td,{width:10,modifier:"truncate",...w({columnKey:"updated"})},(0,K.Yq)(e.vulnerability?.modified)))),M(e)?n.createElement(V.Tr,{isExpanded:!0},n.createElement(Y.Td,{...k({item:e})},n.createElement(z.g,null,M(e,"affectedDependencies")?n.createElement(n.Fragment,null,n.createElement(W.X,{variant:"compact"},n.createElement(X.d,null,n.createElement(V.Tr,null,n.createElement(Z.Th,null,"Type"),n.createElement(Z.Th,null,"Namespace"),n.createElement(Z.Th,null,"Name"),n.createElement(Z.Th,null,"Version"),n.createElement(Z.Th,null,"Path"),n.createElement(Z.Th,null,"Qualifiers"))),n.createElement(H.N,null,e.summary.allPackages.flatMap((e=>e.name&&0==e.purl.length?[{parentName:e.name}]:e.purl.map((t=>({parentName:e.name,purlSummary:t}))))).map(((e,t)=>{if(e.purlSummary){const a=(0,K.fe)(e.purlSummary.purl);return n.createElement(V.Tr,{key:`${t}-purl`},n.createElement(Y.Td,null,a?.type),n.createElement(Y.Td,null,a?.namespace),n.createElement(Y.Td,null,n.createElement(R.N_,{to:`/packages/${e.purlSummary.uuid}`},a?.name)),n.createElement(Y.Td,null,a?.version),n.createElement(Y.Td,null,a?.path),n.createElement(Y.Td,null,a?.qualifiers&&n.createElement(J.a,{value:a?.qualifiers})))}return n.createElement(V.Tr,{key:`${t}-name`},n.createElement(Y.Td,null),n.createElement(Y.Td,null),n.createElement(Y.Td,null,e.parentName),n.createElement(Y.Td,null),n.createElement(Y.Td,null),n.createElement(Y.Td,null))}))))):null))):null))))),n.createElement(Q.n,{idPrefix:"vulnerability-table",isTop:!1,isCompact:!0,paginationProps:v}))))},fe=()=>{const[e,t]=n.useState(0),a=n.createRef(),k=n.createRef(),F=n.createRef(),A=n.createRef(),B=(0,T.Lu)(T.vO.SBOM_ID),{sbom:M,isFetching:x,fetchError:_}=(0,P.rj)(B),{downloadSBOM:N}=(0,w.m)();return n.createElement(n.Fragment,null,n.createElement(l.d8,{variant:"light"},n.createElement(r.B,null,n.createElement(i.o,{isFilled:!0},n.createElement(s.s,null,n.createElement(o.Z,{spacer:{default:"spacerSm"}},n.createElement(c.n,null,n.createElement(u.E,{component:"h1"},M?.name??B??""))),n.createElement(o.Z,null,M?.labels.type&&n.createElement(m.J,{color:"blue"},M?.labels.type)))),n.createElement(i.o,null,!x&&n.createElement(d.$n,{variant:"secondary",icon:n.createElement(h.Ay,null),onClick:()=>{B&&N(B,M?.name?`${M?.name}.json`:`${B}.json`)}},"Download")))),n.createElement(l.d8,{type:"nav"},n.createElement(p.t,{mountOnEnter:!0,activeKey:e,onSelect:(e,a)=>{t(a)},"aria-label":"Tabs that contain the SBOM information",role:"region"},n.createElement(E.o,{eventKey:0,title:n.createElement(f.V,null,"Info"),tabContentId:"refTabInfoSection",tabContentRef:a}),n.createElement(E.o,{eventKey:1,title:n.createElement(f.V,null,"Packages"),tabContentId:"refTabPackagesSection",tabContentRef:k}),n.createElement(E.o,{eventKey:2,title:n.createElement(f.V,null,"Vulnerabilities"),tabContentId:"refVulnerabilitiesSection",tabContentRef:F,actions:n.createElement(n.Fragment,null,n.createElement(b.o,{ref:A},n.createElement(g.Ay,null)),n.createElement(y.A,{triggerRef:A,bodyContent:n.createElement("div",null,"Any found vulnerabilities related to this SBOM. Fixed vulnerabilities are not listed.")}))}))),n.createElement(l.d8,null,n.createElement(v.J,{eventKey:0,id:"refTabInfoSection",ref:a,"aria-label":"Information of the SBOM"},n.createElement(S.a,{isFetching:x,fetchError:_},M&&n.createElement(O,{sbom:M}))),n.createElement(v.J,{eventKey:1,id:"refTabPackagesSection",ref:k,"aria-label":"Packages within the SBOM",hidden:!0},B&&n.createElement(ne,{sbomId:B})),n.createElement(v.J,{eventKey:2,id:"refVulnerabilitiesSection",ref:F,"aria-label":"Vulnerabilities within the SBOM",hidden:!0},B&&n.createElement(Ee,{sbomId:B}))))}},17993:(e,t,a)=>{"use strict";a.d(t,{Lx:()=>o,Si:()=>c,sl:()=>u});var n=a(39155),l=a(77347),r=a(40752),i=a(70611);const s="packages",o=(e={},t=!1)=>{const{data:a,isLoading:o,error:c,refetch:u}=(0,n.I)({queryKey:[s,e],queryFn:()=>(0,r.UD)({client:l.S,query:{...(0,i.kd)(e)}}),refetchInterval:!t&&5e3});return{result:{data:a?.data?.items||[],total:a?.data?.total??0,params:e},isFetching:o,fetchError:c,refetch:u}},c=e=>{const{data:t,isLoading:a,error:i}=(0,n.I)({queryKey:[s,e],queryFn:()=>(0,r.Y0)({client:l.S,path:{key:e}})});return{pkg:t?.data,isFetching:a,fetchError:i}},u=(e,t={})=>{const{data:a,isLoading:o,error:c,refetch:u}=(0,n.I)({queryKey:[s,"by-sbom",e,t],queryFn:()=>(0,r.Ad)({client:l.S,path:{id:e},query:{...(0,i.kd)(t)}})});return{result:{data:a?.data?.items||[],total:a?.data?.total??0,params:t},isFetching:o,fetchError:c,refetch:u}}},91728:(e,t,a)=>{"use strict";a.d(t,{DH:()=>b,Qr:()=>f,i$:()=>d,rj:()=>p,sn:()=>E,zY:()=>y});var n=a(39155),l=a(3715),r=a(55037),i=a(77347),s=a(40752),o=a(24808),c=a(81230),u=a(70611);const m="sboms",d=(e={},t=!1)=>{const{data:a,isLoading:l,error:r,refetch:o}=(0,n.I)({queryKey:[m,e],queryFn:()=>(0,s.z1)({client:i.S,query:{...(0,u.kd)(e)}}),refetchInterval:!t&&5e3});return{result:{data:a?.data?.items||[],total:a?.data?.total??0,params:e??e},isFetching:l,fetchError:r,refetch:o}},p=e=>{const{data:t,isLoading:a,error:l}=(0,n.I)({queryKey:[m,e],queryFn:()=>void 0===e?Promise.resolve(void 0):(0,s.a7)({client:i.S,path:{id:e}}),enabled:void 0!==e});return{sbom:t?.data,isFetching:a,fetchError:l}},E=()=>{const e=(0,l.jE)();return(0,o.v)({parallel:!0,uploadFn:(e,t)=>(0,c.J4)(e,t),onSuccess:()=>{e.invalidateQueries({queryKey:[m]})}})},f=(e,t={})=>{const{data:a,isLoading:l,error:r,refetch:o}=(0,n.I)({queryKey:["SBOMsQueryKeysss","by-package",e,t],queryFn:()=>(0,s.m9)({client:i.S,query:{purl:e,...(0,u.kd)(t)}})});return{result:{data:a?.data?.items||[],total:a?.data?.total??0,params:t??t},isFetching:l,fetchError:r,refetch:o}},b=e=>{const{data:t,isLoading:a,error:l}=(0,n.I)({queryKey:[m,e,"advisory"],queryFn:()=>(0,s.bj)({client:i.S,path:{id:e}})});return{advisories:t?.data||[],isFetching:a,fetchError:l}},y=e=>{const t=(0,r.E)({queries:e.map((e=>({queryKey:[m,e,"advisory"],queryFn:()=>(0,s.bj)({client:i.S,path:{id:e}})})))});return{advisories:t.map((({data:e})=>e?.data||[])),isFetching:t.some((({isLoading:e})=>e)),fetchError:t.map((({error:e})=>e))}}},38740:(e,t,a)=>{"use strict";a.d(t,{A:()=>n});const n={list:"pf-v5-c-list",listItem:"pf-v5-c-list__item",listItemIcon:"pf-v5-c-list__item-icon",modifiers:{iconLg:"pf-m-icon-lg",plain:"pf-m-plain",inline:"pf-m-inline",bordered:"pf-m-bordered"}}},90829:(e,t,a)=>{"use strict";a.d(t,{A:()=>n});const n={modifiers:{wrap:"pf-m-wrap",fill:"pf-m-fill",gutter:"pf-m-gutter"},split:"pf-v5-l-split",splitItem:"pf-v5-l-split__item"}},70028:(e,t,a)=>{"use strict";a.d(t,{A:()=>o});const n=["B","kB","MB","GB","TB","PB","EB","ZB","YB"],l=["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],r=["b","kbit","Mbit","Gbit","Tbit","Pbit","Ebit","Zbit","Ybit"],i=["b","kibit","Mibit","Gibit","Tibit","Pibit","Eibit","Zibit","Yibit"],s=(e,t,a)=>{let n=e;return"string"==typeof t||Array.isArray(t)?n=e.toLocaleString(t,a):!0!==t&&void 0===a||(n=e.toLocaleString(void 0,a)),n};function o(e,t){if(!Number.isFinite(e))throw new TypeError(`Expected a finite number, got ${typeof e}: ${e}`);const a=(t={bits:!1,binary:!1,space:!0,...t}).bits?t.binary?i:r:t.binary?l:n,o=t.space?" ":"";if(t.signed&&0===e)return` 0${o}${a[0]}`;const c=e<0,u=c?"-":t.signed?"+":"";let m;if(c&&(e=-e),void 0!==t.minimumFractionDigits&&(m={minimumFractionDigits:t.minimumFractionDigits}),void 0!==t.maximumFractionDigits&&(m={maximumFractionDigits:t.maximumFractionDigits,...m}),e<1)return u+s(e,t.locale,m)+o+a[0];const d=Math.min(Math.floor(t.binary?Math.log(e)/Math.log(1024):Math.log10(e)/3),a.length-1);return e/=(t.binary?1024:1e3)**d,m||(e=e.toPrecision(3)),u+s(Number(e),t.locale,m)+o+a[d]}}}]);
//# sourceMappingURL=794.1bc6de78.min.js.map