(self.webpackChunk_trustify_ui_client=self.webpackChunk_trustify_ui_client||[]).push([[794],{94279:(e,t,a)=>{"use strict";a.d(t,{B8:()=>u});var n,l,r,i=a(34629),s=a(63696),o=a(38740),c=a(62634);!function(e){e.number="1",e.lowercaseLetter="a",e.uppercaseLetter="A",e.lowercaseRomanNumber="i",e.uppercaseRomanNumber="I"}(n||(n={})),function(e){e.inline="inline"}(l||(l={})),function(e){e.ol="ol",e.ul="ul"}(r||(r={}));const u=e=>{var{className:t="",children:a=null,variant:l=null,isBordered:u=!1,isPlain:d=!1,iconSize:m="default",type:p=n.number,ref:E=null,component:f=r.ul}=e,b=(0,i.__rest)(e,["className","children","variant","isBordered","isPlain","iconSize","type","ref","component"]);return f===r.ol?s.createElement("ol",Object.assign({ref:E,type:p},d&&{role:"list"},b,{className:(0,c.A)(o.A.list,l&&o.A.modifiers[l],u&&o.A.modifiers.bordered,d&&o.A.modifiers.plain,m&&"large"===m&&o.A.modifiers.iconLg,t)}),a):s.createElement("ul",Object.assign({ref:E},d&&{role:"list"},b,{className:(0,c.A)(o.A.list,l&&o.A.modifiers[l],u&&o.A.modifiers.bordered,d&&o.A.modifiers.plain,m&&"large"===m&&o.A.modifiers.iconLg,t)}),a)};u.displayName="List"},16172:(e,t,a)=>{"use strict";a.d(t,{c:()=>s});var n=a(34629),l=a(63696),r=a(38740),i=a(62634);const s=e=>{var{icon:t=null,children:a=null}=e,s=(0,n.__rest)(e,["icon","children"]);return l.createElement("li",Object.assign({className:(0,i.A)(t&&r.A.listItem)},s),t&&l.createElement("span",{className:(0,i.A)(r.A.listItemIcon)},t),a)};s.displayName="ListItem"},54518:(e,t,a)=>{"use strict";a.d(t,{B:()=>s});var n=a(34629),l=a(63696),r=a(90829),i=a(62634);const s=e=>{var{hasGutter:t=!1,isWrappable:a=!1,className:s="",children:o=null,component:c="div"}=e,u=(0,n.__rest)(e,["hasGutter","isWrappable","className","children","component"]);const d=c;return l.createElement(d,Object.assign({},u,{className:(0,i.A)(r.A.split,t&&r.A.modifiers.gutter,a&&r.A.modifiers.wrap,s)}),o)};s.displayName="Split"},48281:(e,t,a)=>{"use strict";a.d(t,{o:()=>s});var n=a(34629),l=a(63696),r=a(90829),i=a(62634);const s=e=>{var{isFilled:t=!1,className:a="",children:s=null}=e,o=(0,n.__rest)(e,["isFilled","className","children"]);return l.createElement("div",Object.assign({},o,{className:(0,i.A)(r.A.splitItem,t&&r.A.modifiers.fill,a)}),s)};s.displayName="SplitItem"},38139:(e,t,a)=>{"use strict";a.d(t,{g:()=>s});var n=a(34629),l=a(63696),r=a(62634),i=a(89863);const s=e=>{var{children:t=null}=e,a=(0,n.__rest)(e,["children"]);return l.createElement("div",Object.assign({},a,{className:(0,r.A)(i.A.tableExpandableRowContent)}),t)};s.displayName="ExpandableRowContent"},22249:function(e,t,a){var n,l;void 0===(l="function"==typeof(n=function(){"use strict";function t(e,t,a){var n=new XMLHttpRequest;n.open("GET",e),n.responseType="blob",n.onload=function(){s(n.response,t,a)},n.onerror=function(){console.error("could not download file")},n.send()}function n(e){var t=new XMLHttpRequest;t.open("HEAD",e,!1);try{t.send()}catch(e){}return 200<=t.status&&299>=t.status}function l(e){try{e.dispatchEvent(new MouseEvent("click"))}catch(a){var t=document.createEvent("MouseEvents");t.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),e.dispatchEvent(t)}}var r="object"==typeof window&&window.window===window?window:"object"==typeof self&&self.self===self?self:"object"==typeof a.g&&a.g.global===a.g?a.g:void 0,i=r.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),s=r.saveAs||("object"!=typeof window||window!==r?function(){}:"download"in HTMLAnchorElement.prototype&&!i?function(e,a,i){var s=r.URL||r.webkitURL,o=document.createElement("a");a=a||e.name||"download",o.download=a,o.rel="noopener","string"==typeof e?(o.href=e,o.origin===location.origin?l(o):n(o.href)?t(e,a,i):l(o,o.target="_blank")):(o.href=s.createObjectURL(e),setTimeout((function(){s.revokeObjectURL(o.href)}),4e4),setTimeout((function(){l(o)}),0))}:"msSaveOrOpenBlob"in navigator?function(e,a,r){if(a=a||e.name||"download","string"!=typeof e)navigator.msSaveOrOpenBlob(function(e,t){return void 0===t?t={autoBom:!1}:"object"!=typeof t&&(console.warn("Deprecated: Expected third argument to be a object"),t={autoBom:!t}),t.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(e.type)?new Blob(["\ufeff",e],{type:e.type}):e}(e,r),a);else if(n(e))t(e,a,r);else{var i=document.createElement("a");i.href=e,i.target="_blank",setTimeout((function(){l(i)}))}}:function(e,a,n,l){if((l=l||open("","_blank"))&&(l.document.title=l.document.body.innerText="downloading..."),"string"==typeof e)return t(e,a,n);var s="application/octet-stream"===e.type,o=/constructor/i.test(r.HTMLElement)||r.safari,c=/CriOS\/[\d]+/.test(navigator.userAgent);if((c||s&&o||i)&&"undefined"!=typeof FileReader){var u=new FileReader;u.onloadend=function(){var e=u.result;e=c?e:e.replace(/^data:[^;]*;/,"data:attachment/file;"),l?l.location.href=e:location=e,l=null},u.readAsDataURL(e)}else{var d=r.URL||r.webkitURL,m=d.createObjectURL(e);l?l.location=m:location.href=m,l=null,setTimeout((function(){d.revokeObjectURL(m)}),4e4)}});r.saveAs=s.saveAs=s,e.exports=s})?n.apply(t,[]):n)||(e.exports=l)},81230:(e,t,a)=>{"use strict";a.d(t,{J4:()=>u,Z3:()=>d,hP:()=>c});var n=a(64917),l=a(86820);a(63260);const r="/api",i=r+"/v2/advisory",s=r+"/v2/sbom",o=e=>{let t="application/json";return(e.name.endsWith(".bz2")||e.name.endsWith(".gz"))&&(t="application/json+bzip2"),t},c=(e,t)=>{const a=e.get(l.fs);return n.A.post(`${i}`,a,{...t,headers:{"Content-Type":o(a)}})},u=(e,t)=>{const a=e.get(l.fs);return n.A.post(`${s}`,a,{...t,headers:{"Content-Type":o(a)}})},d=e=>n.A.get(`${s}/${e}/license-export`,{responseType:"arraybuffer",headers:{Accept:"text/plain",responseType:"blob"}})},27473:(e,t,a)=>{"use strict";a.d(t,{Y:()=>i});var n=a(63696),l=a(18045),r=a(55399);const i=({vulnerabilitiesSummary:e})=>{const t=n.useMemo((()=>Object.keys(e.severities).map((t=>{const a=t,n=e.severities[a],l=r.Kb[a];return{severity:a,count:n,label:l.name,color:l.color.value}})).sort((0,r.Sx)((e=>e.severity)))),[e]);return n.createElement("div",{style:{height:"230px",maxWidth:"350px"}},n.createElement(l.H,{constrainToVisibleArea:!0,legendOrientation:"vertical",legendPosition:"right",padding:{bottom:20,left:20,right:140,top:20},title:`${e.total}`,subTitle:"Total vulnerabilities",width:350,legendData:t.map((({label:e,count:t})=>({name:`${e}: ${t}`}))),data:t.map((({label:e,count:t})=>({x:e,y:t}))),labels:({datum:e})=>`${e.x}: ${e.y}`,colorScale:t.map((({color:e})=>e))}))}},91271:(e,t,a)=>{"use strict";a.d(t,{m:()=>o});var n=a(22249),l=a(81230),r=a(77347),i=a(38595),s=a(34066);const o=()=>({downloadAdvisory:(e,t)=>{(0,i.Mu)({client:r.S,path:{key:e},responseType:"arraybuffer",headers:{Accept:"text/plain",responseType:"blob"}}).then((a=>{(0,n.saveAs)(new Blob([a.data]),t||`${e}.json`)}))},downloadSBOM:(e,t)=>{(0,i.K0)({client:r.S,path:{key:e},responseType:"arraybuffer",headers:{Accept:"text/plain",responseType:"blob"}}).then((a=>{(0,n.saveAs)(new Blob([a.data]),t||`${e}.json`)}))},downloadSBOMLicenses:e=>{(0,l.Z3)(e).then((t=>{let a=null;const l=t.headers?.["content-disposition"]?.toString();l&&(a=(0,s.uz)(l)),(0,n.saveAs)(new Blob([t.data]),a||`${e}.tar.gz`)}))}})},89101:(e,t,a)=>{"use strict";a.d(t,{U:()=>u,n:()=>d});var n=a(63696),l=a(37378),r=a(91728);const i=(e,t)=>e.vulnerability.identifier===t.vulnerability.identifier&&e.vulnerabilityStatus===t.vulnerabilityStatus,s={total:0,severities:{unknown:0,none:0,low:0,medium:0,high:0,critical:0}},o={vulnerabilityStatus:{affected:{...s},fixed:{...s},not_affected:{...s},known_not_affected:{...s}}},c=e=>{const t=e.flatMap((e=>(e.status??[]).map((t=>({vulnerability:t,vulnerabilityStatus:t.status,advisory:e,packages:t.packages}))).reduce(((e,t)=>{const a=e.find((e=>i(e,t)));if(a)return[...e.filter((e=>!i(e,a))),{...a,relatedPackages:[...a.relatedPackages,{advisory:t.advisory,packages:t.packages}]}];{const a={vulnerability:t.vulnerability,vulnerabilityStatus:t.vulnerabilityStatus,relatedPackages:[{advisory:t.advisory,packages:t.packages}]};return[...e,a]}}),[]))),a=t.reduce(((e,t)=>{const a=t.vulnerabilityStatus,n=(0,l.U)(t.vulnerability.average_severity),r=e.vulnerabilityStatus[a];return{...e,vulnerabilityStatus:{...e.vulnerabilityStatus,[a]:{total:r.total+1,severities:{...r.severities,[n]:r.severities[n]+1}}}}}),o);return{vulnerabilities:t,summary:a}},u=e=>{const{advisories:t,isFetching:a,fetchError:l}=(0,r.DH)(e);return{data:n.useMemo((()=>c(t||[])),[t]),isFetching:a,fetchError:l}},d=e=>{const{advisories:t,isFetching:a,fetchError:l}=(0,r.zY)(e);return{data:n.useMemo((()=>(t??[]).map((e=>c(e||[])))),[t]),isFetching:a,fetchError:l}}},24808:(e,t,a)=>{"use strict";a.d(t,{v:()=>o});var n=a(63696),l=a(64917),r=a(86820);const i="cancelled",s=(e,t)=>{switch(t.type){case"queueUpload":return{...e,uploads:new Map(e.uploads).set(t.payload.file,{...e.uploads.get(t.payload.file)||{progress:0,status:"queued",error:void 0,response:void 0,wasCancelled:!1,cancelFn:void 0},status:"queued",cancelFn:t.payload.cancelFn})};case"updateUploadProgress":return{...e,uploads:new Map(e.uploads).set(t.payload.file,{...e.uploads.get(t.payload.file)||{progress:0,status:"queued",error:void 0,response:void 0,wasCancelled:!1,cancelFn:void 0},progress:t.payload.progress||0,status:"inProgress"})};case"finishUploadSuccessfully":return{...e,uploads:new Map(e.uploads).set(t.payload.file,{...e.uploads.get(t.payload.file),status:"complete",response:t.payload.response})};case"finishUploadWithError":return{...e,uploads:new Map(e.uploads).set(t.payload.file,{...e.uploads.get(t.payload.file),status:"complete",error:t.payload.error,wasCancelled:t.payload.error?.message===i})};case"removeUpload":{const a=new Map(e.uploads);return a.delete(t.payload.file),{...e,uploads:a}}default:throw new Error}},o=({parallel:e,uploadFn:t,onSuccess:a,onError:o})=>{const[c,u]=n.useReducer(s,{uploads:new Map});return{uploads:c.uploads,handleUpload:n=>{const s=[];for(let e=0;e<n.length;e++){const t=n[e],c=new FormData;c.set(r.fs,t);const d=l.A.CancelToken.source(),m={headers:{"X-Requested-With":"XMLHttpRequest"},onUploadProgress:e=>{const a=e.total??1,n=e.loaded/a*100;u({type:"updateUploadProgress",payload:{file:t,progress:Math.round(n)}})},cancelToken:d.token};u({type:"queueUpload",payload:{file:t,cancelFn:d}});const p={formData:c,config:m,thenFn:e=>{u({type:"finishUploadSuccessfully",payload:{file:t,response:e}}),a&&a(e,t)},catchFn:e=>{u({type:"finishUploadWithError",payload:{file:t,error:e}}),e.message!==i&&o&&o(e,t)}};s.push(p)}e?s.forEach((e=>{t(e.formData,e.config).then(e.thenFn).catch(e.catchFn)})):s.reduce((async(e,a)=>(await e,t(a.formData,a.config).then(a.thenFn).catch(a.catchFn))),Promise.resolve())},handleCancelUpload:e=>{c.uploads.get(e)?.cancelFn?.cancel(i)},handleRemoveUpload:e=>{u({type:"removeUpload",payload:{file:e}})}}}},14671:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>ge});var n=a(63696),l=a(68430),r=a(54518),i=a(48281),s=a(28338),o=a(70045),c=a(1180),u=a(72785),d=a(93962),m=a(90717),p=a(62381),E=a(52993),f=a(84818),b=a(16459),y=a(71592),g=a(40111),h=a(70414),v=a(69673),T=a(10015),S=a(8210),w=a(80876),P=a(24417),k=a(91271),F=a(91728),A=a(70028),B=a(76072),M=a(97299),x=a(17327),_=a(64361),C=a(71603),N=a(65753),q=a(24974),O=a(21639),L=a(3939),I=a(94279),K=a(16172),R=a(34066);const j=({sbom:e})=>n.createElement(B.x,{hasGutter:!0},n.createElement(M.E,{md:4},n.createElement(x.Z,{isFullHeight:!0},n.createElement(_.Z,null,"Metadata"),n.createElement(C.b,null,n.createElement(N.B,null,n.createElement(q.W,null,n.createElement(O.X,null,"Name"),n.createElement(L.d,{"aria-label":"SBOM's name"},e.name)),n.createElement(q.W,null,n.createElement(O.X,null,"Namespace"),n.createElement(L.d,{"aria-label":"SBOM's namespace"},e.document_id)),n.createElement(q.W,null,n.createElement(O.X,null,"Data License"),n.createElement(L.d,{"aria-label":"SBOM's license"},e.data_licenses.join(", "))))))),n.createElement(M.E,{md:4},n.createElement(x.Z,{isFullHeight:!0},n.createElement(_.Z,null,"Creation"),n.createElement(C.b,null,n.createElement(N.B,null,n.createElement(q.W,null,n.createElement(O.X,null,"Created"),n.createElement(L.d,{"aria-label":"SBOM's creation date"},(0,R.Yq)(e.published))),n.createElement(q.W,null,n.createElement(O.X,null,"Creator"),n.createElement(L.d,{"aria-label":"SBOM's creator"},e.authors)))))),n.createElement(M.E,{md:4},n.createElement(x.Z,{isFullHeight:!0},n.createElement(_.Z,null,"Statistics"),n.createElement(C.b,null,n.createElement(N.B,null,n.createElement(q.W,null,n.createElement(O.X,null,"Size"),n.createElement(L.d,null,(0,A.A)(e.size))),n.createElement(q.W,null,n.createElement(O.X,null,"Packages"),n.createElement(L.d,null,e.number_of_packages)))))),n.createElement(M.E,{md:12},n.createElement(x.Z,{isFullHeight:!0},n.createElement(_.Z,null,"Package"),n.createElement(C.b,null,n.createElement(N.B,null,n.createElement(q.W,null,n.createElement(O.X,null,"Name"),n.createElement(L.d,null,e.name)),n.createElement(q.W,null,n.createElement(O.X,null,"Version"),n.createElement(L.d,null,e.described_by.map((e=>e.version)).join(", "))),n.createElement(q.W,null,n.createElement(O.X,null,"External References"),n.createElement(L.d,null,n.createElement(I.B8,null,e.described_by.flatMap((e=>e.cpe)).map(((e,t)=>n.createElement(K.c,{key:t},e))),n.createElement(K.c,null,e.described_by.flatMap((e=>e.purl)).map((e=>e.purl)))))))))));var D=a(49348),$=a(20653),U=a(35048),W=a(4433),X=a(341),Z=a(40319),V=a(16646),Y=a(9425),H=a(77819),z=a(28516),G=a(3629),J=a(38139),Q=a(87043),ee=a(16177),te=a(1349),ae=a(62520),ne=a(70611),le=a(17993);const re=({sbomId:e})=>{const{result:{data:t},isFetching:a,fetchError:l}=(0,le.sl)(e,{page:{pageNumber:1,itemsPerPage:0}}),r=(0,n.useMemo)((()=>t.flatMap((e=>e.purl)).map((e=>({...e,decomposedPurl:(0,R.fe)(e.purl)})))),[t]),i=(0,ne.vY)({tableName:"package-table",idProperty:"uuid",items:r,isLoading:a,columnNames:{name:"Name",version:"Version",qualifiers:"Qualifiers"},hasActionsColumn:!1,isSortEnabled:!0,sortableColumns:["name","version"],getSortValues:e=>({name:`${e.decomposedPurl?.name}/${e.decomposedPurl?.namespace}`,version:e.version.version}),isPaginationEnabled:!0,isFilterEnabled:!0,filterCategories:[{categoryKey:"filterText",title:"Filter tex",type:Q.RJ.search,placeholderText:"Filter",getItemValue:e=>`${e.decomposedPurl?.name}/${e.decomposedPurl?.namespace}`||""}],isExpansionEnabled:!0,expandableVariant:"single"}),{currentPageItems:c,numRenderedColumns:u,propHelpers:{toolbarProps:m,filterToolbarProps:p,paginationToolbarItemProps:E,paginationProps:f,tableProps:b,getThProps:y,getTrProps:g,getTdProps:h,getExpandedContentTdProps:v},expansionDerivedState:{isCellExpanded:T}}=i;return n.createElement(n.Fragment,null,n.createElement($.M,{...m},n.createElement(U.P,null,n.createElement(Q.Us,{showFiltersSideBySide:!0,...p}),n.createElement(W.T,{...E},n.createElement(te.n,{idPrefix:"package-table",isTop:!0,paginationProps:f})))),n.createElement(Z.X,{...b,"aria-label":"Package table"},n.createElement(V.d,null,n.createElement(Y.Tr,null,n.createElement(ae.Ze,{...i},n.createElement(H.Th,{...y({columnKey:"name"})}),n.createElement(H.Th,{...y({columnKey:"version"})}),n.createElement(H.Th,{...y({columnKey:"qualifiers"})})))),n.createElement(ae.nJ,{isLoading:a,isError:!!l,isNoData:0===r?.length,numRenderedColumns:u},c?.map(((e,t)=>n.createElement(z.N,{key:e.uuid},n.createElement(Y.Tr,{...g({item:e})},n.createElement(ae.Oi,{...i,item:e,rowIndex:t},n.createElement(G.Td,{width:30,...h({columnKey:"name"})},n.createElement(s.s,null,n.createElement(o.Z,{spacer:{default:"spacerSm"}},`${e.decomposedPurl?.name}/${e.decomposedPurl?.namespace}`),n.createElement(o.Z,null,n.createElement(d.J,{isCompact:!0,color:"blue"},e.decomposedPurl?.type)))),n.createElement(G.Td,{width:20,...h({columnKey:"version"})},e.decomposedPurl?.version),n.createElement(G.Td,{width:50,...h({columnKey:"qualifiers"})},e.decomposedPurl?.qualifiers&&n.createElement(ee.a,{value:e.decomposedPurl?.qualifiers})))),T(e)?n.createElement(Y.Tr,{isExpanded:!0},n.createElement(G.Td,null),n.createElement(G.Td,{...v({item:e}),className:X.A.pyLg},n.createElement(J.g,null,n.createElement(N.B,{columnModifier:{default:"3Col"}},n.createElement(q.W,null,n.createElement(O.X,null,"Packages"),n.createElement(L.d,null,n.createElement(I.B8,null,n.createElement(K.c,null,n.createElement(D.N_,{to:`/packages/${e.uuid}`},e.purl))))),n.createElement(q.W,null,n.createElement(O.X,null,"Base package"),n.createElement(L.d,null,e.base.purl)),n.createElement(q.W,null,n.createElement(O.X,null,"Versions"),n.createElement(L.d,null,n.createElement(I.B8,null,n.createElement(K.c,null,e.version.version)))))))):null))))),n.createElement(te.n,{idPrefix:"package-table",isTop:!1,isCompact:!0,paginationProps:f}))};var ie=a(95285),se=a.n(ie),oe=a(38914),ce=a(57901),ue=a(55399),de=a(37378),me=a(27473),pe=a(52302),Ee=a(23560),fe=a(89101),be=a(15311);const ye=({sbomId:e})=>{const{sbom:t,isFetching:a,fetchError:l}=(0,F.rj)(e),{data:{vulnerabilities:r,summary:i},isFetching:s,fetchError:o}=(0,fe.U)(e),c=n.useMemo((()=>r.filter((e=>"affected"===e.vulnerabilityStatus))),[r]),u=n.useMemo((()=>c.map((e=>{const t=e.relatedPackages.flatMap((e=>e.packages)).reduce(((e,t)=>{const a=e.find((e=>e.id===t.id));return a?e:[...e,t]}),[]);return{...e,summary:{totalPackages:t.length,allPackages:t}}}))),[c]),d=(0,be.f)(u,(e=>`${e.vulnerability.identifier}-${e.vulnerabilityStatus}`)),m=(0,ne.vY)({tableName:"vulnerability-table",idProperty:"_ui_unique_id",items:d,isLoading:s,columnNames:{id:"Id",description:"Description",cvss:"CVSS",affectedDependencies:"Affected dependencies",published:"Published",updated:"Updated"},hasActionsColumn:!1,isSortEnabled:!0,sortableColumns:["id","cvss","affectedDependencies","published","updated"],getSortValues:e=>({id:e.vulnerability.identifier,cvss:(0,ue.YT)(e.vulnerability.average_severity),affectedDependencies:e.summary.totalPackages,published:e.vulnerability?.published?se()(e.vulnerability.published).valueOf():0,updated:e.vulnerability?.modified?se()(e.vulnerability.modified).valueOf():0}),isPaginationEnabled:!0,isFilterEnabled:!1,isExpansionEnabled:!0,expandableVariant:"compound"}),{currentPageItems:p,numRenderedColumns:E,propHelpers:{toolbarProps:f,filterToolbarProps:b,paginationToolbarItemProps:y,paginationProps:g,tableProps:h,getThProps:v,getTrProps:T,getTdProps:S,getExpandedContentTdProps:w},expansionDerivedState:{isCellExpanded:k}}=m;return n.createElement(n.Fragment,null,n.createElement(oe.B,{hasGutter:!0},n.createElement(ce.a,null,n.createElement(x.Z,null,n.createElement(C.b,null,n.createElement(P.a,{isFetching:a||s,fetchError:l},n.createElement(B.x,{hasGutter:!0},n.createElement(M.E,{md:6},n.createElement(me.Y,{vulnerabilitiesSummary:i.vulnerabilityStatus.affected})),n.createElement(M.E,{md:6},n.createElement(N.B,null,n.createElement(q.W,null,n.createElement(O.X,null,"Name"),n.createElement(L.d,null,t?.name)),n.createElement(q.W,null,n.createElement(O.X,null,"Version"),n.createElement(L.d,null,t?.described_by.map((e=>e.version)).join(", "))),n.createElement(q.W,null,n.createElement(O.X,null,"Creation date"),n.createElement(L.d,null,(0,R.Yq)(t?.published)))))))))),n.createElement(ce.a,null,n.createElement($.M,{...f},n.createElement(U.P,null,n.createElement(W.T,{...y},n.createElement(te.n,{idPrefix:"vulnerability-table",isTop:!0,paginationProps:g})))),n.createElement(Z.X,{...h,"aria-label":"Vulnerability table"},n.createElement(V.d,null,n.createElement(Y.Tr,null,n.createElement(ae.Ze,{...m},n.createElement(H.Th,{...v({columnKey:"id"})}),n.createElement(H.Th,{...v({columnKey:"description"})}),n.createElement(H.Th,{...v({columnKey:"cvss"})}),n.createElement(H.Th,{...v({columnKey:"affectedDependencies"})}),n.createElement(H.Th,{...v({columnKey:"published"})}),n.createElement(H.Th,{...v({columnKey:"updated"})})))),n.createElement(ae.nJ,{isLoading:s,isError:!!o,isNoData:0===d.length,numRenderedColumns:E},p?.map(((e,t)=>n.createElement(z.N,{key:e._ui_unique_id,isExpanded:k(e)},n.createElement(Y.Tr,{...T({item:e})},n.createElement(ae.Oi,{...m,item:e,rowIndex:t},n.createElement(G.Td,{width:15,...S({columnKey:"id"})},n.createElement(D.N_,{to:`/vulnerabilities/${e.vulnerability.identifier}`},e.vulnerability.identifier)),n.createElement(G.Td,{width:35,modifier:"truncate",...S({columnKey:"description"})},e.vulnerability&&n.createElement(Ee.j,{vulnerability:e.vulnerability})),n.createElement(G.Td,{width:10,...S({columnKey:"cvss"})},n.createElement(pe.h,{value:(0,de.U)(e.vulnerability.average_severity)})),n.createElement(G.Td,{width:15,modifier:"truncate",...S({columnKey:"affectedDependencies",isCompoundExpandToggle:!0,item:e,rowIndex:t})},e.summary.totalPackages),n.createElement(G.Td,{width:10,modifier:"truncate",...S({columnKey:"published"})},(0,R.Yq)(e.vulnerability?.published)),n.createElement(G.Td,{width:10,modifier:"truncate",...S({columnKey:"updated"})},(0,R.Yq)(e.vulnerability?.modified)))),k(e)?n.createElement(Y.Tr,{isExpanded:!0},n.createElement(G.Td,{...w({item:e})},n.createElement(J.g,null,k(e,"affectedDependencies")?n.createElement(n.Fragment,null,n.createElement(Z.X,{variant:"compact"},n.createElement(V.d,null,n.createElement(Y.Tr,null,n.createElement(H.Th,null,"Type"),n.createElement(H.Th,null,"Namespace"),n.createElement(H.Th,null,"Name"),n.createElement(H.Th,null,"Version"),n.createElement(H.Th,null,"Path"),n.createElement(H.Th,null,"Qualifiers"))),n.createElement(z.N,null,e.summary.allPackages.flatMap((e=>e.name&&0==e.purl.length?[{parentName:e.name}]:e.purl.map((t=>({parentName:e.name,purlSummary:t}))))).map(((e,t)=>{if(e.purlSummary){const a=(0,R.fe)(e.purlSummary.purl);return n.createElement(Y.Tr,{key:`${t}-purl`},n.createElement(G.Td,null,a?.type),n.createElement(G.Td,null,a?.namespace),n.createElement(G.Td,null,n.createElement(D.N_,{to:`/packages/${e.purlSummary.uuid}`},a?.name)),n.createElement(G.Td,null,a?.version),n.createElement(G.Td,null,a?.path),n.createElement(G.Td,null,a?.qualifiers&&n.createElement(ee.a,{value:a?.qualifiers})))}return n.createElement(Y.Tr,{key:`${t}-name`},n.createElement(G.Td,null),n.createElement(G.Td,null),n.createElement(G.Td,null,e.parentName),n.createElement(G.Td,null),n.createElement(G.Td,null),n.createElement(G.Td,null))}))))):null))):null))))),n.createElement(te.n,{idPrefix:"vulnerability-table",isTop:!1,isCompact:!0,paginationProps:g}))))},ge=()=>{const e=(0,w.Lu)(w.vO.SBOM_ID),{sbom:t,isFetching:a,fetchError:A}=(0,F.rj)(e),{downloadSBOM:B,downloadSBOMLicenses:M}=(0,k.m)(),[x,_]=n.useState(!1),[C,N]=n.useState(0),q=n.createRef(),O=n.createRef(),L=n.createRef(),I=n.createRef(),K=()=>{_(!x)};return n.createElement(n.Fragment,null,n.createElement(l.d8,{variant:"light"},n.createElement(r.B,null,n.createElement(i.o,{isFilled:!0},n.createElement(s.s,null,n.createElement(o.Z,{spacer:{default:"spacerSm"}},n.createElement(c.n,null,n.createElement(u.E,{component:"h1"},t?.name??e??""))),n.createElement(o.Z,null,t?.labels.type&&n.createElement(d.J,{color:"blue"},t?.labels.type)))),n.createElement(i.o,null,n.createElement(m.m,{isOpen:x,onSelect:()=>_(!1),onOpenChange:e=>_(e),popperProps:{position:"right"},toggle:e=>n.createElement(p.S,{ref:e,onClick:K,isExpanded:x},"Actions"),ouiaId:"BasicDropdown",shouldFocusToggleOnSelect:!0},n.createElement(E.Q,null,n.createElement(f.t,{key:"sbom",onClick:()=>{e&&B(e,t?.name?`${t?.name}.json`:`${e}.json`)}},"Download SBOM"),n.createElement(f.t,{key:"license",onClick:()=>{e&&M(e)}},"Download License Report")))))),n.createElement(l.d8,{type:"nav"},n.createElement(b.t,{mountOnEnter:!0,activeKey:C,onSelect:(e,t)=>{N(t)},"aria-label":"Tabs that contain the SBOM information",role:"region"},n.createElement(y.o,{eventKey:0,title:n.createElement(g.V,null,"Info"),tabContentId:"refTabInfoSection",tabContentRef:q}),n.createElement(y.o,{eventKey:1,title:n.createElement(g.V,null,"Packages"),tabContentId:"refTabPackagesSection",tabContentRef:O}),n.createElement(y.o,{eventKey:2,title:n.createElement(g.V,null,"Vulnerabilities"),tabContentId:"refVulnerabilitiesSection",tabContentRef:L,actions:n.createElement(n.Fragment,null,n.createElement(h.o,{ref:I},n.createElement(S.Ay,null)),n.createElement(v.A,{triggerRef:I,bodyContent:n.createElement("div",null,"Any found vulnerabilities related to this SBOM. Fixed vulnerabilities are not listed.")}))}))),n.createElement(l.d8,null,n.createElement(T.J,{eventKey:0,id:"refTabInfoSection",ref:q,"aria-label":"Information of the SBOM"},n.createElement(P.a,{isFetching:a,fetchError:A},t&&n.createElement(j,{sbom:t}))),n.createElement(T.J,{eventKey:1,id:"refTabPackagesSection",ref:O,"aria-label":"Packages within the SBOM",hidden:!0},e&&n.createElement(re,{sbomId:e})),n.createElement(T.J,{eventKey:2,id:"refVulnerabilitiesSection",ref:L,"aria-label":"Vulnerabilities within the SBOM",hidden:!0},e&&n.createElement(ye,{sbomId:e}))))}},17993:(e,t,a)=>{"use strict";a.d(t,{Lx:()=>o,Si:()=>c,sl:()=>u});var n=a(39155),l=a(77347),r=a(38595),i=a(70611);const s="packages",o=(e={},t=!1)=>{const{data:a,isLoading:o,error:c,refetch:u}=(0,n.I)({queryKey:[s,e],queryFn:()=>(0,r.UD)({client:l.S,query:{...(0,i.kd)(e)}}),enabled:!t});return{result:{data:a?.data?.items||[],total:a?.data?.total??0,params:e},isFetching:o,fetchError:c,refetch:u}},c=e=>{const{data:t,isLoading:a,error:i}=(0,n.I)({queryKey:[s,e],queryFn:()=>(0,r.Y0)({client:l.S,path:{key:e}})});return{pkg:t?.data,isFetching:a,fetchError:i}},u=(e,t={})=>{const{data:a,isLoading:o,error:c,refetch:u}=(0,n.I)({queryKey:[s,"by-sbom",e,t],queryFn:()=>(0,r.Ad)({client:l.S,path:{id:e},query:{...(0,i.kd)(t)}})});return{result:{data:a?.data?.items||[],total:a?.data?.total??0,params:t},isFetching:o,fetchError:c,refetch:u}}},91728:(e,t,a)=>{"use strict";a.d(t,{DH:()=>b,Qr:()=>f,i$:()=>m,rj:()=>p,sn:()=>E,zY:()=>y});var n=a(39155),l=a(3715),r=a(55037),i=a(77347),s=a(38595),o=a(24808),c=a(81230),u=a(70611);const d="sboms",m=(e={},t=!1)=>{const{data:a,isLoading:l,error:r,refetch:o}=(0,n.I)({queryKey:[d,e],queryFn:()=>(0,s.z1)({client:i.S,query:{...(0,u.kd)(e)}}),enabled:!t});return{result:{data:a?.data?.items||[],total:a?.data?.total??0,params:e??e},isFetching:l,fetchError:r,refetch:o}},p=e=>{const{data:t,isLoading:a,error:l}=(0,n.I)({queryKey:[d,e],queryFn:()=>void 0===e?Promise.resolve(void 0):(0,s.a7)({client:i.S,path:{id:e}}),enabled:void 0!==e});return{sbom:t?.data,isFetching:a,fetchError:l}},E=()=>{const e=(0,l.jE)();return(0,o.v)({parallel:!0,uploadFn:(e,t)=>(0,c.J4)(e,t),onSuccess:()=>{e.invalidateQueries({queryKey:[d]})}})},f=(e,t={})=>{const{data:a,isLoading:l,error:r,refetch:o}=(0,n.I)({queryKey:["SBOMsQueryKeysss","by-package",e,t],queryFn:()=>(0,s.m9)({client:i.S,query:{purl:e,...(0,u.kd)(t)}})});return{result:{data:a?.data?.items||[],total:a?.data?.total??0,params:t??t},isFetching:l,fetchError:r,refetch:o}},b=e=>{const{data:t,isLoading:a,error:l}=(0,n.I)({queryKey:[d,e,"advisory"],queryFn:()=>(0,s.bj)({client:i.S,path:{id:e}})});return{advisories:t?.data||[],isFetching:a,fetchError:l}},y=e=>{const t=(0,r.E)({queries:e.map((e=>({queryKey:[d,e,"advisory"],queryFn:()=>(0,s.bj)({client:i.S,path:{id:e}})})))});return{advisories:t.map((({data:e})=>e?.data||[])),isFetching:t.some((({isLoading:e})=>e)),fetchError:t.map((({error:e})=>e))}}},38740:(e,t,a)=>{"use strict";a.d(t,{A:()=>n});const n={list:"pf-v5-c-list",listItem:"pf-v5-c-list__item",listItemIcon:"pf-v5-c-list__item-icon",modifiers:{iconLg:"pf-m-icon-lg",plain:"pf-m-plain",inline:"pf-m-inline",bordered:"pf-m-bordered"}}},90829:(e,t,a)=>{"use strict";a.d(t,{A:()=>n});const n={modifiers:{wrap:"pf-m-wrap",fill:"pf-m-fill",gutter:"pf-m-gutter"},split:"pf-v5-l-split",splitItem:"pf-v5-l-split__item"}},70028:(e,t,a)=>{"use strict";a.d(t,{A:()=>o});const n=["B","kB","MB","GB","TB","PB","EB","ZB","YB"],l=["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],r=["b","kbit","Mbit","Gbit","Tbit","Pbit","Ebit","Zbit","Ybit"],i=["b","kibit","Mibit","Gibit","Tibit","Pibit","Eibit","Zibit","Yibit"],s=(e,t,a)=>{let n=e;return"string"==typeof t||Array.isArray(t)?n=e.toLocaleString(t,a):!0!==t&&void 0===a||(n=e.toLocaleString(void 0,a)),n};function o(e,t){if(!Number.isFinite(e))throw new TypeError(`Expected a finite number, got ${typeof e}: ${e}`);const a=(t={bits:!1,binary:!1,space:!0,...t}).bits?t.binary?i:r:t.binary?l:n,o=t.space?" ":"";if(t.signed&&0===e)return` 0${o}${a[0]}`;const c=e<0,u=c?"-":t.signed?"+":"";let d;if(c&&(e=-e),void 0!==t.minimumFractionDigits&&(d={minimumFractionDigits:t.minimumFractionDigits}),void 0!==t.maximumFractionDigits&&(d={maximumFractionDigits:t.maximumFractionDigits,...d}),e<1)return u+s(e,t.locale,d)+o+a[0];const m=Math.min(Math.floor(t.binary?Math.log(e)/Math.log(1024):Math.log10(e)/3),a.length-1);return e/=(t.binary?1024:1e3)**m,d||(e=e.toPrecision(3)),u+s(Number(e),t.locale,d)+o+a[m]}}}]);
//# sourceMappingURL=794.ff8c1329.min.js.map