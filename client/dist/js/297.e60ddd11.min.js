"use strict";(self.webpackChunk_trustify_ui_client=self.webpackChunk_trustify_ui_client||[]).push([[297],{38139:(e,t,l)=>{l.d(t,{g:()=>c});var n=l(34629),r=l(63696),i=l(62634),a=l(36373);const c=e=>{var{children:t=null}=e,l=(0,n.__rest)(e,["children"]);return r.createElement("div",Object.assign({},l,{className:(0,i.A)(a.A.tableExpandableRowContent)}),t)};c.displayName="ExpandableRowContent"},63095:(e,t,l)=>{l.d(t,{w:()=>i});var n=l(63696),r=l(50705);const i=e=>{const{pushNotification:t}=n.useContext(r.K);return(l,n)=>{let r="";r="string"==typeof e?e:e(l,n),t({title:r,variant:"danger"})}}},94421:(e,t,l)=>{l.r(t),l.d(t,{default:()=>Z});var n=l(63696),r=l(49348),i=l(68430),a=l(1180),c=l(72785),o=l(20653),m=l(35048),s=l(4433),d=l(76072),u=l(97299),E=l(17327),p=l(64361),v=l(71603),g=l(65753),b=l(24974),h=l(21639),y=l(3939),f=l(85578),T=l(16646),C=l(31065),w=l(77819),x=l(28516),P=l(3629),K=l(62101),F=l(38139),k=l(86820),I=l(33273),N=l(24417),S=l(52302),_=l(1349),W=l(62520),M=l(70611),B=l(5098),R=l(74932),X=l(34066),A=l(82476),q=l(70400),O=l(48703),Y=l(63095);const Z=()=>{const e=(0,M.MM)({tableName:"vulnerability",persistenceKeyPrefix:k.rt.vulnerabilities,columnNames:{identifier:"Identifier",title:"Title",severity:"Severity",packages:"Packages",sboms:"SBOMs",advisories:"Advisories"},isPaginationEnabled:!0,isSortEnabled:!0,sortableColumns:[],isFilterEnabled:!0,filterCategories:[{categoryKey:"",title:"Filter text",placeholderText:"Search",type:I.RJ.search},{categoryKey:"average_severity",title:"Severity",placeholderText:"Severity",type:I.RJ.multiselect,selectOptions:[{value:"none",label:"None"},{value:"low",label:"Low"},{value:"medium",label:"Medium"},{value:"high",label:"High"},{value:"critical",label:"Critical"}]}],isExpansionEnabled:!0,expandableVariant:"compound"}),{result:{data:t,total:l},isFetching:N,fetchError:q}=(0,R.WJ)((0,M.Ng)({...e,hubSortFieldKeys:{identifier:"identifier",severity:"average_score"}})),O=(0,R.o5)((0,Y.w)("Error occurred while deleting the vulnerability")),Z=(0,M.PB)({...e,idProperty:"identifier",currentPageItems:t,totalItemCount:l,isLoading:N,selectionState:(0,B.$)({items:t,isEqual:(e,t)=>e.identifier===t.identifier})}),{numRenderedColumns:D,currentPageItems:G,propHelpers:{toolbarProps:L,filterToolbarProps:V,paginationToolbarItemProps:$,paginationProps:j,tableProps:z,getThProps:U,getTrProps:Q,getTdProps:ee,getExpandedContentTdProps:te},expansionDerivedState:{isCellExpanded:le}}=Z;return n.createElement(n.Fragment,null,n.createElement(i.d8,{variant:i.zC.light},n.createElement(a.n,null,n.createElement(c.E,{component:"h1"},"Vulnerabilities"))),n.createElement(i.d8,null,n.createElement("div",{style:{backgroundColor:"var(--pf-v5-global--BackgroundColor--100)"}},n.createElement(o.M,{...L},n.createElement(m.P,null,n.createElement(I.Us,{showFiltersSideBySide:!0,...V}),n.createElement(s.T,{...$},n.createElement(_.n,{idPrefix:"vulnerability-table",isTop:!0,paginationProps:j})))),n.createElement(f.X,{...z,"aria-label":"Vulnerability table"},n.createElement(T.d,null,n.createElement(C.Tr,null,n.createElement(W.Ze,{...Z},n.createElement(w.Th,{...U({columnKey:"identifier"})}),n.createElement(w.Th,{...U({columnKey:"title"})}),n.createElement(w.Th,{...U({columnKey:"severity"})}),n.createElement(w.Th,{...U({columnKey:"packages"})}),n.createElement(w.Th,{...U({columnKey:"sboms"})}),n.createElement(w.Th,{...U({columnKey:"advisories"})})))),n.createElement(W.nJ,{isLoading:N,isError:!!q,isNoData:0===l,numRenderedColumns:D},G.map(((e,t)=>n.createElement(x.N,{key:e.identifier,isExpanded:le(e)},n.createElement(C.Tr,{...Q({item:e})},n.createElement(W.Oi,{...Z,item:e,rowIndex:t},n.createElement(P.Td,{width:15,...ee({columnKey:"identifier",isCompoundExpandToggle:!0,item:e,rowIndex:t})},n.createElement(r.k2,{to:`/vulnerabilities/${e.identifier}`},e.identifier)),n.createElement(P.Td,{width:45,modifier:"truncate",...ee({columnKey:"title"})},e.title||e.description),n.createElement(P.Td,{width:10,...ee({columnKey:"severity"})},e.average_severity&&n.createElement(S.h,{value:e.average_severity})),n.createElement(P.Td,{width:10,modifier:"truncate",...ee({columnKey:"packages",isCompoundExpandToggle:!0,item:e,rowIndex:t})},"Packages"),n.createElement(P.Td,{width:10,modifier:"truncate",...ee({columnKey:"sboms",isCompoundExpandToggle:!0,item:e,rowIndex:t})},"SBOMs"),n.createElement(P.Td,{width:10,...ee({columnKey:"advisories",isCompoundExpandToggle:!0,item:e,rowIndex:t})},"Advisories"),n.createElement(P.Td,{isActionCell:!0},n.createElement(K.G,{items:[{title:"Delete",onClick:()=>O.mutate(e.identifier)}]})))),le(e)?n.createElement(C.Tr,{isExpanded:!0},n.createElement(P.Td,{...te({item:e})},n.createElement(F.g,null,n.createElement("div",{className:"pf-v5-u-m-md"},le(e,"identifier")?n.createElement(n.Fragment,null,n.createElement(d.x,{hasGutter:!0},n.createElement(u.E,{md:8},n.createElement(E.Z,{isFullHeight:!0,isCompact:!0},n.createElement(p.Z,null,"General view"),n.createElement(v.b,null,n.createElement(g.B,{columnModifier:{default:"2Col"}},n.createElement(b.W,null,n.createElement(h.X,null,"Published"),n.createElement(y.d,null,(0,X.Yq)(e.published))),n.createElement(b.W,null,n.createElement(h.X,null,"Modified"),n.createElement(y.d,null,(0,X.Yq)(e.modified))),n.createElement(b.W,null,n.createElement(h.X,null,"Released"),n.createElement(y.d,null,(0,X.Yq)(e.released))),n.createElement(b.W,null,n.createElement(h.X,null,"Withdrawn"),n.createElement(y.d,null,(0,X.Yq)(e.withdrawn))))))),n.createElement(u.E,{md:4},n.createElement(E.Z,{isFullHeight:!0,isCompact:!0},n.createElement(p.Z,null,"Additional info"),n.createElement(v.b,null,n.createElement(g.B,null,n.createElement(b.W,null,n.createElement(h.X,null,"CWE"),n.createElement(y.d,null,e.cwe)),n.createElement(b.W,null,n.createElement(h.X,null,"Non normative"),n.createElement(y.d,null,e.normative?"Yes":"No")))))))):null,le(e,"packages")?n.createElement(n.Fragment,null,n.createElement(H,{vulnerabilityId:e.identifier})):null,le(e,"sboms")?n.createElement(n.Fragment,null,n.createElement(J,{vulnerabilityId:e.identifier})):null,le(e,"advisories")?n.createElement(n.Fragment,null,n.createElement(A.N,{variant:"compact",advisories:e.advisories})):null)))):null))))),n.createElement(_.n,{idPrefix:"vulnerability-table",isTop:!1,isCompact:!0,paginationProps:j}))))},H=({vulnerabilityId:e})=>{const{vulnerability:t,isFetching:l,fetchError:r}=(0,R.uN)(e);return n.createElement(N.a,{isFetching:l,fetchError:r},n.createElement(q.n,{variant:"compact",initialItemsPerPage:5,advisories:t?.advisories??[]}))},J=({vulnerabilityId:e})=>{const{vulnerability:t,isFetching:l,fetchError:r}=(0,R.uN)(e);return n.createElement(N.a,{isFetching:l,fetchError:r},n.createElement(O.m,{variant:"compact",advisories:t?.advisories??[]}))}}}]);
//# sourceMappingURL=297.e60ddd11.min.js.map