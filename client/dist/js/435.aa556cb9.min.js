"use strict";(self.webpackChunk_trustify_ui_client=self.webpackChunk_trustify_ui_client||[]).push([[435],{38914:(e,t,a)=>{a.d(t,{B:()=>s});var l=a(34629),n=a(63696),r=a(13364),i=a(62634);const s=e=>{var{hasGutter:t=!1,className:a="",children:s=null,component:c="div"}=e,m=(0,l.__rest)(e,["hasGutter","className","children","component"]);const o=c;return n.createElement(o,Object.assign({},m,{className:(0,i.A)(r.A.stack,t&&r.A.modifiers.gutter,a)}),s)};s.displayName="Stack"},57901:(e,t,a)=>{a.d(t,{a:()=>s});var l=a(34629),n=a(63696),r=a(13364),i=a(62634);const s=e=>{var{isFilled:t=!1,className:a="",children:s=null}=e,c=(0,l.__rest)(e,["isFilled","className","children"]);return n.createElement("div",Object.assign({},c,{className:(0,i.A)(r.A.stackItem,t&&r.A.modifiers.fill,a)}),s)};s.displayName="StackItem"},38139:(e,t,a)=>{a.d(t,{g:()=>s});var l=a(34629),n=a(63696),r=a(62634),i=a(89863);const s=e=>{var{children:t=null}=e,a=(0,l.__rest)(e,["children"]);return n.createElement("div",Object.assign({},a,{className:(0,r.A)(i.A.tableExpandableRowContent)}),t)};s.displayName="ExpandableRowContent"},68248:(e,t,a)=>{a.d(t,{f:()=>s});var l=a(63696),n=a(74932);const r=(e,t)=>e.sbom.id===t.sbom.id&&e.sbomStatus===t.sbomStatus,i={total:0,sbomStatus:{affected:0,fixed:0,known_not_affected:0,not_affected:0}},s=e=>{const{vulnerability:t,isFetching:a,fetchError:s}=(0,n.uN)(e);return{data:l.useMemo((()=>(e=>{const t=e.flatMap((e=>(e.sboms??[]).flatMap((t=>Object.entries(t.purl_statuses||{}).map((([a,l])=>({sbom:{...t},sbomStatus:a,advisory:e,packages:l}))))).reduce(((e,t)=>{const a=e.find((e=>r(e,t)));if(a)return[...e.filter((e=>!r(e,a))),{...a,relatedPackages:[...a.relatedPackages,{advisory:t.advisory,packages:t.packages}]}];{const a={sbom:t.sbom,sbomStatus:t.sbomStatus,relatedPackages:[{advisory:t.advisory,packages:t.packages}]};return[...e,a]}}),[]))),a=t.reduce(((e,t)=>{const a=t.sbomStatus;return{...e,total:e.total+1,sbomStatus:{...e.sbomStatus,[a]:e.sbomStatus[a]+1}}}),i);return{sboms:t,summary:a}})(t?.advisories||[])),[t]),isFetching:a,fetchError:s}}},46725:(e,t,a)=>{a.r(t),a.d(t,{default:()=>z});var l=a(63696),n=a(68430),r=a(28338),i=a(70045),s=a(1180),c=a(72785),m=a(16459),o=a(71592),d=a(40111),u=a(10015),E=a(80876),p=a(24417),b=a(11848),h=a(74932),v=a(20653),f=a(35048),y=a(4433),g=a(40319),T=a(16646),P=a(9425),S=a(77819),_=a(28516),k=a(3629),K=a(49348),N=a(87043),x=a(1349),C=a(62520),F=a(70611),I=a(34066);const w=({advisories:e})=>{const t=(0,F.vY)({tableName:"advisory-table",idProperty:"uuid",items:e,isLoading:!1,columnNames:{identifier:"ID",title:"Title",severity:"Aggregated Severity",revision:"Revision",vulnerabilities:"Vulnerabilities"},hasActionsColumn:!1,isSortEnabled:!1,isPaginationEnabled:!0,initialItemsPerPage:10,isFilterEnabled:!0,filterCategories:[{categoryKey:"filterText",title:"Filter text",placeholderText:"Search",type:N.RJ.search,getItemValue:e=>e.identifier??""}]}),{currentPageItems:a,numRenderedColumns:n,propHelpers:{toolbarProps:r,filterToolbarProps:i,paginationToolbarItemProps:s,paginationProps:c,tableProps:m,getThProps:o,getTrProps:d,getTdProps:u}}=t;return l.createElement(l.Fragment,null,t.isFilterEnabled&&l.createElement(v.M,{...r},l.createElement(f.P,null,l.createElement(N.Us,{showFiltersSideBySide:!0,...i}),l.createElement(y.T,{...s},l.createElement(x.n,{idPrefix:"advisory-table",isTop:!0,paginationProps:c})))),l.createElement(g.X,{...m,"aria-label":"Advisory table"},l.createElement(T.d,null,l.createElement(P.Tr,null,l.createElement(C.Ze,{...t},l.createElement(S.Th,{...o({columnKey:"identifier"})}),l.createElement(S.Th,{...o({columnKey:"title"})}),l.createElement(S.Th,{...o({columnKey:"severity"})}),l.createElement(S.Th,{...o({columnKey:"revision"})}),l.createElement(S.Th,{...o({columnKey:"vulnerabilities"})})))),l.createElement(C.nJ,{isLoading:!1,isError:void 0,isNoData:0===e.length,numRenderedColumns:n},l.createElement(_.N,null,a?.map((e=>l.createElement(P.Tr,{key:e.identifier,...d({item:e})},l.createElement(k.Td,{width:15,...u({columnKey:"identifier"})},l.createElement(K.N_,{to:`/advisories/${e.uuid}`},e.document_id)),l.createElement(k.Td,{width:50,modifier:"truncate",...u({columnKey:"title"})},e.title),l.createElement(k.Td,{width:10,...u({columnKey:"severity"})},e.severity&&l.createElement(b.h,{value:e.severity})),l.createElement(k.Td,{width:10,modifier:"truncate",...u({columnKey:"revision"})},(0,I.Yq)(e.modified)),l.createElement(k.Td,{width:10,modifier:"truncate",...u({columnKey:"vulnerabilities"})},e.number_of_vulnerabilities))))))),l.createElement(x.n,{idPrefix:"advisory-table",isTop:!1,isCompact:!0,paginationProps:c}))};var A=a(38914),R=a(57901),q=a(76072),V=a(97299),O=a(24974),L=a(3939),M=a(65753),B=a(21639),J=a(23560);const Y=({vulnerability:e})=>l.createElement(l.Fragment,null,l.createElement(A.B,{hasGutter:!0},l.createElement(R.a,null,l.createElement(q.x,{hasGutter:!0},l.createElement(V.E,{md:10},l.createElement(q.x,null,l.createElement(V.E,{md:8},l.createElement(O.W,null,l.createElement(L.d,null,l.createElement(J.j,{vulnerability:e})))))),l.createElement(V.E,{md:10},l.createElement(M.B,{columnModifier:{default:"3Col"}},l.createElement(O.W,null,l.createElement(B.X,null,"Reserved"),l.createElement(L.d,null,(0,I.Yq)(e.reserved))),l.createElement(O.W,null,l.createElement(B.X,null,"Published date"),l.createElement(L.d,null,(0,I.Yq)(e.published))),l.createElement(O.W,null,l.createElement(B.X,null,"Last modified"),l.createElement(L.d,null,(0,I.Yq)(e.modified)))))))));var j=a(95285),D=a.n(j),X=a(38139),$=a(93962);const W=({value:e})=>l.createElement($.J,null,e.charAt(0).toUpperCase()+e.slice(1).replace("_"," "));var G=a(68248),Z=a(15311),U=a(16177);const H=({vulnerabilityId:e})=>{const{data:{sboms:t},isFetching:a,fetchError:n}=(0,G.f)(e),r=(0,Z.f)(t,(e=>`${e.sbom.id}-${e.sbomStatus}`)),i=(0,F.vY)({tableName:"sboms-table",idProperty:"_ui_unique_id",items:r,isLoading:a,columnNames:{name:"Name",version:"Version",status:"Status",dependencies:"Dependencies",supplier:"Supplier",created:"Created on"},hasActionsColumn:!1,isSortEnabled:!0,sortableColumns:["name","dependencies","created"],getSortValues:e=>({name:e.sbom.name,dependencies:e.sbom.number_of_packages,created:e.sbom?.published?D()(e.sbom.published).valueOf():0}),isPaginationEnabled:!0,isFilterEnabled:!0,filterCategories:[{categoryKey:"filterText",title:"Filter text",placeholderText:"Search",type:N.RJ.search,getItemValue:e=>e.sbom?.name??""}],isExpansionEnabled:!0,expandableVariant:"compound"}),{currentPageItems:s,numRenderedColumns:c,propHelpers:{toolbarProps:m,filterToolbarProps:o,paginationToolbarItemProps:d,paginationProps:u,tableProps:E,getThProps:p,getTrProps:b,getTdProps:h,getExpandedContentTdProps:w},expansionDerivedState:{isCellExpanded:A}}=i;return l.createElement(l.Fragment,null,i.isFilterEnabled&&l.createElement(v.M,{...m},l.createElement(f.P,null,l.createElement(y.T,{...d},l.createElement(x.n,{idPrefix:"sbom-table",isTop:!0,paginationProps:u})))),l.createElement(g.X,{...E,"aria-label":"Sbom table"},l.createElement(T.d,null,l.createElement(P.Tr,null,l.createElement(C.Ze,{...i},l.createElement(S.Th,{...p({columnKey:"name"})}),l.createElement(S.Th,{...p({columnKey:"version"})}),l.createElement(S.Th,{...p({columnKey:"status"})}),l.createElement(S.Th,{...p({columnKey:"dependencies"})}),l.createElement(S.Th,{...p({columnKey:"supplier"})}),l.createElement(S.Th,{...p({columnKey:"created"})})))),l.createElement(C.nJ,{isLoading:a,isError:!!n,isNoData:0===r.length,numRenderedColumns:c},s?.map(((e,t)=>l.createElement(_.N,{key:e._ui_unique_id,isExpanded:A(e)},l.createElement(P.Tr,{...b({item:e})},l.createElement(C.Oi,{...i,item:e,rowIndex:t},l.createElement(k.Td,{width:25,...h({columnKey:"name"})},l.createElement(K.N_,{to:`/sboms/${e.sbom.id}`},e?.sbom?.name)),l.createElement(k.Td,{width:10,...h({columnKey:"version"})},e.sbom?.version),l.createElement(k.Td,{width:10,modifier:"truncate",...h({columnKey:"status"})},l.createElement(W,{value:e.sbomStatus})),l.createElement(k.Td,{width:10,...h({columnKey:"dependencies",isCompoundExpandToggle:!0,item:e,rowIndex:t})},e.relatedPackages.length),l.createElement(k.Td,{width:10,...h({columnKey:"supplier"})},e?.sbom?.authors.join(", ")),l.createElement(k.Td,{width:10,modifier:"truncate",...h({columnKey:"created"})},(0,I.Yq)(e.sbom?.published)))),A(e)?l.createElement(P.Tr,{isExpanded:!0},l.createElement(k.Td,{...w({item:e})},l.createElement(X.g,null,A(e,"dependencies")?l.createElement(l.Fragment,null,l.createElement(g.X,{variant:"compact"},l.createElement(T.d,null,l.createElement(P.Tr,null,l.createElement(S.Th,null,"Type"),l.createElement(S.Th,null,"Namespace"),l.createElement(S.Th,null,"Name"),l.createElement(S.Th,null,"Version"),l.createElement(S.Th,null,"Path"),l.createElement(S.Th,null,"Qualifiers"))),l.createElement(_.N,null,e.relatedPackages.flatMap((e=>e.packages)).map(((e,t)=>{const a=(0,I.fe)(e.purl);return l.createElement(P.Tr,{key:`${t}-purl`},l.createElement(k.Td,null,a?.type),l.createElement(k.Td,null,a?.namespace),l.createElement(k.Td,null,l.createElement(K.N_,{to:`/packages/${e.uuid}`},a?.name)),l.createElement(k.Td,null,a?.version),l.createElement(k.Td,null,a?.path),l.createElement(k.Td,null,a?.qualifiers&&l.createElement(U.a,{value:a?.qualifiers})))}))))):null))):null))))),l.createElement(x.n,{idPrefix:"sboms-table",isTop:!1,isCompact:!0,paginationProps:u}))},z=()=>{const e=(0,E.Lu)(E.vO.VULNERABILITY_ID),{vulnerability:t,isFetching:a,fetchError:v}=(0,h.uN)(e),[f,y]=(0,l.useState)(0),g=l.createRef(),T=l.createRef();return l.createElement(l.Fragment,null,l.createElement(n.d8,{variant:n.zC.light},l.createElement(r.s,null,l.createElement(i.Z,null,l.createElement(s.n,null,l.createElement(c.E,{component:"h1"},t?.identifier??""," "))),l.createElement(i.Z,null,t?.average_severity?l.createElement(b.h,{value:t.average_severity}):l.createElement(l.Fragment,null))),l.createElement("div",{className:"pf-v5-u-m-md"},l.createElement(p.a,{isFetching:a,fetchError:v},t&&l.createElement(Y,{vulnerability:t})))),l.createElement(n.d8,{type:"nav"},l.createElement(m.t,{mountOnEnter:!0,activeKey:f,onSelect:(e,t)=>{y(t)},"aria-label":"Vulnerability detail tabs",role:"region"},l.createElement(o.o,{eventKey:0,title:l.createElement(d.V,null,"Related SBOMs"),tabContentId:"refTabSbomsSection",tabContentRef:g,"aria-label":"Related SBOMs for this Vulnerability"}),l.createElement(o.o,{eventKey:1,title:l.createElement(d.V,null,"Related Advisories"),tabContentId:"refTabAdvisoriesSection",tabContentRef:T,"aria-label":"Advisories that explain the current Vulnerability"}))),l.createElement(n.d8,null,l.createElement(u.J,{eventKey:0,id:"refTabSbomsSection",ref:g,"aria-label":"Related SBOMs"},l.createElement(H,{vulnerabilityId:e})),l.createElement(u.J,{eventKey:1,id:"refTabAdvisoriesSection",ref:T,"aria-label":"Related Advisories",hidden:!0},l.createElement(w,{isFetching:a,fetchError:v,advisories:t?.advisories||[]}))))}},74932:(e,t,a)=>{a.d(t,{WJ:()=>c,uN:()=>m});var l=a(39155),n=a(77347),r=a(40752),i=a(70611);const s="vulnerabilities",c=(e={},t=!1)=>{const{data:a,isLoading:c,error:m,refetch:o}=(0,l.I)({queryKey:[s,e],queryFn:()=>(0,r.NI)({client:n.S,query:{...(0,i.kd)(e)}}),refetchInterval:!t&&5e3});return{result:{data:a?.data?.items||[],total:a?.data?.total??0,params:e},isFetching:c,fetchError:m,refetch:o}},m=e=>{const{data:t,isLoading:a,error:i}=(0,l.I)({queryKey:[s,e],queryFn:()=>(0,r.wk)({client:n.S,path:{id:e}})});return{vulnerability:t?.data,isFetching:a,fetchError:i}}},13364:(e,t,a)=>{a.d(t,{A:()=>l});const l={modifiers:{fill:"pf-m-fill",gutter:"pf-m-gutter"},stack:"pf-v5-l-stack",stackItem:"pf-v5-l-stack__item"}}}]);
//# sourceMappingURL=435.aa556cb9.min.js.map