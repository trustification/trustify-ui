"use strict";(self.webpackChunk_trustify_ui_client=self.webpackChunk_trustify_ui_client||[]).push([["46"],{92934:function(e,i,t){t.d(i,{F:()=>c,P:()=>u});var l=t(24246),r=t(27378),n=t(74502),s=t(32947),a=t(14629),d=t(49988),o=t(17598);let u=r.createContext({}),c=e=>{let{children:i}=e,[t,c]=r.useState(""),[y,h]=r.useState("");r.useEffect(()=>{let e=setTimeout(()=>{h(t)},400);return()=>clearTimeout(e)},[t]);let{labels:m}=(0,o.VY)(y),p=(0,d.vZ)({tableName:"advisory",persistenceKeyPrefix:n.yq.advisories,persistTo:"urlParams",columnNames:{identifier:"ID",title:"Title",type:"Type",labels:"Labels",modified:"Revision",vulnerabilities:"Vulnerabilities"},isPaginationEnabled:!0,isSortEnabled:!0,sortableColumns:["identifier","modified"],initialSort:{columnKey:"modified",direction:"desc"},isFilterEnabled:!0,filterCategories:[{categoryKey:n.L4,title:"Filter text",placeholderText:"Search",type:a.vA.search},{categoryKey:"modified",title:"Revision",type:a.vA.dateRange},{categoryKey:"labels",title:"Label",type:a.vA.autocompleteLabel,placeholderText:"Filter results by label",selectOptions:m.map(e=>{let i=(0,s.W)({key:e.key,value:e.value});return{value:i,label:i}}),onInputValueChange:c}],isExpansionEnabled:!1}),{result:{data:x,total:f},isFetching:b,fetchError:v}=(0,o.N7)((0,d.QO)({...p,hubSortFieldKeys:{identifier:"identifier",modified:"modified"}}),(p.filterState.filterValues.labels??[]).map(e=>(0,s.nE)(e))),j=(0,d.KC)({...p,idProperty:"identifier",currentPageItems:x,totalItemCount:f,isLoading:b});return(0,l.jsx)(u.Provider,{value:{totalItemCount:f,isFetching:b,fetchError:v,tableControls:j},children:i})}},26179:function(e,i,t){t.d(i,{H:()=>w});var l=t(24246),r=t(27378),n=t(65783),s=t(79551),a=t(32489),d=t(90519),o=t(4835),u=t(14350),c=t(11165),y=t(89330),h=t(31423),m=t(94154),p=t(88935),x=t(3804),f=t(31336),b=t(73227),v=t(7615),j=t(49304),g=t(63706),T=t(32947),K=t(73827),C=t(92934),E=t(15167);let w=()=>{let{isFetching:e,fetchError:i,totalItemCount:t,tableControls:w}=r.useContext(C.P),[S,q]=r.useState(null),F=null!==S,{numRenderedColumns:L,currentPageItems:k,propHelpers:{paginationProps:P,tableProps:_,getThProps:A,getTrProps:D,getTdProps:N},expansionDerivedState:{isCellExpanded:V},filterState:{filterValues:I,setFilterValues:O}}=w,{downloadAdvisory:R}=(0,b.i)(),$=()=>{q(null)};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)(o.i,{..._,"aria-label":"advisory-table",children:[(0,l.jsx)(u.h,{children:(0,l.jsx)(c.Tr,{children:(0,l.jsxs)(f.qK,{...w,children:[(0,l.jsx)(y.Th,{...A({columnKey:"identifier"})}),(0,l.jsx)(y.Th,{...A({columnKey:"title"})}),(0,l.jsx)(y.Th,{...A({columnKey:"type"})}),(0,l.jsx)(y.Th,{...A({columnKey:"labels"})}),(0,l.jsx)(y.Th,{...A({columnKey:"modified"})}),(0,l.jsx)(y.Th,{...A({columnKey:"vulnerabilities"})})]})})}),(0,l.jsx)(f.hp,{isLoading:e,isError:!!i,isNoData:0===t,numRenderedColumns:L,children:k.map((e,i)=>{let t=e.vulnerabilities.reduce((e,i)=>{let t=(0,v.g)(i.severity);return Object.assign(e,{[t]:e[t]+1})},{critical:0,high:0,medium:0,low:0,none:0,unknown:0});return(0,l.jsx)(h.p,{isExpanded:V(e),children:(0,l.jsx)(c.Tr,{...D({item:e}),children:(0,l.jsxs)(f.Cx,{...w,item:e,rowIndex:i,children:[(0,l.jsx)(m.Td,{width:15,modifier:"breakWord",...N({columnKey:"identifier",isCompoundExpandToggle:!0,item:e,rowIndex:i}),children:(0,l.jsx)(n.OL,{to:`/advisories/${e.uuid}`,children:e.document_id})}),(0,l.jsx)(m.Td,{width:35,modifier:"truncate",...N({columnKey:"title"}),children:e.title}),(0,l.jsx)(m.Td,{width:10,...N({columnKey:"type"}),children:e.labels.type}),(0,l.jsx)(m.Td,{width:20,...N({columnKey:"labels"}),children:(0,l.jsx)(K.C,{value:e.labels,onClick:e=>{let{key:i,value:t}=e,l=(0,T.W)({key:i,value:t}),r=I.labels;if(!r?.includes(l)){let e=r?[...r,l]:[l];O({...I,labels:e})}}})}),(0,l.jsx)(m.Td,{width:10,modifier:"truncate",...N({columnKey:"modified"}),children:(0,g.p6)(e.modified)}),(0,l.jsx)(m.Td,{width:10,...N({columnKey:"vulnerabilities"}),children:(0,l.jsx)(j.u,{severities:t})}),(0,l.jsx)(m.Td,{isActionCell:!0,children:(0,l.jsx)(p.k,{items:[{title:"Edit labels",onClick:()=>{q(e)}},{isSeparator:!0},{title:"Download",onClick:()=>{R(e.uuid,`${e.identifier}.json`)}}]})})]})})},e.identifier)})})]}),(0,l.jsx)(x.p,{idPrefix:"advisory-table",isTop:!1,paginationProps:P}),(0,l.jsxs)(s.u,{isOpen:F,variant:"medium",onClose:$,children:[(0,l.jsx)(a.x,{title:"Edit labels"}),(0,l.jsx)(d.f,{children:S&&(0,l.jsx)(E.q,{advisory:S,onClose:$})})]})]})}},80475:function(e,i,t){t.d(i,{P:()=>c});var l=t(24246),r=t(27378),n=t(70715),s=t(40982),a=t(89226),d=t(14629),o=t(3804),u=t(92934);let c=e=>{let{showFilters:i}=e,{tableControls:t}=r.useContext(u.P),{propHelpers:{toolbarProps:c,filterToolbarProps:y,paginationToolbarItemProps:h,paginationProps:m}}=t;return(0,l.jsx)(l.Fragment,{children:(0,l.jsx)(n.o,{...c,"aria-label":"advisory-toolbar",children:(0,l.jsxs)(s.c,{children:[i&&(0,l.jsx)(d.Ki,{...y}),(0,l.jsx)(a.E,{...h,children:(0,l.jsx)(o.p,{idPrefix:"advisory-table",isTop:!0,paginationProps:m})})]})})})}},15167:function(e,i,t){t.d(i,{q:()=>d});var l=t(24246),r=t(27378),n=t(24502),s=t(15726),a=t(17598);let d=e=>{let{advisory:i,onClose:t}=e,{pushNotification:d}=r.useContext(s.c),[o,u]=r.useState(""),[c,y]=r.useState(""),{labels:h}=(0,a.VY)(c);r.useEffect(()=>{let e=setTimeout(()=>{y(o)},400);return()=>clearTimeout(e)},[o]);let{mutate:m,isPending:p}=(0,a.sj)(()=>{d({title:`Labels updated for Advisory ${i.document_id}`,variant:"success"}),t()},e=>{d({title:`Error while updating labels for Advisory ${i.document_id}`,variant:"danger"})});return(0,l.jsx)(n.M,{title:`Labels of Advisory: ${i.document_id}`,value:i.labels,isDisabled:p,onSave:e=>{m({id:i.uuid,labels:e})},onClose:t,onInputChange:u,options:h})}},17598:function(e,i,t){t.d(i,{N7:()=>m,VY:()=>h,gw:()=>p,sj:()=>f,tG:()=>x});var l=t(1183),r=t(24038),n=t(68e3),s=t(75503),a=t(50576),d=t(40371),o=t(87017),u=t(49988),c=t(95169);let y="advisories",h=e=>{let{data:i,isLoading:t,error:n,refetch:s}=(0,l.a)({queryKey:[y,"labels",e],queryFn:()=>(0,d.sf)({client:a.L,query:{limit:10,filter_text:e}}),placeholderData:r.Wk});return{labels:i?.data||[],isFetching:t,fetchError:n,refetch:s}},m=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],t=arguments.length>2&&void 0!==arguments[2]&&arguments[2],{q:r,...n}=(0,u.rm)(e),s=(0,u.Rb)(i),{data:o,isLoading:c,error:h,refetch:m}=(0,l.a)({queryKey:[y,e,s],queryFn:()=>(0,d.A1)({client:a.L,query:{...n,q:[r,s].filter(e=>e).join("&")}}),enabled:!t});return{result:{data:o?.data?.items||[],total:o?.data?.total??0,params:e??e},isFetching:c,fetchError:h||null,refetch:m}},p=e=>{let{data:i,isLoading:t,error:r}=(0,l.a)({queryKey:[y,e],queryFn:()=>(0,d.pB)({client:a.L,path:{key:e}}),enabled:void 0!==e});return{advisory:i?.data,isFetching:t,fetchError:r}},x=()=>{let e=(0,n.NL)();return(0,c.V)({parallel:!0,uploadFn:(e,i)=>(0,o.Cu)(e,i),onSuccess:async()=>{await e.invalidateQueries({queryKey:[y]})}})},f=(e,i)=>{let t=(0,n.NL)();return(0,s.D)({mutationFn:e=>(0,d.m5)({client:a.L,path:{id:e.id},body:e.labels}),onSuccess:async(i,l)=>{e(),await t.invalidateQueries({queryKey:[y]})},onError:i})}}}]);