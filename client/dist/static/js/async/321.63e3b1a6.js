"use strict";(self.webpackChunk_trustify_ui_client=self.webpackChunk_trustify_ui_client||[]).push([["321"],{97339:function(e,i,t){t.d(i,{a:()=>c});var r=t(59390),l=t(24246),s=t(27378),n=t(90633),a=t(15508),d=t(53315);let c=e=>{var{children:i=null,className:t="","aria-label":o="Breadcrumb",ouiaId:u,ouiaSafe:h=!0}=e,m=(0,r.__rest)(e,["children","className","aria-label","ouiaId","ouiaSafe"]);let x=(0,d.S$)(c.displayName,u,h);return(0,l.jsx)("nav",Object.assign({},m,{"aria-label":o,className:(0,a.i)(n.Z.breadcrumb,t)},x,{children:(0,l.jsx)("ol",{className:n.Z.breadcrumbList,role:"list",children:s.Children.map(i,(e,i)=>(0,s.isValidElement)(e)?(0,s.cloneElement)(e,{showDivider:i>0}):e)})}))};c.displayName="Breadcrumb"},18091:function(e,i,t){t.d(i,{g:()=>d});var r=t(59390),l=t(24246),s=t(91985),n=t(90633),a=t(15508);let d=e=>{var{children:i=null,className:t="",to:d,isActive:c=!1,isDropdown:o=!1,showDivider:u,target:h,component:m="a",render:x}=e,p=(0,r.__rest)(e,["children","className","to","isActive","isDropdown","showDivider","target","component","render"]);let j=c?"page":void 0,b=(0,a.i)(n.Z.breadcrumbLink,c&&n.Z.modifiers.current);return(0,l.jsxs)("li",Object.assign({},p,{className:(0,a.i)(n.Z.breadcrumbItem,t),children:[u&&(0,l.jsx)("span",{className:n.Z.breadcrumbItemDivider,children:(0,l.jsx)(s.ZP,{})}),"button"===m&&(0,l.jsx)("button",{className:b,"aria-current":j,type:"button",children:i}),o&&(0,l.jsx)("span",{className:(0,a.i)(n.Z.breadcrumbDropdown),children:i}),x&&x({className:b,ariaCurrent:j}),d&&!x&&(0,l.jsx)(m,{href:d,target:h,className:b,"aria-current":j,children:i}),!d&&"button"!==m&&!o&&i]}))};d.displayName="BreadcrumbItem"},81211:function(e,i,t){t.d(i,{aV:()=>h});var r,l,s,n,a,d=t(59390),c=t(24246),o=t(40269),u=t(15508);(r=s||(s={})).number="1",r.lowercaseLetter="a",r.uppercaseLetter="A",r.lowercaseRomanNumber="i",r.uppercaseRomanNumber="I",(n||(n={})).inline="inline",(l=a||(a={})).ol="ol",l.ul="ul";let h=e=>{var{className:i="",children:t=null,variant:r=null,isBordered:l=!1,isPlain:n=!1,iconSize:h="default",type:m=s.number,ref:x=null,component:p=a.ul}=e,j=(0,d.__rest)(e,["className","children","variant","isBordered","isPlain","iconSize","type","ref","component"]);return p===a.ol?(0,c.jsx)("ol",Object.assign({ref:x,type:m},n&&{role:"list"},j,{className:(0,u.i)(o.Z.list,r&&o.Z.modifiers[r],l&&o.Z.modifiers.bordered,n&&o.Z.modifiers.plain,h&&"large"===h&&o.Z.modifiers.iconLg,i),children:t})):(0,c.jsx)("ul",Object.assign({ref:x},n&&{role:"list"},j,{className:(0,u.i)(o.Z.list,r&&o.Z.modifiers[r],l&&o.Z.modifiers.bordered,n&&o.Z.modifiers.plain,h&&"large"===h&&o.Z.modifiers.iconLg,i),children:t}))};h.displayName="List"},45882:function(e,i,t){t.d(i,{H:()=>a});var r=t(59390),l=t(24246),s=t(40269),n=t(15508);let a=e=>{var{icon:i=null,children:t=null}=e,a=(0,r.__rest)(e,["icon","children"]);return(0,l.jsxs)("li",Object.assign({className:(0,n.i)(i&&s.Z.listItem)},a,{children:[i&&(0,l.jsx)("span",{className:(0,n.i)(s.Z.listItemIcon),children:i}),(0,l.jsx)("span",{className:i&&(0,n.i)(`${s.Z.list}__item-text`),children:t})]}))};a.displayName="ListItem"},11797:function(e,i,t){t.d(i,{O:()=>c});var r=t(59390),l=t(24246);let s={modifiers:{circle:"pf-m-circle",square:"pf-m-square",widthSm:"pf-m-width-sm",widthMd:"pf-m-width-md",widthLg:"pf-m-width-lg",width_25:"pf-m-width-25",width_33:"pf-m-width-33",width_50:"pf-m-width-50",width_66:"pf-m-width-66",width_75:"pf-m-width-75",heightSm:"pf-m-height-sm",heightMd:"pf-m-height-md",heightLg:"pf-m-height-lg",height_25:"pf-m-height-25",height_33:"pf-m-height-33",height_50:"pf-m-height-50",height_66:"pf-m-height-66",height_75:"pf-m-height-75",height_100:"pf-m-height-100",text_4xl:"pf-m-text-4xl",text_3xl:"pf-m-text-3xl",text_2xl:"pf-m-text-2xl",textXl:"pf-m-text-xl",textLg:"pf-m-text-lg",textMd:"pf-m-text-md",textSm:"pf-m-text-sm"},skeleton:"pf-v6-c-skeleton"};var n=t(15508);let a={name:"--pf-v6-c-skeleton--Height"},d={name:"--pf-v6-c-skeleton--Width"},c=e=>{var{className:i,width:t,height:c,fontSize:o,shape:u,screenreaderText:h}=e,m=(0,r.__rest)(e,["className","width","height","fontSize","shape","screenreaderText"]);let x=o?Object.values(s.modifiers).find(e=>e===`pf-m-text-${o}`):void 0;return(0,l.jsx)("div",Object.assign({},m,{className:(0,n.i)(s.skeleton,o&&x,"circle"===u&&s.modifiers.circle,"square"===u&&s.modifiers.square,i)},(t||c)&&{style:Object.assign({[d.name]:t||void 0,[a.name]:c||void 0},m.style)},{children:(0,l.jsx)("span",{className:"pf-v6-screen-reader",children:h})}))};c.displayName="Skeleton"},26235:function(e,i,t){t.d(i,{ZP:()=>r});let r=(0,t(24329).I)({name:"PenIcon",height:512,width:512,svgPath:"M290.74 93.24l128.02 128.02-277.99 277.99-114.14 12.6C11.35 513.54-1.56 500.62.14 485.34l12.7-114.22 277.9-277.88zm207.2-19.06l-60.11-60.11c-18.75-18.75-49.16-18.75-67.91 0l-56.55 56.55 128.02 128.02 56.55-56.55c18.75-18.76 18.75-49.16 0-67.91z",yOffset:0,xOffset:0})},67447:function(e,i,t){t.d(i,{G:()=>a});var r=t(59390),l=t(24246),s=t(15508),n=t(39157);let a=e=>{var{children:i=null}=e,t=(0,r.__rest)(e,["children"]);return(0,l.jsx)("div",Object.assign({},t,{className:(0,s.i)(n.Z.tableExpandableRowContent),children:i}))};a.displayName="ExpandableRowContent"},37818:function(e,i,t){t.d(i,{u:()=>a});var r=t(24246),l=t(8305),s=t(13754),n=t(39826);let a=e=>e.isFetching?e.isFetchingState||(0,r.jsx)(l.b,{children:(0,r.jsx)(s.$,{})}):e.fetchError?e.fetchErrorState?e.fetchErrorState(e.fetchError):(0,r.jsx)(n.y,{}):e.children},69876:function(e,i,t){t.d(i,{D:()=>s});var r=t(24246),l=t(70400);let s=e=>{let{value:i}=e;return(0,r.jsx)(r.Fragment,{children:Object.entries(i).map(e=>{let[i,t]=e;return(0,r.jsx)(l._,{isCompact:!0,children:`${i}=${t}`},`${i}=${t}`)})})}},68057:function(e,i,t){t.d(i,{V:()=>a});var r=t(24246),l=t(27378),s=t(63763),n=t(32947);let a=e=>{let{vulnerabilitiesSummary:i}=e,t=l.useMemo(()=>Object.keys(i.severities).map(e=>{let t=i.severities[e],r=n.V4[e];return{severity:e,count:t,label:r.name,color:r.color.value}}).sort((0,n.A0)(e=>e.severity)).reverse(),[i]);return(0,r.jsx)("div",{style:{height:"230px",maxWidth:"350px"},children:(0,r.jsx)(s.H,{constrainToVisibleArea:!0,legendOrientation:"vertical",legendPosition:"right",padding:{bottom:20,left:20,right:140,top:20},title:`${i.total}`,subTitle:"Total vulnerabilities",width:350,legendData:t.map(e=>{let{label:i,count:t}=e;return{name:`${i}: ${t}`}}),data:t.map(e=>{let{label:i,count:t}=e;return{x:i,y:t}}),labels:e=>{let{datum:i}=e;return`${i.x}: ${i.y}`},colorScale:t.map(e=>{let{color:i}=e;return i})})})}},42573:function(e,i,t){t.d(i,{C:()=>s});var r=t(24246),l=t(70400);let s=e=>{let{error:i}=e;return(0,r.jsxs)(l._,{color:"red",children:[i.status," Error"]})}},3586:function(e,i,t){t.d(i,{j:()=>s});var r=t(24246),l=t(27378);let s=e=>{let{children:i}=e,[t,s]=l.useState(!1);return(0,r.jsx)(r.Fragment,{children:i(t,s)})}},24200:function(e,i,t){t.d(i,{G:()=>l});var r=t(24246);let l=e=>{let{vulnerability:i}=e;return(0,r.jsxs)("p",{children:[i.withdrawn&&(0,r.jsx)("em",{children:"Rejected:\xa0"}),i.title||i.description]})}},49304:function(e,i,t){t.d(i,{u:()=>o});var r=t(24246),l=t(34747),s=t(46770),n=t(25138),a=t(87445),d=t(32947),c=t(57524);let o=e=>{let{severities:i}=e,t=Object.values(i).reduce((e,i)=>e+i,0);return(0,r.jsxs)(l.k,{spaceItems:{default:"spaceItemsSm"},alignItems:{default:"alignItemsCenter"},flexWrap:{default:"nowrap"},style:{whiteSpace:"nowrap"},children:[(0,r.jsx)(s.B,{"aria-label":"total",style:{minWidth:15,textAlign:a.F2},children:t}),(0,r.jsx)(n.i,{orientation:{default:"vertical"}}),(0,r.jsx)(s.B,{children:(0,r.jsx)(l.k,{children:Object.entries(i).filter(e=>{let[i,t]=e;return t>0}).sort((0,d.A0)(e=>{let[i,t]=e;return i})).reverse().map(e=>{let[i,t]=e;return(0,r.jsx)(s.B,{spacer:{default:"spacerXs"},children:(0,r.jsxs)(l.k,{"aria-label":i,spaceItems:{default:"spaceItemsXs"},alignItems:{default:"alignItemsCenter"},flexWrap:{default:"nowrap"},style:{whiteSpace:"nowrap"},children:[(0,r.jsx)(s.B,{children:(0,r.jsx)(c.o,{value:i,score:null})}),(0,r.jsx)(s.B,{children:t})]})},i)})})})]})}},31373:function(e,i,t){t.d(i,{H:()=>c});var r=t(27378),l=t(7615),s=t(59015);let n=(e,i)=>e.vulnerability.identifier===i.vulnerability.identifier&&e.vulnerabilityStatus===i.vulnerabilityStatus,a={total:0,severities:{unknown:0,none:0,low:0,medium:0,high:0,critical:0}},d={vulnerabilityStatus:{affected:{...a},fixed:{...a},not_affected:{...a},known_not_affected:{...a}}},c=e=>{let{pkg:i,isFetching:t,fetchError:a}=(0,s.ZA)(e);return{data:r.useMemo(()=>(e=>{let i=e.flatMap(e=>(e.status??[]).map(i=>{let t=(0,l.g)(i.average_severity);return{vulnerability:{...i.vulnerability,average_severity:t,average_score:i.average_score},vulnerabilityStatus:i.status,advisory:e}})).reduce((e,i)=>{let t,r=e.find(e=>n(e,i));if(r)t=[...e.filter(e=>!n(e,r)),{...r,relatedSboms:[...r.relatedSboms,{advisory:i.advisory}]}];else{let r={vulnerability:i.vulnerability,vulnerabilityStatus:i.vulnerabilityStatus,relatedSboms:[{advisory:i.advisory}]};t=[...e.slice(),r]}return t},[]),t=i.reduce((e,i)=>{let t=i.vulnerabilityStatus,r=i.vulnerability.average_severity,l=e.vulnerabilityStatus[t];return Object.assign(e,{vulnerabilityStatus:{...e.vulnerabilityStatus,[t]:{total:l.total+1,severities:{...l.severities,[r]:l.severities[r]+1}}}})},{...d});return{vulnerabilities:i,summary:t}})(i?.advisories||[]),[i]),isFetching:t,fetchError:a}}},82413:function(e,i,t){t.d(i,{A:()=>o,I:()=>u});var r=t(27378),l=t(7615),s=t(43959);let n=(e,i)=>e.vulnerability.identifier===i.vulnerability.identifier&&e.vulnerabilityStatus===i.vulnerabilityStatus,a={total:0,severities:{unknown:0,none:0,low:0,medium:0,high:0,critical:0}},d={vulnerabilityStatus:{affected:{...a},fixed:{...a},not_affected:{...a},known_not_affected:{...a}}},c=e=>{let i=e.flatMap(e=>(e.status??[]).map(i=>({vulnerability:i,vulnerabilityStatus:i.status,advisory:e,packages:i.packages}))).reduce((e,i)=>{let t,r=e.find(e=>n(e,i));if(r)t=[...e.filter(e=>!n(e,r)),{...r,relatedPackages:[...r.relatedPackages,{advisory:i.advisory,packages:i.packages}]}];else{let r={vulnerability:i.vulnerability,vulnerabilityStatus:i.vulnerabilityStatus,relatedPackages:[{advisory:i.advisory,packages:i.packages}]};t=[...e.slice(),r]}return t},[]),t=i.reduce((e,i)=>{let t=i.vulnerabilityStatus,r=(0,l.g)(i.vulnerability.average_severity),s=e.vulnerabilityStatus[t];return Object.assign(e,{vulnerabilityStatus:{...e.vulnerabilityStatus,[t]:{total:s.total+1,severities:{...s.severities,[r]:s.severities[r]+1}}}})},{...d});return{vulnerabilities:i,summary:t}},o=e=>{let{advisories:i,isFetching:t,fetchError:l}=(0,s.KQ)(e);return{data:r.useMemo(()=>c(i||[]),[i]),isFetching:t,fetchError:l}},u=e=>{let{advisories:i,isFetching:t,fetchError:l}=(0,s.uz)(e);return{data:r.useMemo(()=>(i??[]).map(e=>c(e||[])),[i]),isFetching:t,fetchError:l}}},96308:function(e,i,t){t.d(i,{n:()=>c});var r=t(24246),l=t(11797),s=t(37818),n=t(42573),a=t(49304),d=t(31373);let c=e=>{let{packageId:i}=e,{data:t,isFetching:c,fetchError:o}=(0,d.H)(i);return(0,r.jsx)(s.u,{isFetching:c,fetchError:o,isFetchingState:(0,r.jsx)(l.O,{screenreaderText:"Loading contents"}),fetchErrorState:e=>(0,r.jsx)(n.C,{error:e}),children:(0,r.jsx)(a.u,{severities:t.summary.vulnerabilityStatus.affected.severities})})}},41362:function(e,i,t){t.r(i),t.d(i,{default:()=>eK});var r=t(24246),l=t(27378),s=t(65783),n=t(45043),a=t(97339),d=t(18091),c=t(11192),o=t(32591),u=t(34747),h=t(46770),m=t(68802),x=t(70400),p=t(32939),j=t(24620),b=t(37961),f=t(69265),g=t(4075),v=t(27090),y=t(75165),S=t(31762),_=t(99),T=t(24787),k=t(12621),E=t(9839),w=t(37818),P=t(73227),F=t(43959),M=t(65872),N=t(87727),K=t(3498),O=t(31757),C=t(87069),B=t(51527),L=t(30329),I=t(50689),Z=t(67761),q=t(81391),D=t(17528),$=t(81211),V=t(45882),R=t(79551),A=t(32489),H=t(90519),z=t(26235),W=t(73827),G=t(63706),U=t(66043);let Q=e=>{let{sbom:i}=e,[t,s]=l.useState(!1),n=()=>{s(!1)};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(N.r,{hasGutter:!0,children:[(0,r.jsx)(K.P,{md:4,children:(0,r.jsxs)(O.Z,{isFullHeight:!0,children:[(0,r.jsx)(C.l,{children:"Metadata"}),(0,r.jsx)(B.e,{children:(0,r.jsxs)(L.o,{children:[(0,r.jsxs)(I.g,{children:[(0,r.jsx)(Z.M,{children:"Name"}),(0,r.jsx)(q.b,{"aria-label":"SBOM's name",children:i.name})]}),(0,r.jsxs)(I.g,{children:[(0,r.jsx)(Z.M,{children:"Namespace"}),(0,r.jsx)(q.b,{"aria-label":"SBOM's namespace",children:i.document_id})]}),(0,r.jsxs)(I.g,{children:[(0,r.jsx)(Z.M,{children:"Data License"}),(0,r.jsx)(q.b,{"aria-label":"SBOM's license",children:i.data_licenses.join(", ")})]})]})})]})}),(0,r.jsx)(K.P,{md:4,children:(0,r.jsxs)(O.Z,{isFullHeight:!0,children:[(0,r.jsx)(C.l,{children:"Creation"}),(0,r.jsx)(B.e,{children:(0,r.jsxs)(L.o,{children:[(0,r.jsxs)(I.g,{children:[(0,r.jsx)(Z.M,{children:"Created"}),(0,r.jsx)(q.b,{"aria-label":"SBOM's creation date",children:(0,G.p6)(i.published)})]}),(0,r.jsxs)(I.g,{children:[(0,r.jsx)(Z.M,{children:"Creator"}),(0,r.jsx)(q.b,{"aria-label":"SBOM's creator",children:i.suppliers})]})]})})]})}),(0,r.jsx)(K.P,{md:4,children:(0,r.jsxs)(O.Z,{isFullHeight:!0,children:[(0,r.jsx)(C.l,{children:"Statistics"}),(0,r.jsx)(B.e,{children:(0,r.jsxs)(L.o,{children:[(0,r.jsxs)(I.g,{children:[(0,r.jsx)(Z.M,{children:"Size"}),(0,r.jsx)(q.b,{children:(0,M.Z)(i.size)})]}),(0,r.jsxs)(I.g,{children:[(0,r.jsx)(Z.M,{children:"Packages"}),(0,r.jsx)(q.b,{children:i.number_of_packages})]}),(0,r.jsxs)(I.g,{children:[(0,r.jsxs)(Z.M,{children:["Labels ","",(0,r.jsx)(D.zx,{variant:D.Wu.link,size:"sm",icon:(0,r.jsx)(z.ZP,{}),iconPosition:"end",onClick:()=>s(!0),children:"Edit"})]}),(0,r.jsx)(q.b,{children:(0,r.jsx)(O.Z,{isCompact:!0,children:(0,r.jsx)(B.e,{children:i.labels&&(0,r.jsx)(W.C,{defaultIsOpen:!0,value:i.labels})})})})]})]})})]})}),(0,r.jsx)(K.P,{md:12,children:(0,r.jsxs)(O.Z,{isFullHeight:!0,children:[(0,r.jsx)(C.l,{children:"Package"}),(0,r.jsx)(B.e,{children:(0,r.jsxs)(L.o,{children:[(0,r.jsxs)(I.g,{children:[(0,r.jsx)(Z.M,{children:"Name"}),(0,r.jsx)(q.b,{children:i.name})]}),(0,r.jsxs)(I.g,{children:[(0,r.jsx)(Z.M,{children:"Version"}),(0,r.jsx)(q.b,{children:i.described_by.map(e=>e.version).join(", ")})]}),(0,r.jsxs)(I.g,{children:[(0,r.jsx)(Z.M,{children:"External References"}),(0,r.jsx)(q.b,{children:(0,r.jsxs)($.aV,{children:[i.described_by.flatMap(e=>e.cpe).map(e=>(0,r.jsx)(V.H,{children:e},e)),i.described_by.flatMap(e=>e.purl).map(e=>(0,r.jsx)(V.H,{children:e.purl},e.uuid))]})})]})]})})]})})]}),(0,r.jsxs)(R.u,{isOpen:t,variant:"medium",onClose:n,children:[(0,r.jsx)(A.x,{title:"Edit labels"}),(0,r.jsx)(H.f,{children:(0,r.jsx)(U._,{sbom:i,onClose:n})})]})]})};var X=t(70715),J=t(40982),Y=t(89226),ee=t(62997),ei=t(4835),et=t(14350),er=t(11165),el=t(89330),es=t(31423),en=t(94154),ea=t(67447),ed=t(74502),ec=t(14629),eo=t(3804),eu=t(31336),eh=t(49988),em=t(59015),ex=t(96308);let ep=(e,i)=>i.reduce((e,i)=>{let{license_id:t,license_name:r}=i;return e.replaceAll(t,r)},`${e}`),ej=e=>{let{sbomId:i}=e,{licenseIds:t}=(0,F.qi)(i),l=(0,eh.vZ)({tableName:"package-table",columnNames:{name:"Name",version:"Version",vulnerabilities:"Vulnerabilities",licenses:"Licenses",purls:"PURLs",cpes:"CPEs"},isSortEnabled:!0,sortableColumns:["name"],isPaginationEnabled:!0,isFilterEnabled:!0,filterCategories:[{categoryKey:ed.L4,title:"Filter text",placeholderText:"Search",type:ec.vA.search},{categoryKey:"license",title:"License",placeholderText:"Filter results by license",type:ec.vA.multiselect,operator:"~",logicOperator:"OR",selectOptions:t.map(e=>({value:e.license_id,label:e.license_name}))}],isExpansionEnabled:!0,expandableVariant:"compound"}),{result:{data:n,total:a},isFetching:d,fetchError:c}=(0,em.D4)(i,(0,eh.QO)({...l,hubSortFieldKeys:{name:"name"}})),o=(0,eh.KC)({...l,idProperty:"id",currentPageItems:n,totalItemCount:a,isLoading:d}),{currentPageItems:u,numRenderedColumns:h,propHelpers:{toolbarProps:m,filterToolbarProps:p,paginationToolbarItemProps:j,paginationProps:b,tableProps:f,getThProps:g,getTrProps:v,getTdProps:y,getExpandedContentTdProps:S},expansionDerivedState:{isCellExpanded:_}}=o;return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(X.o,{...m,"aria-label":"Package toolbar",children:(0,r.jsxs)(J.c,{children:[(0,r.jsx)(ec.Ki,{...p}),(0,r.jsx)(Y.E,{...j,children:(0,r.jsx)(eo.p,{idPrefix:"package-table",isTop:!0,paginationProps:b})})]})}),(0,r.jsxs)(ei.i,{...f,"aria-label":"Package table",children:[(0,r.jsx)(et.h,{children:(0,r.jsx)(er.Tr,{children:(0,r.jsxs)(eu.qK,{...o,children:[(0,r.jsx)(el.Th,{...g({columnKey:"name"})}),(0,r.jsx)(el.Th,{...g({columnKey:"version"})}),(0,r.jsx)(el.Th,{...g({columnKey:"vulnerabilities"})}),(0,r.jsx)(el.Th,{...g({columnKey:"licenses"})}),(0,r.jsx)(el.Th,{...g({columnKey:"purls"})}),(0,r.jsx)(el.Th,{...g({columnKey:"cpes"})})]})})}),(0,r.jsx)(eu.hp,{isLoading:d,isError:!!c,isNoData:0===a,numRenderedColumns:h,children:u?.map((e,i)=>(0,r.jsxs)(es.p,{isExpanded:_(e),children:[(0,r.jsx)(er.Tr,{...v({item:e}),children:(0,r.jsxs)(eu.Cx,{...o,item:e,rowIndex:i,children:[(0,r.jsx)(en.Td,{width:15,...y({columnKey:"name"}),children:[e.name,e.group].filter(Boolean).join("/")}),(0,r.jsx)(en.Td,{width:15,modifier:"truncate",...y({columnKey:"version"}),children:e?.version}),(0,r.jsx)(en.Td,{width:10,modifier:"breakWord",...y({columnKey:"vulnerabilities"}),children:e.purl[0]&&(0,r.jsx)(ex.n,{packageId:e.purl[0].uuid})}),(0,r.jsx)(en.Td,{width:20,modifier:"breakWord",...y({columnKey:"licenses",isCompoundExpandToggle:e.licenses.length>1,item:e,rowIndex:i}),children:1===e.licenses.length?ep(e.licenses[0].license_name,e.licenses_ref_mapping):`${e.licenses.length} Licenses`}),(0,r.jsx)(en.Td,{width:20,modifier:"breakWord",...y({columnKey:"purls",isCompoundExpandToggle:e.purl.length>1,item:e,rowIndex:i}),children:1===e.purl.length?(0,r.jsx)(s.rU,{to:`/packages/${e.purl[0].uuid}`,children:e.purl[0].purl}):`${e.purl.length} PURLs`}),(0,r.jsxs)(en.Td,{width:20,modifier:"breakWord",...y({columnKey:"cpes",isCompoundExpandToggle:e.cpe.length>0,item:e,rowIndex:i}),children:[e.cpe.length," CPEs"]})]})}),_(e)?(0,r.jsx)(er.Tr,{isExpanded:!0,children:(0,r.jsx)(en.Td,{...S({item:e}),className:ee.Z.pLg,children:(0,r.jsx)(ea.G,{children:(0,r.jsxs)("div",{className:ee.Z.ptLg,children:[_(e,"licenses")?(0,r.jsx)($.aV,{isPlain:!0,children:e.licenses.map(i=>(0,r.jsxs)(V.H,{children:[ep(i.license_name,e.licenses_ref_mapping)," ",(0,r.jsx)(x._,{isCompact:!0,children:i.license_type})]},`${i.license_name}-${i.license_type}`))}):null,_(e,"purls")?(0,r.jsx)($.aV,{isPlain:!0,children:e.purl.map(e=>(0,r.jsx)(V.H,{children:(0,r.jsx)(s.rU,{to:`/packages/${e.uuid}`,children:e.purl})},e.uuid))}):null,_(e,"cpes")?(0,r.jsx)($.aV,{isPlain:!0,children:e.cpe.map(e=>(0,r.jsx)(V.H,{children:e},e))}):null]})})})}):null]},e.id))})]}),(0,r.jsx)(eo.p,{idPrefix:"package-table",isTop:!1,paginationProps:b})]})};var eb=t(27693),ef=t.n(eb),eg=t(27317),ev=t(93095),ey=t(9905),eS=t(32947),e_=t(7615),eT=t(69876),ek=t(68057),eE=t(57524),ew=t(3586),eP=t(24200),eF=t(82413),eM=t(41135);let eN=e=>{let{sbomId:i}=e,{sbom:t,isFetching:n,fetchError:a}=(0,F.p4)(i),{data:{vulnerabilities:d,summary:c},isFetching:o,fetchError:u}=(0,eF.A)(i),h=l.useMemo(()=>d.filter(e=>"affected"===e.vulnerabilityStatus),[d]),m=l.useMemo(()=>h.map(e=>{let i=e.relatedPackages.flatMap(e=>e.packages).reduce((e,i)=>(e.find(e=>e.id===i.id)||e.push(i),e),[]);return{...e,summary:{totalPackages:i.length,allPackages:i}}}),[h]),x=(0,eM.T)(m,e=>`${e.vulnerability.identifier}-${e.vulnerabilityStatus}`),p=(0,eh.sz)({tableName:"vulnerability-table",idProperty:"_ui_unique_id",items:x,isLoading:o,columnNames:{id:"Id",description:"Description",cvss:"CVSS",affectedDependencies:"Affected dependencies",published:"Published",updated:"Updated"},hasActionsColumn:!1,isSortEnabled:!0,sortableColumns:["id","cvss","affectedDependencies","published","updated"],getSortValues:e=>({id:e.vulnerability.identifier,cvss:(0,eS.XE)(e.vulnerability.average_severity),affectedDependencies:e.summary.totalPackages,published:e.vulnerability?.published?ef()(e.vulnerability.published).valueOf():0,updated:e.vulnerability?.modified?ef()(e.vulnerability.modified).valueOf():0}),isPaginationEnabled:!0,isFilterEnabled:!1,isExpansionEnabled:!0,expandableVariant:"compound"}),{currentPageItems:j,numRenderedColumns:b,propHelpers:{toolbarProps:f,paginationToolbarItemProps:g,paginationProps:v,tableProps:y,getThProps:S,getTrProps:_,getTdProps:T,getExpandedContentTdProps:k},expansionDerivedState:{isCellExpanded:E}}=p;return(0,r.jsxs)(eg.K,{hasGutter:!0,children:[(0,r.jsx)(ev.v,{children:(0,r.jsx)(O.Z,{children:(0,r.jsx)(B.e,{children:(0,r.jsx)(w.u,{isFetching:n||o,fetchError:a,children:(0,r.jsxs)(N.r,{hasGutter:!0,children:[(0,r.jsx)(K.P,{md:6,children:(0,r.jsx)(ek.V,{vulnerabilitiesSummary:c.vulnerabilityStatus.affected})}),(0,r.jsx)(K.P,{md:6,children:(0,r.jsxs)(L.o,{children:[(0,r.jsxs)(I.g,{children:[(0,r.jsx)(Z.M,{children:"Name"}),(0,r.jsx)(q.b,{children:t?.name})]}),(0,r.jsxs)(I.g,{children:[(0,r.jsx)(Z.M,{children:"Version"}),(0,r.jsx)(q.b,{children:t?.described_by.map(e=>e.version).join(", ")})]}),(0,r.jsxs)(I.g,{children:[(0,r.jsx)(Z.M,{children:"Creation date"}),(0,r.jsx)(q.b,{children:(0,G.p6)(t?.published)})]})]})})]})})})})}),(0,r.jsxs)(ev.v,{children:[(0,r.jsx)(X.o,{...f,children:(0,r.jsx)(J.c,{children:(0,r.jsx)(Y.E,{...g,children:(0,r.jsx)(eo.p,{idPrefix:"vulnerability-table",isTop:!0,paginationProps:v})})})}),(0,r.jsxs)(ei.i,{...y,"aria-label":"Vulnerability table",children:[(0,r.jsx)(et.h,{children:(0,r.jsx)(er.Tr,{children:(0,r.jsxs)(eu.qK,{...p,children:[(0,r.jsx)(el.Th,{...S({columnKey:"id"})}),(0,r.jsx)(el.Th,{...S({columnKey:"description"})}),(0,r.jsx)(el.Th,{...S({columnKey:"cvss"})}),(0,r.jsx)(el.Th,{...S({columnKey:"affectedDependencies"})}),(0,r.jsx)(el.Th,{...S({columnKey:"published"})}),(0,r.jsx)(el.Th,{...S({columnKey:"updated"})})]})})}),(0,r.jsx)(eu.hp,{isLoading:o,isError:!!u,isNoData:0===x.length,numRenderedColumns:b,children:j?.map((e,i)=>(0,r.jsxs)(es.p,{isExpanded:E(e),children:[(0,r.jsx)(er.Tr,{..._({item:e}),children:(0,r.jsxs)(eu.Cx,{...p,item:e,rowIndex:i,children:[(0,r.jsx)(en.Td,{width:15,modifier:"breakWord",...T({columnKey:"id"}),children:(0,r.jsx)(s.rU,{to:`/vulnerabilities/${e.vulnerability.identifier}`,children:e.vulnerability.identifier})}),(0,r.jsx)(ew.j,{children:(i,t)=>(0,r.jsx)(en.Td,{width:35,modifier:"truncate",onFocus:()=>t(!0),onBlur:()=>t(!1),tabIndex:0,...T({columnKey:"description"}),children:(0,r.jsx)(ey.cE,{focused:i,wrapModifier:"truncate",children:e.vulnerability&&(0,r.jsx)(eP.G,{vulnerability:e.vulnerability})})})}),(0,r.jsx)(en.Td,{width:10,...T({columnKey:"cvss"}),children:(0,r.jsx)(eE.o,{value:(0,e_.g)(e.vulnerability.average_severity),score:e.vulnerability.average_score,showLabel:!0,showScore:!0})}),(0,r.jsx)(en.Td,{width:15,modifier:"truncate",...T({columnKey:"affectedDependencies",isCompoundExpandToggle:!0,item:e,rowIndex:i}),children:e.summary.totalPackages}),(0,r.jsx)(en.Td,{width:10,modifier:"truncate",...T({columnKey:"published"}),children:(0,G.p6)(e.vulnerability?.published)}),(0,r.jsx)(en.Td,{width:10,modifier:"truncate",...T({columnKey:"updated"}),children:(0,G.p6)(e.vulnerability?.modified)})]})}),E(e)?(0,r.jsx)(er.Tr,{isExpanded:!0,children:(0,r.jsx)(en.Td,{...k({item:e}),children:(0,r.jsx)(ea.G,{children:E(e,"affectedDependencies")?(0,r.jsxs)(ei.i,{variant:"compact",children:[(0,r.jsx)(et.h,{children:(0,r.jsxs)(er.Tr,{children:[(0,r.jsx)(el.Th,{children:"Type"}),(0,r.jsx)(el.Th,{children:"Namespace"}),(0,r.jsx)(el.Th,{children:"Name"}),(0,r.jsx)(el.Th,{children:"Version"}),(0,r.jsx)(el.Th,{children:"Path"}),(0,r.jsx)(el.Th,{children:"Qualifiers"})]})}),(0,r.jsx)(es.p,{children:e.summary.allPackages.flatMap(e=>e.name&&0===e.purl.length?[{parentName:e.name}]:e.purl.map(i=>({parentName:e.name,purlSummary:i}))).map((e,i)=>{if(e.purlSummary){let i=(0,G.qX)(e.purlSummary.purl);return(0,r.jsxs)(er.Tr,{children:[(0,r.jsx)(en.Td,{children:i?.type}),(0,r.jsx)(en.Td,{children:i?.namespace}),(0,r.jsx)(en.Td,{children:(0,r.jsx)(s.rU,{to:`/packages/${e.purlSummary.uuid}`,children:i?.name})}),(0,r.jsx)(en.Td,{children:i?.version}),(0,r.jsx)(en.Td,{children:i?.path}),(0,r.jsx)(en.Td,{children:i?.qualifiers&&(0,r.jsx)(eT.D,{value:i?.qualifiers})})]},e.purlSummary.uuid)}return(0,r.jsxs)(er.Tr,{children:[(0,r.jsx)(en.Td,{}),(0,r.jsx)(en.Td,{}),(0,r.jsx)(en.Td,{children:e.parentName}),(0,r.jsx)(en.Td,{}),(0,r.jsx)(en.Td,{}),(0,r.jsx)(en.Td,{})]},`${e.parentName}-${i}-name`)})})]}):null})})}):null]},e._ui_unique_id))})]}),(0,r.jsx)(eo.p,{idPrefix:"vulnerability-table",isTop:!1,paginationProps:v})]})]})},eK=()=>{let e=(0,E.ZX)(E.Uo.SBOM_ID),{sbom:i,isFetching:t,fetchError:M}=(0,F.p4)(e),{downloadSBOM:N,downloadSBOMLicenses:K}=(0,P.i)(),[O,C]=l.useState(!1),[B,L]=l.useState(0),I=l.createRef(),Z=l.createRef(),q=l.createRef(),D=l.createRef(),$=()=>{C(!O)};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.NP,{type:"breadcrumb",children:(0,r.jsxs)(a.a,{children:[(0,r.jsx)(d.g,{children:(0,r.jsx)(s.rU,{to:"/sboms",children:"SBOMs"})}),(0,r.jsx)(d.g,{isActive:!0,children:"SBOM details"})]})}),(0,r.jsx)(n.NP,{children:(0,r.jsxs)(c.P,{children:[(0,r.jsx)(o.J,{isFilled:!0,children:(0,r.jsxs)(u.k,{children:[(0,r.jsx)(h.B,{spacer:{default:"spacerSm"},children:(0,r.jsx)(m.V,{children:(0,r.jsx)(m.V,{component:"h1",children:i?.name??e??""})})}),(0,r.jsx)(h.B,{children:i?.labels.type&&(0,r.jsx)(x._,{color:"blue",children:i?.labels.type})})]})}),(0,r.jsx)(o.J,{children:i&&(0,r.jsx)(p.L,{isOpen:O,onSelect:()=>C(!1),onOpenChange:e=>C(e),popperProps:{position:"right"},toggle:e=>(0,r.jsx)(j.O_,{ref:e,onClick:$,isExpanded:O,children:"Actions"}),ouiaId:"BasicDropdown",shouldFocusToggleOnSelect:!0,children:(0,r.jsxs)(b.s,{children:[(0,r.jsx)(f.h,{onClick:()=>{e&&N(e,i?.name?`${i?.name}.json`:`${e}.json`)},children:"Download SBOM"},"sbom"),(0,r.jsx)(f.h,{onClick:()=>{e&&K(e)},children:"Download License Report"},"license")]})})})]})}),(0,r.jsx)(n.NP,{children:(0,r.jsxs)(g.m,{mountOnEnter:!0,activeKey:B,onSelect:(e,i)=>{L(i)},"aria-label":"Tabs that contain the SBOM information",role:"region",children:[(0,r.jsx)(v.O,{eventKey:0,title:(0,r.jsx)(y.T,{children:"Info"}),tabContentId:"refTabInfoSection",tabContentRef:I}),(0,r.jsx)(v.O,{eventKey:1,title:(0,r.jsx)(y.T,{children:"Packages"}),tabContentId:"refTabPackagesSection",tabContentRef:Z}),(0,r.jsx)(v.O,{eventKey:2,title:(0,r.jsx)(y.T,{children:"Vulnerabilities"}),tabContentId:"refVulnerabilitiesSection",tabContentRef:q,actions:(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(S.b,{ref:D,children:(0,r.jsx)(k.ZP,{})}),(0,r.jsx)(_.J,{triggerRef:D,bodyContent:(0,r.jsx)("div",{children:"Any found vulnerabilities related to this SBOM. Fixed vulnerabilities are not listed."})})]})})]})}),(0,r.jsxs)(n.NP,{children:[(0,r.jsx)(T.I,{eventKey:0,id:"refTabInfoSection",ref:I,"aria-label":"Information of the SBOM",children:(0,r.jsx)(w.u,{isFetching:t,fetchError:M,children:i&&(0,r.jsx)(Q,{sbom:i})})}),(0,r.jsx)(T.I,{eventKey:1,id:"refTabPackagesSection",ref:Z,"aria-label":"Packages within the SBOM",hidden:!0,children:e&&(0,r.jsx)(ej,{sbomId:e})}),(0,r.jsx)(T.I,{eventKey:2,id:"refVulnerabilitiesSection",ref:q,"aria-label":"Vulnerabilities within the SBOM",hidden:!0,children:e&&(0,r.jsx)(eN,{sbomId:e})})]})]})}},66043:function(e,i,t){t.d(i,{_:()=>d});var r=t(24246),l=t(27378),s=t(24502),n=t(15726),a=t(43959);let d=e=>{let{sbom:i,onClose:t}=e,{pushNotification:d}=l.useContext(n.c),[c,o]=l.useState(""),[u,h]=l.useState("");l.useEffect(()=>{let e=setTimeout(()=>{h(c)},400);return()=>clearTimeout(e)},[c]);let{labels:m}=(0,a.i5)(u),{mutate:x,isPending:p}=(0,a.t9)(()=>{d({title:`Labels updated for SBOM ${i.name}`,variant:"success"}),t()},e=>{d({title:`Error while updating labels for SBOM ${i.name}`,variant:"danger"})});return(0,r.jsx)(s.M,{title:`Labels of SBOM: ${i.name}`,value:i.labels,isDisabled:p,onSave:e=>{x({id:i.id,labels:e})},onClose:t,onInputChange:o,options:m})}},59015:function(e,i,t){t.d(i,{D4:()=>o,ZA:()=>c,fF:()=>d});var r=t(1183),l=t(50576),s=t(40371),n=t(49988);let a="packages",d=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=arguments.length>1&&void 0!==arguments[1]&&arguments[1],{data:t,isLoading:d,error:c,refetch:o}=(0,r.a)({queryKey:[a,e],queryFn:()=>(0,s.tj)({client:l.L,query:{...(0,n.rm)(e)}}),enabled:!i});return{result:{data:t?.data?.items||[],total:t?.data?.total??0,params:e},isFetching:d,fetchError:c,refetch:o}},c=e=>{let{data:i,isLoading:t,error:n}=(0,r.a)({queryKey:[a,e],queryFn:()=>(0,s.BK)({client:l.L,path:{key:e}})});return{pkg:i?.data,isFetching:t,fetchError:n}},o=function(e){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{data:t,isLoading:d,error:c,refetch:o}=(0,r.a)({queryKey:[a,"by-sbom",e,i],queryFn:()=>(0,s.Pg)({client:l.L,path:{id:e},query:{...(0,n.rm)(i)}})});return{result:{data:t?.data?.items||[],total:t?.data?.total??0,params:i},isFetching:d,fetchError:c,refetch:o}}},43959:function(e,i,t){t.d(i,{Fz:()=>p,KQ:()=>v,Oh:()=>g,i5:()=>x,km:()=>b,p4:()=>j,qi:()=>S,t9:()=>f,uz:()=>y});var r=t(1183),l=t(24038),s=t(68e3),n=t(75503),a=t(16072),d=t(50576),c=t(40371),o=t(95169),u=t(87017),h=t(49988);let m="sboms",x=e=>{let{data:i,isLoading:t,error:s,refetch:n}=(0,r.a)({queryKey:[m,"labels",e],queryFn:()=>(0,c.mh)({client:d.L,query:{limit:10,filter_text:e}}),placeholderData:l.Wk});return{labels:i?.data||[],isFetching:t,fetchError:s,refetch:n}},p=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],t=arguments.length>2&&void 0!==arguments[2]&&arguments[2],{q:l,...s}=(0,h.rm)(e),n=(0,h.Rb)(i),{data:a,isLoading:o,error:u,refetch:x}=(0,r.a)({queryKey:[m,e,n],queryFn:()=>(0,c.Wp)({client:d.L,query:{...s,q:[l,n].filter(e=>e).join("&")}}),enabled:!t});return{result:{data:a?.data?.items||[],total:a?.data?.total??0,params:e??e},isFetching:o,fetchError:u,refetch:x}},j=e=>{let{data:i,isLoading:t,error:l}=(0,r.a)({queryKey:[m,e],queryFn:()=>void 0===e?Promise.resolve(void 0):(0,c._Q)({client:d.L,path:{id:e}}),enabled:void 0!==e});return{sbom:i?.data,isFetching:t,fetchError:l}},b=()=>{let e=(0,s.NL)();return(0,o.V)({parallel:!0,uploadFn:(e,i)=>(0,u.Hb)(e,i),onSuccess:async()=>{await e.invalidateQueries({queryKey:[m]})}})},f=(e,i)=>{let t=(0,s.NL)();return(0,n.D)({mutationFn:e=>(0,c.zx)({client:d.L,path:{id:e.id},body:e.labels}),onSuccess:async()=>{e(),await t.invalidateQueries({queryKey:[m]})},onError:i})},g=function(e){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{data:t,isLoading:l,error:s,refetch:n}=(0,r.a)({queryKey:[m,"by-package",e,i],queryFn:()=>(0,c.DU)({client:d.L,query:{purl:e,...(0,h.rm)(i)}})});return{result:{data:t?.data?.items||[],total:t?.data?.total??0,params:i??i},isFetching:l,fetchError:s,refetch:n}},v=e=>{let{data:i,isLoading:t,error:l}=(0,r.a)({queryKey:[m,e,"advisory"],queryFn:()=>(0,c.NU)({client:d.L,path:{id:e}})});return{advisories:i?.data||[],isFetching:t,fetchError:l}},y=e=>{let i=(0,a.h)({queries:e.map(e=>({queryKey:[m,e,"advisory"],queryFn:()=>(0,c.NU)({client:d.L,path:{id:e}})}))});return{advisories:i.map(e=>{let{data:i}=e;return i?.data||[]}),isFetching:i.some(e=>{let{isLoading:i}=e;return i}),fetchError:i.map(e=>{let{error:i}=e;return i})}},S=e=>{let{data:i,isLoading:t,error:l}=(0,r.a)({queryKey:[m,e,"license-ids"],queryFn:()=>(0,c.J4)({client:d.L,path:{id:e}})});return{licenseIds:i?.data||[],isFetching:t,fetchError:l}}},41135:function(e,i,t){t.d(i,{T:()=>s});var r=t(27378),l=t(74502);let s=(e,i)=>(0,r.useMemo)(()=>e&&0!==e.length?e.map(e=>({...e,[l.nM]:i(e)})):[],[e,i])},40269:function(e,i,t){t.d(i,{Z:()=>r});let r={list:"pf-v6-c-list",listItem:"pf-v6-c-list__item",listItemIcon:"pf-v6-c-list__item-icon",modifiers:{iconLg:"pf-m-icon-lg",plain:"pf-m-plain",inline:"pf-m-inline",bordered:"pf-m-bordered"}}},65872:function(e,i,t){t.d(i,{Z:()=>d});let r=["B","kB","MB","GB","TB","PB","EB","ZB","YB"],l=["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],s=["b","kbit","Mbit","Gbit","Tbit","Pbit","Ebit","Zbit","Ybit"],n=["b","kibit","Mibit","Gibit","Tibit","Pibit","Eibit","Zibit","Yibit"],a=(e,i,t)=>{let r=e;return"string"==typeof i||Array.isArray(i)?r=e.toLocaleString(i,t):(!0===i||void 0!==t)&&(r=e.toLocaleString(void 0,t)),r};function d(e,i){let t;if(!Number.isFinite(e))throw TypeError(`Expected a finite number, got ${typeof e}: ${e}`);let d=(i={bits:!1,binary:!1,space:!0,...i}).bits?i.binary?n:s:i.binary?l:r,c=i.space?" ":"";if(i.signed&&0===e)return` 0${c}${d[0]}`;let o=e<0,u=o?"-":i.signed?"+":"";if(o&&(e=-e),void 0!==i.minimumFractionDigits&&(t={minimumFractionDigits:i.minimumFractionDigits}),void 0!==i.maximumFractionDigits&&(t={maximumFractionDigits:i.maximumFractionDigits,...t}),e<1)return u+a(e,i.locale,t)+c+d[0];let h=Math.min(Math.floor(i.binary?Math.log(e)/Math.log(1024):Math.log10(e)/3),d.length-1);return e/=(i.binary?1024:1e3)**h,t||(e=e.toPrecision(3)),u+a(Number(e),i.locale,t)+c+d[h]}}}]);