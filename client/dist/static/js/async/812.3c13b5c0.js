"use strict";(self.webpackChunk_trustify_ui_client=self.webpackChunk_trustify_ui_client||[]).push([["812"],{3804:function(e,n,t){t.d(n,{p:()=>s});var r=t(79192),a=t(53195),i=t(24246),l=t(27230);let s=e=>{let{paginationProps:n,isTop:t,isCompact:s=!1,idPrefix:o=""}=e;return(0,i.jsx)(l.t,(0,a._)((0,r._)({id:"".concat(o?"".concat(o,"-"):"","pagination-").concat(t?"top":"bottom"),variant:t?l.a.top:l.a.bottom,isCompact:s},n),{widgetId:"pagination-id"}))}},39826:function(e,n,t){t.d(n,{y:()=>s});var r=t(24246),a=t(10707),i=t(16668),l=t(42160);let s=()=>(0,r.jsx)(a.ub,{status:"danger",headingLevel:"h4",titleText:"Unable to connect",icon:l.ZP,variant:a.IQ.sm,children:(0,r.jsx)(i.B,{children:"There was an error retrieving data. Check your connection and try again."})})},31336:function(e,n,t){t.d(n,{hp:()=>p,qK:()=>b,Cx:()=>v});var r=t(24246),a=t(8305),i=t(13754),l=t(31423),s=t(11165),o=t(94154),c=t(39826),d=t(10707),u=t(16668),m=t(22119);let h=e=>{let{title:n,description:t}=e;return(0,r.jsx)(d.ub,{titleText:n,headingLevel:"h4",icon:m.ZP,variant:d.IQ.sm,children:t&&(0,r.jsx)(u.B,{children:t})})},x=()=>(0,r.jsx)(h,{title:"No data available",description:"No data available to be shown here."}),p=e=>{let{numRenderedColumns:n,isLoading:t=!1,isError:d=!1,isNoData:u=!1,errorEmptyState:m=null,noDataEmptyState:h=null,children:p}=e;return(0,r.jsx)(r.Fragment,{children:t?(0,r.jsx)(l.p,{"aria-label":"Table loading",children:(0,r.jsx)(s.Tr,{children:(0,r.jsx)(o.Td,{colSpan:n,children:(0,r.jsx)(a.b,{children:(0,r.jsx)(i.$,{size:"xl"})})})})}):d?(0,r.jsx)(l.p,{"aria-label":"Table error",children:(0,r.jsx)(s.Tr,{children:(0,r.jsx)(o.Td,{colSpan:n,children:(0,r.jsx)(a.b,{children:m||(0,r.jsx)(c.y,{})})})})}):u?(0,r.jsx)(l.p,{"aria-label":"Table empty",children:(0,r.jsx)(s.Tr,{children:(0,r.jsx)(o.Td,{colSpan:n,children:(0,r.jsx)(a.b,{children:h||(0,r.jsx)(x,{})})})})}):p})};var j=t(89330);let b=e=>{let{numColumnsBeforeData:n,numColumnsAfterData:t,children:a}=e;return(0,r.jsxs)(r.Fragment,{children:[Array(n).fill(null).map((e,n)=>(0,r.jsx)(j.Th,{screenReaderText:"before-data-".concat(n)},n)),a,Array(t).fill(null).map((e,n)=>(0,r.jsx)(j.Th,{screenReaderText:"after-data-".concat(n)},n))]})};var g=t(79192);let v=e=>{let{isExpansionEnabled:n=!1,expandableVariant:t,getSelectCheckboxTdProps:a,propHelpers:{getSingleExpandButtonTdProps:i},item:l,rowIndex:s,children:c}=e;return(0,r.jsxs)(r.Fragment,{children:[n&&"single"===t?(0,r.jsx)(o.Td,(0,g._)({},i({item:l,rowIndex:s}))):null,a?(0,r.jsx)(o.Td,(0,g._)({},a({item:l,rowIndex:s}))):null,c]})}},45840:function(e,n,t){t.r(n),t.d(n,{default:()=>ed});var r=t(79192),a=t(53195),i=t(24246),l=t(27378),s=t(27693),o=t.n(s),c=t(78700),d=t(45043),u=t(68802),m=t(70715),h=t(40982),x=t(89226),p=t(70400),j=t(79551),b=t(32489),g=t(90519),v=t(35072),f=t(43490),y=t(62997),_=t(4835),T=t(14350),C=t(11165),D=t(89330),I=t(31423),S=t(94154),w=t(88935),K=t(67447),P=t(48513);let k=e=>{let{isOpen:n,title:t,titleIconVariant:r,message:a,confirmBtnLabel:l,cancelBtnLabel:s,inProgress:o,confirmBtnVariant:d,onClose:u,onConfirm:m,onCancel:h}=e,x=(0,i.jsx)(c.zx,{id:"confirm-dialog-button","aria-label":"confirm",variant:d,isDisabled:o,onClick:m,children:l},"confirm"),p=h?(0,i.jsx)(c.zx,{id:"confirm-cancel-button","aria-label":"cancel",variant:c.Wu.link,isDisabled:o,onClick:h,children:s},"cancel"):void 0;return(0,i.jsxs)(j.u,{id:"confirm-dialog",variant:"small",isOpen:n,onClose:u,"aria-label":"Confirm dialog",children:[(0,i.jsx)(b.x,{title:t,titleIconVariant:r}),(0,i.jsx)(g.f,{children:a}),(0,i.jsx)(v.m,{children:h?(0,i.jsxs)(i.Fragment,{children:[x,p]}):x})]})};var E=t(15726),L=t(1183),N=t(68e3),O=t(75503),F=t(74502),R=t(50576),B=t(40371);let Z="importers",V=function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],{isLoading:n,error:t,refetch:r,data:a}=(0,L.a)({queryKey:[Z],queryFn:()=>(0,B.CZ)({client:R.L}),refetchInterval:!e&&F.x6});return{importers:(null==a?void 0:a.data)||[],isFetching:n,fetchError:t,refetch:r}},A=function(e){var n,t,r;let a=arguments.length>1&&void 0!==arguments[1]&&arguments[1],{data:i,isLoading:l,refetch:s,error:o}=(0,L.a)({queryKey:[Z,e,"reports"],queryFn:()=>(0,B.qi)({client:R.L,path:{name:e}}),refetchInterval:!a&&F.x6});return{result:{data:(null==i||null==(n=i.data)?void 0:n.items)||[],total:null!=(r=null==i||null==(t=i.data)?void 0:t.total)?r:0},isFetching:l,fetchError:o,refetch:s}};var z=t(63706),q=t(14629),W=t(2499),M=t(34747),U=t(46770),H=t(64766),Q=t(30528),Y=t(42160),G=t(1353),J=t(82786),$=t(19879),X=t(18976);let ee=e=>{let{preset:n,status:t,icon:r,className:a="",label:l}=e,s={Canceled:{icon:(0,i.jsx)($.ZP,{}),status:"info",label:"Canceled"},Completed:{icon:(0,i.jsx)(Q.ZP,{}),status:"success",label:"Completed"},Error:{icon:(0,i.jsx)(Y.ZP,{}),status:"danger",label:"Error"},Failed:{icon:(0,i.jsx)(Y.ZP,{}),status:"danger",label:"Failed"},InProgress:{icon:(0,i.jsx)(G.ZP,{}),status:"info",label:"In-progress"},NotStarted:{icon:(0,i.jsx)($.ZP,{}),label:"Not started"},Ok:{icon:(0,i.jsx)(Q.ZP,{}),status:"success"},Scheduled:{icon:(0,i.jsx)(J.ZP,{}),status:"info",label:"Scheduled"},Unknown:{icon:(0,i.jsx)(X.ZP,{})}},o=n&&s[n];return(0,i.jsxs)(M.k,{flexWrap:{default:"nowrap"},spaceItems:{default:"spaceItemsSm"},children:[(0,i.jsx)(U.B,{children:(0,i.jsx)(e=>{let{children:n}=e;return(null==o?void 0:o.tooltipMessage)?(0,i.jsx)(W.u,{content:null==o?void 0:o.tooltipMessage,children:n}):n},{children:(0,i.jsx)(H.J,{status:t||(null==o?void 0:o.status),className:a,children:r||(null==o?void 0:o.icon)||(0,i.jsx)(X.ZP,{})})})}),(0,i.jsx)(U.B,{children:l||(null==o?void 0:o.label)})]})};var en=t(3804),et=t(31336),er=t(49988),ea=t(90241),ei=t(20227);let el=e=>{let{value:n}=e;return(0,i.jsx)(ea.E,{"aria-label":"Progress of Importer ",value:n.current,min:0,max:n.total,measureLocation:ei.nK.inside,size:ea.L.sm})},es=new Map([["waiting","Scheduled"],["running","InProgress"]]),eo=e=>{let{state:n}=e;return(0,i.jsx)(ee,{preset:(e=>{if(es.has(e)){let n=es.get(e);if(n)return n}return"NotStarted"})(n)})},ec=e=>{var n;let t=Object.keys(null!=(n=e.configuration)?n:{})[0],r=e.configuration[t];return(null==r?void 0:r.disabled)!==!1?"disabled":"running"===e.state?"running":"scheduled"},ed=()=>{let e,{pushNotification:n}=l.useContext(E.c),[t,s]=l.useState(null),[o,j]=l.useState(null),b=(e,n)=>{j(e),s(n)},{importers:g,isFetching:v,fetchError:f}=V(),{mutate:P}=((e,n)=>{let t=(0,N.NL)();return(0,O.D)({mutationFn:e=>(0,B.Ro)({client:R.L,path:{name:e.importerName},body:e.configuration}),onSuccess:async(n,r)=>{e(),await t.invalidateQueries({queryKey:[Z]})},onError:n})})(()=>{},e=>{n({title:"Error while enabling/disabling the Importer",variant:"danger"})}),L=(e,n)=>{var t;let i=Object.keys(null!=(t=e.configuration)?t:{})[0],l=e.configuration[i],s=(0,a._)((0,r._)({},l),{disabled:!n});P({importerName:e.name,configuration:{[i]:s}})},F=()=>{n({title:"Importer scheduled to run as soon as possible",variant:"success"})},A=e=>{n({title:(0,z.dr)(e),variant:"danger"})},W=(0,er.sz)({tableName:"importers-table",idProperty:"name",items:g,columnNames:{name:"Name",type:"Type",description:"Description",source:"Source",period:"Period",state:"State"},hasActionsColumn:!0,isSortEnabled:!0,sortableColumns:["name"],getSortValues:e=>({name:e.name}),isPaginationEnabled:!0,isExpansionEnabled:!0,expandableVariant:"single",isFilterEnabled:!0,filterCategories:[{categoryKey:"name",title:"Name",type:q.vA.search,placeholderText:"Search by name...",getItemValue:e=>e.name||""},{categoryKey:"status",title:"Status",type:q.vA.multiselect,logicOperator:"OR",selectOptions:[{value:"scheduled",label:"Scheduled"},{value:"running",label:"Running"},{value:"disabled",label:"Disabled"}],placeholderText:"Status",matcher:(e,n)=>e===ec(n)}]}),{currentPageItems:M,numRenderedColumns:U,propHelpers:{toolbarProps:H,filterToolbarProps:Q,paginationToolbarItemProps:Y,paginationProps:G,tableProps:J,getThProps:$,getTrProps:X,getTdProps:ee},expansionDerivedState:{isCellExpanded:ea}}=W;switch(o){case"enable":e={title:"Enable Importer",titleIconVariant:"info",message:"Are you sure you want to enable the Importer ".concat(null==t?void 0:t.name,"?"),confirmBtnVariant:c.Wu.primary,confirmBtnLabel:"Enable",cancelBtnLabel:"Cancel"};break;case"disable":e={title:"Disable Importer",titleIconVariant:"info",message:"Are you sure you want to disable the Importer ".concat(null==t?void 0:t.name,"?"),confirmBtnVariant:c.Wu.primary,confirmBtnLabel:"Disable",cancelBtnLabel:"Cancel"};break;case"run":e={title:"Run Importer",titleIconVariant:"info",message:"Are you sure you want to run the Importer ".concat(null==t?void 0:t.name,"?"),confirmBtnVariant:c.Wu.primary,confirmBtnLabel:"Run",cancelBtnLabel:"Cancel"};break;default:e=null}return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(d.NP,{hasBodyWrapper:!1,children:(0,i.jsx)(u.V,{children:(0,i.jsx)(u.V,{component:"h1",children:"Importers"})})}),(0,i.jsx)(d.NP,{hasBodyWrapper:!1,children:(0,i.jsxs)("div",{children:[(0,i.jsx)(m.o,(0,a._)((0,r._)({},H),{children:(0,i.jsxs)(h.c,{children:[(0,i.jsx)(q.Ki,(0,r._)({showFiltersSideBySide:!0},Q)),(0,i.jsx)(x.E,(0,a._)((0,r._)({},Y),{children:(0,i.jsx)(en.p,{idPrefix:"importer-table",isTop:!0,paginationProps:G})}))]})})),(0,i.jsxs)(_.i,(0,a._)((0,r._)({},J),{"aria-label":"Importer table",children:[(0,i.jsx)(T.h,{children:(0,i.jsx)(C.Tr,{children:(0,i.jsxs)(et.qK,(0,a._)((0,r._)({},W),{children:[(0,i.jsx)(D.Th,(0,r._)({},$({columnKey:"name"}))),(0,i.jsx)(D.Th,(0,r._)({},$({columnKey:"type"}))),(0,i.jsx)(D.Th,(0,r._)({},$({columnKey:"description"}))),(0,i.jsx)(D.Th,(0,r._)({},$({columnKey:"source"}))),(0,i.jsx)(D.Th,(0,r._)({},$({columnKey:"period"}))),(0,i.jsx)(D.Th,(0,r._)({},$({columnKey:"state"})))]}))})}),(0,i.jsx)(et.hp,{isLoading:v,isError:!!f,isNoData:0===g.length,numRenderedColumns:U,children:null==M?void 0:M.map((e,n)=>{var t;let l=Object.keys(null!=(t=e.configuration)?t:{})[0],s=e.configuration[l],o=ec(e);return(0,i.jsxs)(I.p,{children:[(0,i.jsx)(C.Tr,(0,a._)((0,r._)({},X({item:e})),{children:(0,i.jsxs)(et.Cx,(0,a._)((0,r._)({},W),{item:e,rowIndex:n,children:[(0,i.jsx)(S.Td,(0,a._)((0,r._)({width:15,modifier:"truncate"},ee({columnKey:"name"})),{children:e.name})),(0,i.jsx)(S.Td,(0,a._)((0,r._)({width:10,modifier:"truncate"},ee({columnKey:"type"})),{children:l})),(0,i.jsx)(S.Td,(0,a._)((0,r._)({width:20,modifier:"truncate"},ee({columnKey:"description"})),{children:null==s?void 0:s.description})),(0,i.jsx)(S.Td,(0,a._)((0,r._)({width:20,modifier:"truncate"},ee({columnKey:"source"})),{children:null==s?void 0:s.source})),(0,i.jsx)(S.Td,(0,a._)((0,r._)({width:10,modifier:"truncate"},ee({columnKey:"period"})),{children:null==s?void 0:s.period})),(0,i.jsx)(S.Td,(0,a._)((0,r._)({width:10,modifier:"truncate"},ee({columnKey:"state"})),{children:"disabled"===o?(0,i.jsx)(p._,{color:"orange",children:"Disabled"}):"running"===o&&e.progress?(0,i.jsx)(el,{value:e.progress}):(0,i.jsx)(eo,{state:e.state})})),(0,i.jsx)(S.Td,{isActionCell:!0,children:(0,i.jsx)(w.k,{items:[..."disabled"===o?[{title:"Enable",onClick:()=>{b("enable",e)}}]:[{title:"Run",onClick:()=>{b("run",e)},isDisabled:"running"===o},{title:"Disable",onClick:()=>{b("disable",e)}}]]})})]}))})),ea(e)?(0,i.jsx)(C.Tr,{isExpanded:!0,children:(0,i.jsx)(S.Td,{colSpan:7,children:(0,i.jsx)("div",{className:y.Z.mMd,children:(0,i.jsx)(K.G,{children:(0,i.jsx)(eu,{importer:e})})})})}):null]},e.name)})})]})),(0,i.jsx)(en.p,{idPrefix:"importer-table",isTop:!1,paginationProps:G})]})}),o&&e&&(0,i.jsx)(k,(0,a._)((0,r._)({},e),{isOpen:!0,onCancel:()=>j(null),onClose:()=>j(null),onConfirm:()=>{if(t)switch(o){case"enable":L(t,!0);break;case"disable":L(t,!1);break;case"run":var e;e=t.name,(0,B.Pj)({client:R.L,path:{name:e},body:!0}).then(F).catch(A)}s(null),j(null)}}))]})},eu=e=>{let{importer:n}=e,[t,s]=l.useState([]),[d,u]=l.useState(!1),p=()=>u(!d),{result:{data:y},isFetching:w,fetchError:K}=A(n.name),k=l.useMemo(()=>{var e,t,r;let a={isRunning:!0,id:"root",startDate:void 0,endDate:void 0,duration:(null==(e=n.progress)?void 0:e.estimatedSecondsRemaining)?(null==(t=n.progress)?void 0:t.estimatedSecondsRemaining)*1e3:void 0,numberOfItems:null==(r=n.progress)?void 0:r.current,error:void 0,messages:void 0},i=y.map(e=>{var n,t,r,a,i,l;let s;if((null==(n=e.report)?void 0:n.startDate)&&e.report.endDate){let n=o()(e.report.startDate);s=o()(e.report.endDate).diff(n)}return{isRunning:!1,id:e.id,startDate:null==(t=e.report)?void 0:t.startDate,endDate:null==(r=e.report)?void 0:r.endDate,duration:s,numberOfItems:null==(a=e.report)?void 0:a.numberOfItems,error:null!=(l=e.error)?l:void 0,messages:null==(i=e.report)?void 0:i.messages}});return[..."running"===n.state?[a]:[],...i]},[n,y]),E=(0,er.sz)({variant:"compact",tableName:"report-table",idProperty:"id",items:k,columnNames:{startDate:"Start date",endDate:"End date",numberOfItems:"Number of items",status:"Status",duration:"Duration"},isPaginationEnabled:!0,initialItemsPerPage:5,isSortEnabled:!0,sortableColumns:["startDate","endDate"],initialSort:{columnKey:"startDate",direction:"desc"},getSortValues:e=>({startDate:!e.startDate||o()(e.startDate).valueOf(),endDate:!e.endDate||o()(e.endDate).valueOf()}),isFilterEnabled:!1,isExpansionEnabled:!1}),{currentPageItems:L,numRenderedColumns:N,propHelpers:{toolbarProps:O,tableProps:R,paginationToolbarItemProps:B,paginationProps:Z,getThProps:V,getTrProps:q,getTdProps:W}}=E;return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(m.o,(0,a._)((0,r._)({},O),{children:(0,i.jsx)(h.c,{children:(0,i.jsx)(x.E,(0,a._)((0,r._)({},B),{children:(0,i.jsx)(en.p,{idPrefix:"report-table",isTop:!0,paginationProps:Z})}))})})),(0,i.jsxs)(_.i,(0,a._)((0,r._)({},R),{"aria-label":"Report table",children:[(0,i.jsx)(P.Y,{children:"Importer reports"}),(0,i.jsx)(T.h,{children:(0,i.jsx)(C.Tr,{children:(0,i.jsxs)(et.qK,(0,a._)((0,r._)({},E),{children:[(0,i.jsx)(D.Th,(0,r._)({},V({columnKey:"startDate"}))),(0,i.jsx)(D.Th,(0,r._)({},V({columnKey:"endDate"}))),(0,i.jsx)(D.Th,(0,r._)({},V({columnKey:"numberOfItems"}))),(0,i.jsx)(D.Th,(0,r._)({},V({columnKey:"status"}))),(0,i.jsx)(D.Th,(0,r._)({},V({columnKey:"duration"})))]}))})}),(0,i.jsx)(et.hp,{isLoading:w,isError:!!K,isNoData:(null==k?void 0:k.length)===0,numRenderedColumns:N,children:null==L?void 0:L.map((e,n)=>(0,i.jsx)(I.p,{children:(0,i.jsx)(C.Tr,(0,a._)((0,r._)({},q({item:e})),{children:(0,i.jsxs)(et.Cx,(0,a._)((0,r._)({},E),{item:e,rowIndex:n,children:[(0,i.jsx)(S.Td,(0,a._)((0,r._)({width:15,modifier:"truncate"},W({columnKey:"startDate"})),{children:(0,z.o0)(e.startDate)})),(0,i.jsx)(S.Td,(0,a._)((0,r._)({width:15,modifier:"truncate"},W({columnKey:"endDate"})),{children:(0,z.o0)(e.endDate)})),(0,i.jsx)(S.Td,(0,a._)((0,r._)({width:15,modifier:"truncate"},W({columnKey:"numberOfItems"})),{children:e.numberOfItems})),(0,i.jsx)(S.Td,(0,a._)((0,r._)({width:30,modifier:"truncate"},W({columnKey:"status"})),{children:e.isRunning?(0,i.jsx)(eo,{state:"running"}):(0,i.jsx)(n=>{let{children:t}=n;return e.messages?(0,i.jsx)(c.zx,{isInline:!0,variant:"link",onClick:()=>{var n;s(Object.entries(null!=(n=e.messages)?n:{}).map(e=>{let[n,t]=e;return Object.entries(t).map(e=>{let[t,r]=e;return{title:"".concat(n.charAt(0).toUpperCase()+n.slice(1),': "').concat(t,'"'),body:r.map(e=>{let n=null;switch(e.severity){case"none":n=F.xT.green;break;case"low":n=F.xT.cyan;break;case"medium":n=F.xT.yellow;break;case"high":n=F.xT.lightBlue;break;case"critical":n=F.xT.red}return"".concat(null!=n?n:"").concat(e.severity.charAt(0).toUpperCase()+e.severity.slice(1),": ").concat(F.xT.defaultForegroundColorAtStartup," ").concat(e.message)}).join(F.xT.endLine)}}).map(e=>"".concat(F.xT.underline).concat(e.title).concat(F.xT.reset).concat(F.xT.endLine).concat(e.body)).join("".concat(F.xT.endLine).concat(F.xT.endLine))})),p()},children:t}):t},{children:e.error?(0,i.jsx)(ee,{preset:"Failed",label:e.error}):(0,i.jsx)(ee,{preset:"Completed",label:"Finished successfully"})})})),(0,i.jsx)(S.Td,(0,a._)((0,r._)({width:25,modifier:"truncate"},W({columnKey:"duration"})),{children:e.duration?e.isRunning?"Time remaining: ".concat(o().duration(e.duration).humanize()):"Run for: ".concat(o().duration(e.duration).humanize()):""}))]}))}))},e.id))})]})),(0,i.jsx)(en.p,{idPrefix:"report-table",isTop:!1,paginationProps:Z}),(0,i.jsxs)(j.u,{variant:"large",isOpen:d,onClose:p,children:[(0,i.jsx)(b.x,{title:"Log"}),(0,i.jsx)(g.f,{children:(0,i.jsx)(f.nU,{hasLineNumbers:!1,height:400,data:t,theme:"dark",toolbar:(0,i.jsx)(m.o,{children:(0,i.jsx)(h.c,{children:(0,i.jsx)(x.E,{children:(0,i.jsx)(f.Yt,{placeholder:"Search value",minSearchChars:1})})})})})}),(0,i.jsx)(v.m,{children:(0,i.jsx)(c.zx,{variant:"link",onClick:p,children:"Close"},"cancel")})]})]})}}}]);