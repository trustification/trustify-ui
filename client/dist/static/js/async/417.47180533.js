"use strict";(self.webpackChunk_trustify_ui_client=self.webpackChunk_trustify_ui_client||[]).push([["417"],{97838:function(e,t,r){r.r(t),r.d(t,{default:()=>eP});var i,s=r(24246),l=r(27378),n=r(45043),a=r(70715),o=r(40982),c=r(75070),d=r(68802),u=r(89226),p=r(74502),h=r(65783),x=r(855),j=r(70400),y=r(60850),f=r(3594),g=r(106),v=r(13754),b=r(91865),m=r(19364),C=r(23662),k=r(47849),F=r(17598),S=r(59015),P=r(43959),w=r(52030);let A=e=>(0,s.jsx)(h.rU,{to:e.navLink,style:{textDecoration:"none"},children:(0,s.jsxs)(x.s,{itemId:e.id,description:e.description,children:[e.title," ",(0,s.jsx)(j._,{color:e.typeColor,children:e.type})]})},e.id),R=e=>{let{onChangeSearch:t}=e,{tableControls:r}=l.useContext(k.W),[i,n]=l.useState(""),[a,o]=l.useState(!1);l.useEffect(()=>{n(r.filterState.filterValues[p.L4]?.[0]??"")},[r.filterState]);let[c,d]=(0,C.nj)(i,500);l.useEffect(()=>{d(i)},[d,i]);let{isFetching:u,list:h}=function(e,t){let r={filters:[{field:p.L4,operator:"~",value:e}],page:{pageNumber:1,itemsPerPage:5}},{isFetching:i,result:{data:s}}=(0,F.N7)({...r},[],t),{isFetching:l,result:{data:n}}=(0,S.fF)({...r},t),{isFetching:a,result:{data:o}}=(0,P.Fz)({...r},[],t),{isFetching:c,result:{data:d}}=(0,w.fd)({...r},t),u=s.map(e=>({id:`advisory-${e.uuid}`,title:e.document_id,description:e.title?.substring(0,75),navLink:`/advisories/${e.uuid}`,type:"Advisory",typeColor:"blue"})),h=n.map(e=>({id:`package-${e.uuid}`,title:e.purl,navLink:`/packages/${e.uuid}`,type:"Package",typeColor:"teal"})),x=o.map(e=>({id:`sbom-${e.id}`,title:e.name,description:e.suppliers.join(", "),navLink:`/sboms/${e.id}`,type:"SBOM",typeColor:"purple"})),j=d.map(e=>({id:`vulnerability-${e.identifier}`,title:e.identifier,description:e.description?.substring(0,75),navLink:`/vulnerabilities/${e.identifier}`,type:"Vulnerability",typeColor:"orange"})),y=e.toLowerCase();return{isFetching:i||l||a||c,list:[...j,...x,...u,...h].sort((e,t)=>e.title?.includes(y)?-1:t.title?.includes(y)?1:(e.description||"").toLowerCase().indexOf(y)-(t.description||"").toLowerCase().indexOf(y))}}(c,!a),[j,R]=l.useState(!1),O=l.useRef(null),T=l.useRef(null);l.useEffect(()=>{let e=e=>{if(j&&O.current&&O.current===e.target)if("Escape"===e.key)R(!1),O.current.focus();else if("ArrowDown"===e.key||"ArrowUp"===e.key){let t=T.current?.querySelector("li > button:not(:disabled)");t&&t?.focus(),e.preventDefault()}else("Tab"===e.key||"Enter"===e.key||"Space"===e.key)&&(R(!1),("Enter"===e.key||"Space"===e.key)&&e.preventDefault());else j&&T.current?.contains(e.target)&&"Tab"===e.key&&(e.preventDefault(),R(!1),O.current?.focus())},t=e=>{j&&T&&T.current&&!T.current.contains(e.target)&&R(!1)};return window.addEventListener("keydown",e),window.addEventListener("click",t),()=>{window.removeEventListener("keydown",e),window.removeEventListener("click",t)}},[j]);let L=(0,s.jsx)(y.v,{ref:T,style:{width:"450px",maxHeight:"450px",overflow:"scroll",overflowX:"hidden",overflowY:"auto"},children:(0,s.jsx)(f.D,{children:(0,s.jsx)(g.q,{children:u?(0,s.jsx)(x.s,{itemId:"loading",children:(0,s.jsx)(v.$,{size:"sm"})}):h.map(A)})})}),V=(0,s.jsx)(b.M,{placeholder:"Search for an SBOM, Package, Advisory, or Vulnerability",value:i,onChange:(e,t)=>{""!==t&&O&&O.current&&O.current.contains(document.activeElement)?R(!0):R(!1),n(t),o(!0)},onClear:()=>{n("")},onSearch:()=>{t(i)},onKeyDown:e=>{if(e.key&&"Enter"!==e.key)return},ref:O,id:"autocomplete-search",style:{width:500}});return(0,s.jsx)(m.r,{trigger:V,triggerRef:O,popper:L,popperRef:T,isVisible:j&&h.length>0||u,enableFlip:!1,appendTo:()=>document.querySelector("#autocomplete-search")})};var O=r(92934),T=r(33384),L=r(27722);function V(e,t){return{Component:e,props:t}}let E=(i=[V(k.F,{}),V(T.u,{}),V(L.W,{}),V(O.F,{})],e=>{let{children:t}=e,r=(0,s.jsx)(s.Fragment,{children:t});return i.reduceRight((e,t)=>{let{Component:r,props:i={}}=t;return(0,s.jsx)(r,{...i,children:e},e.key)},r)});var K=r(11192),D=r(32591),M=r(31757),$=r(51527),I=r(4075),H=r(27090),B=r(75165),J=r(84780),Y=r(64766),Z=r(31762),W=r(99),z=r(12621),_=r(64118),N=r(27317),q=r(93095),G=r(17528),U=r(14629),X=r(63706),Q=r(40165);let ee=e=>{let{category:t,filterValue:r,setFilterValue:i,isDisabled:n=!1}=e,[a,o]=l.useState(Array.isArray(t.selectOptions)?t.selectOptions:[]);return l.useEffect(()=>{o(Array.isArray(t.selectOptions)?t.selectOptions:[])},[t.selectOptions]),(0,s.jsx)(Q.F,{showChips:!0,isDisabled:n,options:a.map(e=>({id:e.value,name:e.label??e.value})),selections:r?.map(e=>({id:e,name:e})),onChange:e=>{i(e.map(e=>(0,X.KF)(e.name)))},noResultsMessage:"No search results",placeholderText:t.placeholderText,searchInputAriaLabel:"select-autocomplete-listbox",onSearchChange:t.onInputValueChange})};var et=r(70919);let er=e=>{let{category:t,filterValue:r,setFilterValue:i}=e,[n,a]=l.useState(Array.isArray(t.selectOptions)?t.selectOptions:[]);l.useEffect(()=>{a(Array.isArray(t.selectOptions)?t.selectOptions:[])},[t.selectOptions]);let o=Array.isArray(n)?n:Object.values(n).flat();return(0,s.jsx)(s.Fragment,{children:o.map((e,l)=>{let{label:n,value:a}=e;return(0,s.jsx)(et.X,{id:`checkbox-${l}-${t.categoryKey}`,isLabelWrapped:!0,label:n,isChecked:r?.includes(a),onChange:()=>{a&&"No results"!==a&&i(r?.includes(a)?r.filter(e=>e!==a):r?[...r,a]:[a])}},n)})})};var ei=r(51088),es=r(54816),el=r(77152),en=r(61244),ea=r(13464);let eo=e=>{let{filterValue:t,setFilterValue:r,isDisabled:i=!1}=e,[n,a]=(0,l.useState)(),[o,c]=(0,l.useState)();return l.useEffect(()=>{if(t?.[0]){let[e,r]=(0,ea.bG)(t?.[0]);a(e.toDate()),c(r.toDate())}else a(void 0),c(void 0)},[t]),(0,s.jsxs)(ei.l,{children:[(0,s.jsx)(es.c,{role:"group",isInline:!0,label:"From",children:(0,s.jsx)(el.M,{value:n?(0,ea.xR)(n):"",dateFormat:ea.xR,dateParse:ea.Hy,onChange:(e,t)=>{(0,ea.pq)(t)&&(a((0,ea.Hy)(t)),c(void 0))},"aria-label":"Interval start",placeholder:"MM/DD/YYYY",invalidFormatText:"",appendTo:document.body,isDisabled:i})}),(0,s.jsx)(es.c,{role:"group",isInline:!0,label:"To",children:(0,s.jsx)(el.M,{value:o?(0,ea.xR)(o):"",onChange:(e,t)=>{if((0,ea.pq)(t)){let e=(0,ea.Hy)(t);c(e);let i=(0,ea.bP)(n,e);i&&r([i])}},isDisabled:i||!(0,en.q)(n),dateFormat:ea.xR,dateParse:ea.Hy,invalidFormatText:"",rangeStart:n,"aria-label":"Interval end",placeholder:"MM/DD/YYYY",appendTo:document.body})})]})};var ec=r(97656);let ed=e=>{let{category:t,filterValue:r,setFilterValue:i,isDisabled:l=!1}=e;return(0,s.jsx)(s.Fragment,{children:t.selectOptions.map((e,n)=>{let{label:a,value:o}=e,c=r?.includes(o)||!1;return(0,s.jsx)(ec.Y,{isDisabled:l,id:`radio-${n}`,name:"radio",isLabelWrapped:!0,label:a,isChecked:c,onChange:()=>{i(t.selectOptions.find(e=>{let{value:t}=e;return t===o})?[o]:null)}},a)})})};var eu=r(56081),ep=r(34091),eh=r(9767);let ex=e=>{let{category:t,filterValue:r,setFilterValue:i,isNumeric:n,isDisabled:a=!1}=e,[o,c]=l.useState(r?.[0]||"");l.useEffect(()=>{c(r?.[0]||"")},[r]);let d=()=>{let e=o.trim();i(e?[e.replace(/\s+/g," ")]:[])},u=`${t.categoryKey}-input`;return(0,s.jsxs)(eu.B,{children:[(0,s.jsx)(ep.oi,{name:u,id:"search-input",type:n?"number":"search",onChange:(e,t)=>c(t),"aria-label":`${t.title} filter`,value:o,placeholder:t.placeholderText,onKeyDown:e=>{e.key&&"Enter"!==e.key||d()},isDisabled:a}),(0,s.jsx)(G.zx,{icon:(0,s.jsx)(eh.ZP,{}),variant:G.Wu.control,id:"search-button","aria-label":"search button for search input",onClick:d,isDisabled:a})]})},ej=e=>{let{category:t,...r}=e;return t.type===U.vA.select?(0,s.jsx)(ed,{category:t,...r}):t.type===U.vA.search||t.type===U.vA.numsearch?(0,s.jsx)(ex,{category:t,isNumeric:t.type===U.vA.numsearch,...r}):t.type===U.vA.multiselect?(0,s.jsx)(er,{category:t,...r}):t.type===U.vA.dateRange?(0,s.jsx)(eo,{category:t,...r}):t.type===U.vA.autocompleteLabel?(0,s.jsx)(ee,{category:t,...r}):null},ey=e=>{let{filterCategories:t,filterValues:r,setFilterValues:i,isDisabled:l=!1,omitFilterCategoryKeys:n=[]}=e;return(0,s.jsx)(s.Fragment,{children:(0,s.jsxs)(N.K,{hasGutter:!0,children:[(0,s.jsx)(q.v,{children:(0,s.jsx)(G.zx,{variant:"link",isInline:!0,onClick:()=>{let e=t.filter(e=>void 0===n.find(t=>t===e.categoryKey)).reduce((e,t)=>Object.assign(e,{[t.categoryKey]:void 0}),{});i({...r,...e})},children:"Clear all filters"})}),t.filter(e=>void 0===n.find(t=>t===e.categoryKey)).map(e=>(0,s.jsx)(q.v,{children:(0,s.jsxs)(N.K,{hasGutter:!0,children:[(0,s.jsx)(q.v,{children:(0,s.jsx)(d.V,{component:"h4",children:e.title})}),(0,s.jsx)(q.v,{children:(0,s.jsx)(ej,{category:e,filterValue:r[e.categoryKey],setFilterValue:t=>i({...r,[e.categoryKey]:t}),isDisabled:l,isSidebar:!0})})]})},e.categoryKey))]})})};var ef=r(26179),eg=r(80475),ev=r(75778),eb=r(39305),em=r(68801),eC=r(83870),ek=r(96138),eF=r(27970);let eS=e=>{let{filterPanelProps:t,sbomTable:r,sbomTotalCount:i,packageTable:n,packageTotalCount:a,vulnerabilityTable:o,vulnerabilityTotalCount:c,advisoryTable:d,advisoryTotalCount:u,isFetchingPackages:p,isFetchingSboms:h,isFetchingVulnerabilities:x,isFetchingAdvisories:j}=e,[y,f]=l.useState(0),{sbomFilterPanelProps:g,packageFilterPanelProps:v,vulnerabilityFilterPanelProps:b,advisoryFilterPanelProps:m}=t,C=l.createRef(),k=l.createRef(),F=l.createRef(),S=l.createRef();return(0,s.jsxs)(K.P,{hasGutter:!0,children:[(0,s.jsx)(D.J,{children:(0,s.jsx)(M.Z,{isFullHeight:!0,children:(0,s.jsx)($.e,{style:{width:241},children:0===y?(0,s.jsx)(ey,{omitFilterCategoryKeys:[""],...g}):1===y?(0,s.jsx)(ey,{omitFilterCategoryKeys:[""],...v}):2===y?(0,s.jsx)(ey,{omitFilterCategoryKeys:[""],...b}):3===y?(0,s.jsx)(ey,{omitFilterCategoryKeys:[""],...m}):null})})}),(0,s.jsx)(D.J,{isFilled:!0,children:(0,s.jsxs)(I.m,{mountOnEnter:!0,isBox:!0,activeKey:y,onSelect:(e,t)=>{f(t)},"aria-label":"Tabs",role:"region",children:[(0,s.jsxs)(H.O,{eventKey:0,title:(0,s.jsxs)(B.T,{children:["SBOMs","  ",(0,s.jsx)(J.C,{screenReaderText:"Search Result Count",children:h?(0,s.jsx)(Y.J,{size:"sm",children:(0,s.jsx)(_.ZP,{})}):i})]}),actions:(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(Z.b,{"aria-label":"SBOM help popover",ref:C,children:(0,s.jsx)(z.ZP,{})}),(0,s.jsx)(W.J,{bodyContent:(0,s.jsx)("div",{children:"A list of ingested Software Bill of Materials (SBOM) documents."}),position:"right",triggerRef:C})]}),children:[(0,s.jsx)(eC.c,{}),r??(0,s.jsx)(em.H,{})]}),(0,s.jsxs)(H.O,{eventKey:1,title:(0,s.jsxs)(B.T,{children:["Packages","  ",(0,s.jsx)(J.C,{screenReaderText:"Search Result Count",children:p?(0,s.jsx)(Y.J,{size:"sm",children:(0,s.jsx)(_.ZP,{})}):a})]}),actions:(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(Z.b,{"aria-label":"Package help popover",ref:k,children:(0,s.jsx)(z.ZP,{})}),(0,s.jsx)(W.J,{bodyContent:(0,s.jsx)("div",{children:"A list of packages along with the count of vulnerabilities."}),position:"right",triggerRef:k})]}),children:[(0,s.jsx)(eb.v,{}),n??(0,s.jsx)(ev.L,{})]}),(0,s.jsxs)(H.O,{eventKey:2,title:(0,s.jsxs)(B.T,{children:["Vulnerabilities","  ",(0,s.jsx)(J.C,{screenReaderText:"Search Result Count",children:x?(0,s.jsx)(Y.J,{size:"sm",children:(0,s.jsx)(_.ZP,{})}):c})]}),actions:(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(Z.b,{"aria-label":"Vulnerability help popover",ref:F,children:(0,s.jsx)(z.ZP,{})}),(0,s.jsx)(W.J,{bodyContent:(0,s.jsx)("div",{children:"A list of publicly known Common Vulnerabilities and Exposures (CVE)."}),position:"right",triggerRef:F})]}),children:[(0,s.jsx)(eF.R,{}),o??(0,s.jsx)(ek.u,{})]}),(0,s.jsxs)(H.O,{eventKey:3,title:(0,s.jsxs)(B.T,{children:["Advisories","  ",(0,s.jsx)(J.C,{screenReaderText:"Advisory Result Count",children:j?(0,s.jsx)(Y.J,{size:"sm",children:(0,s.jsx)(_.ZP,{})}):u})]}),actions:(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(Z.b,{"aria-label":"Advisory help popover",ref:S,children:(0,s.jsx)(z.ZP,{})}),(0,s.jsx)(W.J,{bodyContent:(0,s.jsx)("div",{children:"A list of available advisories."}),position:"right",triggerRef:S})]}),children:[(0,s.jsx)(eg.P,{}),d??(0,s.jsx)(ef.H,{})]})]})})]})},eP=e=>{let{searchBodyOverride:t}=e;return(0,s.jsx)(E,{children:(0,s.jsx)(ew,{searchBodyOverride:t})})},ew=e=>{let{searchBodyOverride:t}=e,{tableControls:r}=l.useContext(k.W),{tableControls:i}=l.useContext(T.a),{tableControls:h}=l.useContext(L.P),{tableControls:x}=l.useContext(O.P),{isFetching:j,totalItemCount:y,tableControls:{propHelpers:{filterPanelProps:f}}}=l.useContext(k.W),{isFetching:g,totalItemCount:v,tableControls:{propHelpers:{filterPanelProps:b}}}=l.useContext(T.a),{isFetching:m,totalItemCount:C,tableControls:{propHelpers:{filterPanelProps:F}}}=l.useContext(L.P),{isFetching:S,totalItemCount:P,tableControls:{propHelpers:{filterPanelProps:w}}}=l.useContext(O.P),A=(0,s.jsx)(eS,{filterPanelProps:{advisoryFilterPanelProps:w,packageFilterPanelProps:b,sbomFilterPanelProps:f,vulnerabilityFilterPanelProps:F},packageTotalCount:v,sbomTotalCount:y,vulnerabilityTotalCount:C,advisoryTotalCount:P,isFetchingPackages:g,isFetchingSboms:j,isFetchingVulnerabilities:m,isFetchingAdvisories:S});return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.NP,{hasBodyWrapper:!1,children:(0,s.jsx)(a.o,{isStatic:!0,children:(0,s.jsxs)(o.c,{children:[(0,s.jsx)(c.k,{align:{default:"alignStart"},children:(0,s.jsx)(d.V,{children:(0,s.jsx)(d.V,{component:"h1",children:"Search Results"})})}),(0,s.jsx)(c.k,{variant:"action-group-plain",align:{default:"alignEnd"},children:(0,s.jsx)(c.k,{visibility:{default:"visible"},children:(0,s.jsx)(u.E,{children:(0,s.jsx)(R,{onChangeSearch:e=>{void 0!==e&&(r.filterState.setFilterValues({...r.filterState.filterValues,[p.L4]:[e]}),i.filterState.setFilterValues({...i.filterState.filterValues,[p.L4]:[e]}),h.filterState.setFilterValues({...h.filterState.filterValues,[p.L4]:[e]}),x.filterState.setFilterValues({...x.filterState.filterValues,[p.L4]:[e]}))}})})})})]})})}),(0,s.jsx)(n.NP,{hasBodyWrapper:!1,children:t||A})]})}}}]);