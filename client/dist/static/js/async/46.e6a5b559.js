"use strict";(self.webpackChunk_trustify_ui_client=self.webpackChunk_trustify_ui_client||[]).push([["46"],{73227:function(e,i,t){t.d(i,{useDownload:()=>o});var r=t(2926),l=t(87017),n=t(50576),s=t(40371),a=t(63706);let o=()=>({downloadAdvisory:(e,i)=>{(0,s.Em)({client:n.L,path:{key:e},responseType:"arraybuffer",headers:{Accept:"text/plain",responseType:"blob"}}).then(t=>{(0,r.saveAs)(new Blob([t.data]),i||`${e}.json`)})},downloadSBOM:(e,i)=>{(0,s.XW)({client:n.L,path:{key:e},responseType:"arraybuffer",headers:{Accept:"text/plain",responseType:"blob"}}).then(t=>{(0,r.saveAs)(new Blob([t.data]),i||`${e}.json`)})},downloadSBOMLicenses:e=>{(0,l.Co)(e).then(i=>{let t=null,l=i.headers?.["content-disposition"]?.toString();l&&(t=(0,a.lj)(l)),(0,r.saveAs)(new Blob([i.data]),t||`${e}.tar.gz`)})}})},92934:function(e,i,t){t.d(i,{F:()=>u,P:()=>d});var r=t(24246),l=t(27378),n=t(74502),s=t(72603),a=t(49988),o=t(17598);let d=l.createContext({}),u=e=>{let{children:i}=e,t=(0,a.vZ)({tableName:"advisory",persistenceKeyPrefix:n.yq.advisories,persistTo:"urlParams",columnNames:{identifier:"ID",title:"Title",severity:"Aggregated Severity",type:"Type",modified:"Revision",vulnerabilities:"Vulnerabilities"},isPaginationEnabled:!0,isSortEnabled:!0,sortableColumns:["identifier","severity","modified"],initialSort:{columnKey:"modified",direction:"desc"},isFilterEnabled:!0,filterCategories:[{categoryKey:n.L4,title:"Filter text",placeholderText:"Search",type:s.vA.search},{categoryKey:"average_severity",title:"Severity",placeholderText:"Severity",type:s.vA.multiselect,selectOptions:[{value:"null",label:"Unknown"},{value:"none",label:"None"},{value:"low",label:"Low"},{value:"medium",label:"Medium"},{value:"high",label:"High"},{value:"critical",label:"Critical"}]},{categoryKey:"modified",title:"Revision",type:s.vA.dateRange}],isExpansionEnabled:!1}),{result:{data:l,total:u},isFetching:c,fetchError:y}=(0,o.useFetchAdvisories)((0,a.QO)({...t,hubSortFieldKeys:{identifier:"identifier",severity:"average_score",modified:"modified"}})),h=(0,a.KC)({...t,idProperty:"identifier",currentPageItems:l,totalItemCount:u,isLoading:c});return(0,r.jsx)(d.Provider,{value:{totalItemCount:u,isFetching:c,fetchError:y,tableControls:h},children:i})}},26179:function(e,i,t){t.d(i,{H:()=>g});var r=t(24246),l=t(27378),n=t(65783),s=t(4835),a=t(14350),o=t(11165),d=t(89330),u=t(31423),c=t(94154),y=t(88935),h=t(3804),v=t(31336),p=t(73227),m=t(57524),x=t(49304),f=t(63706),b=t(7615),j=t(92934);let g=()=>{let{isFetching:e,fetchError:i,totalItemCount:t,tableControls:g}=l.useContext(j.P),{numRenderedColumns:T,currentPageItems:w,propHelpers:{paginationProps:K,tableProps:A,getThProps:C,getTrProps:S,getTdProps:F},expansionDerivedState:{isCellExpanded:P}}=g,{downloadAdvisory:k}=(0,p.useDownload)();return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(s.i,{...A,"aria-label":"advisory-table",children:[(0,r.jsx)(a.h,{children:(0,r.jsx)(o.Tr,{children:(0,r.jsxs)(v.qK,{...g,children:[(0,r.jsx)(d.Th,{...C({columnKey:"identifier"})}),(0,r.jsx)(d.Th,{...C({columnKey:"title"})}),(0,r.jsx)(d.Th,{...C({columnKey:"severity"}),info:{tooltip:"The average CVSS score for all of the Vulnerabilities linked to this Advisory."}}),(0,r.jsx)(d.Th,{...C({columnKey:"type"})}),(0,r.jsx)(d.Th,{...C({columnKey:"modified"})}),(0,r.jsx)(d.Th,{...C({columnKey:"vulnerabilities"})})]})})}),(0,r.jsx)(v.hp,{isLoading:e,isError:!!i,isNoData:0===t,numRenderedColumns:T,children:w.map((e,i)=>{let t=e.vulnerabilities.reduce((e,i)=>{let t=(0,b.g)(i.severity);return Object.assign(e,{[t]:e[t]+1})},{critical:0,high:0,medium:0,low:0,none:0,unknown:0});return(0,r.jsx)(u.p,{isExpanded:P(e),children:(0,r.jsx)(o.Tr,{...S({item:e}),children:(0,r.jsxs)(v.Cx,{...g,item:e,rowIndex:i,children:[(0,r.jsx)(c.Td,{width:15,modifier:"breakWord",...F({columnKey:"identifier",isCompoundExpandToggle:!0,item:e,rowIndex:i}),children:(0,r.jsx)(n.OL,{to:`/advisories/${e.uuid}`,children:e.document_id})}),(0,r.jsx)(c.Td,{width:30,modifier:"truncate",...F({columnKey:"title"}),children:e.title}),(0,r.jsx)(c.Td,{width:15,modifier:"truncate",...F({columnKey:"severity"}),children:e.average_severity&&(0,r.jsx)(m.o,{value:(0,b.g)(e.average_severity),score:e.average_score,showLabel:!0,showScore:!0})}),(0,r.jsx)(c.Td,{width:10,...F({columnKey:"type"}),children:e.labels.type}),(0,r.jsx)(c.Td,{width:10,modifier:"truncate",...F({columnKey:"modified"}),children:(0,f.p6)(e.modified)}),(0,r.jsx)(c.Td,{width:20,...F({columnKey:"vulnerabilities"}),children:(0,r.jsx)(x.u,{severities:t})}),(0,r.jsx)(c.Td,{isActionCell:!0,children:(0,r.jsx)(y.k,{items:[{title:"Download",onClick:()=>{k(e.uuid,`${e.identifier}.json`)}}]})})]})})},e.identifier)})})]}),(0,r.jsx)(h.p,{idPrefix:"advisory-table",isTop:!1,paginationProps:K})]})}},80475:function(e,i,t){t.d(i,{P:()=>c});var r=t(24246),l=t(27378),n=t(70715),s=t(40982),a=t(89226),o=t(72603),d=t(3804),u=t(92934);let c=e=>{let{showFilters:i}=e,{tableControls:t}=l.useContext(u.P),{propHelpers:{toolbarProps:c,filterToolbarProps:y,paginationToolbarItemProps:h,paginationProps:v}}=t;return(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(n.o,{...c,children:(0,r.jsxs)(s.c,{children:[i&&(0,r.jsx)(o.Ki,{...y}),(0,r.jsx)(a.E,{...h,children:(0,r.jsx)(d.p,{idPrefix:"advisory-table",isTop:!0,paginationProps:v})})]})})})}},17598:function(e,i,t){t.d(i,{useFetchAdvisories:()=>c,useFetchAdvisoryById:()=>y,useUploadAdvisory:()=>h});var r=t(1183),l=t(68e3),n=t(50576),s=t(40371),a=t(87017),o=t(49988),d=t(95169);let u="advisories",c=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=arguments.length>1&&void 0!==arguments[1]&&arguments[1],{data:t,isLoading:l,error:a,refetch:d}=(0,r.useQuery)({queryKey:[u,e],queryFn:()=>(0,s.A1)({client:n.L,query:{...(0,o.rm)(e)}}),enabled:!i});return{result:{data:t?.data?.items||[],total:t?.data?.total??0,params:e??e},isFetching:l,fetchError:a||null,refetch:d}},y=e=>{let{data:i,isLoading:t,error:l}=(0,r.useQuery)({queryKey:[u,e],queryFn:()=>(0,s.pB)({client:n.L,path:{key:e}}),enabled:void 0!==e});return{advisory:i?.data,isFetching:t,fetchError:l}},h=()=>{let e=(0,l.NL)();return(0,d.V)({parallel:!0,uploadFn:(e,i)=>(0,a.Cu)(e,i),onSuccess:async()=>{await e.invalidateQueries({queryKey:[u]})}})}}}]);